<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">

<html>

<head>

<meta http-equiv="content-type" content="text/html; charset=utf-8">

<title>Guia Foca GNU/Linux - Firewall iptables</title>

<link href="index.html" rel="start">
<link href="ch-x11.html" rel="prev">
<link href="ch-d-contas.html" rel="next">
<link href="index.html#contents" rel="contents">
<link href="index.html#copyright" rel="copyright">
<link href="ch-intro.html" rel="chapter" title="1 Introdução">
<link href="ch-bas.html" rel="chapter" title="2 Explicações Básicas">
<link href="ch-hardw.html" rel="chapter" title="3 Hardware">
<link href="ch-d-l.html" rel="chapter" title="4 Para quem esta migrando (ou pensando em migrar) do DOS/Windows para o Linux">
<link href="ch-disc.html" rel="chapter" title="5 Discos e Partições">
<link href="ch-boot.html" rel="chapter" title="6 Gerenciadores de Partida (boot loaders)">
<link href="ch-run.html" rel="chapter" title="7 Execução de programas">
<link href="ch-cmdd.html" rel="chapter" title="8 Comandos para manipulação de diretório">
<link href="ch-cmd.html" rel="chapter" title="9 Comandos para manipulação de Arquivos">
<link href="ch-cmdv.html" rel="chapter" title="10 Comandos Diversos">
<link href="ch-cmdn.html" rel="chapter" title="11 Comandos de rede">
<link href="ch-cmdc.html" rel="chapter" title="12 Comandos para manipulação de contas">
<link href="ch-perm.html" rel="chapter" title="13 Permissões de acesso a arquivos e diretórios">
<link href="ch-redir.html" rel="chapter" title="14 Redirecionamentos e Pipe">
<link href="ch-rede.html" rel="chapter" title="15 Rede">
<link href="ch-cfgrede.html" rel="chapter" title="16 Configurações especiais de Rede">
<link href="ch-kern.html" rel="chapter" title="17 Kernel e Módulos">
<link href="ch-log.html" rel="chapter" title="18 Arquivos e daemons de Log">
<link href="ch-cpctd.html" rel="chapter" title="19 Compactadores">
<link href="ch-deb.html" rel="chapter" title="20 A distribuição Debian GNU/Linux">
<link href="ch-dpkg.html" rel="chapter" title="21 Sistema de gerenciamento de pacotes">
<link href="ch-pers.html" rel="chapter" title="22 Personalização do Sistema">
<link href="ch-impr.html" rel="chapter" title="23 Impressão">
<link href="ch-cfg.html" rel="chapter" title="24 Configuração do sistema">
<link href="ch-tasks.html" rel="chapter" title="25 Executando tarefas diversas no Linux">
<link href="ch-compil.html" rel="chapter" title="26 Compilação">
<link href="ch-manut.html" rel="chapter" title="27 Manutenção do Sistema">
<link href="ch-etc.html" rel="chapter" title="28 Principais arquivos de configuração do diretório /etc">
<link href="ch-inter.html" rel="chapter" title="29 Conectando seu computador a Internet">
<link href="ch-x11.html" rel="chapter" title="30 X Window (ambiente gráfico)">
<link href="ch-fw-iptables.html" rel="chapter" title="31 Firewall iptables">
<link href="ch-d-contas.html" rel="chapter" title="32 Gerenciamento de contas e cuidados para a proteção de senhas">
<link href="ch-s-apache.html" rel="chapter" title="33 Apache">
<link href="ch-s-ident.html" rel="chapter" title="34 Servidor ident">
<link href="ch-s-telnet.html" rel="chapter" title="35 Servidor telnet">
<link href="ch-s-ssh.html" rel="chapter" title="36 Servidor ssh">
<link href="ch-s-pop3.html" rel="chapter" title="37 Servidor pop3">
<link href="ch-s-cvs.html" rel="chapter" title="38 CVS">
<link href="ch-s-samba.html" rel="chapter" title="39 SAMBA">
<link href="ch-d-restr.html" rel="chapter" title="40 Restrições de acesso, recursos e serviços">
<link href="ch-d-cripto.html" rel="chapter" title="41 Introdução ao uso de criptografia para transmissão/armazenamento de dados">
<link href="ch-aplic.html" rel="chapter" title="42 Aplicativos para Linux">
<link href="ch-ajuda.html" rel="chapter" title="43 Como obter ajuda no sistema">
<link href="ch-systemd.html" rel="chapter" title="44 SYSTEMD, o novo e controverso sistema de inicialização do Linux">
<link href="ch-git.html" rel="chapter" title="45 Git, controle de versões">
<link href="ch-virt-intro.html" rel="chapter" title="46 Virtualização em sistemas GNU/Linux">
<link href="ch-apend.html" rel="chapter" title="47 Apêndice">
<link href="ch-intro.html#s-introducao-palavras" rel="section" title="1.1 Antes de começar">
<link href="ch-intro.html#s-introducao-requisitos" rel="section" title="1.2 Pré-requisitos para a utilização deste guia">
<link href="ch-intro.html#s-introducao-so" rel="section" title="1.3 Sistema Operacional">
<link href="ch-intro.html#s-introducao-linux" rel="section" title="1.4 O Linux">
<link href="ch-intro.html#s-introducao-distrib" rel="section" title="1.5 Distribuições do Linux">
<link href="ch-intro.html#s-introducao-software-livre" rel="section" title="1.6 Software Livre">
<link href="ch-intro.html#s-introducao-processamento" rel="section" title="1.7 Processamento de Dados">
<link href="ch-intro.html#s-introducao-computador" rel="section" title="1.8 O Computador">
<link href="ch-intro.html#s-introducao-conhecendo" rel="section" title="1.9 Conhecendo o Computador">
<link href="ch-intro.html#s-introducao-placamae" rel="section" title="1.10 Placa Mãe">
<link href="ch-intro.html#s-introducao-memoria" rel="section" title="1.11 Memória do Computador">
<link href="ch-intro.html#s-introducao-discos" rel="section" title="1.12 Discos">
<link href="ch-intro.html#s-introducao-cuidados" rel="section" title="1.13 Cuidados Básicos com o Computador">
<link href="ch-intro.html#s-introducao-disp-e-s" rel="section" title="1.14 Dispositivos de Entrada e Saída">
<link href="ch-intro.html#s-introducao-ligando" rel="section" title="1.15 Ligando o computador">
<link href="ch-intro.html#s-introducao-desligando" rel="section" title="1.16 Desligando o computador">
<link href="ch-intro.html#s-introducao-reiniciando" rel="section" title="1.17 Reiniciando o computador">
<link href="ch-bas.html#s-basico-hardsoft" rel="section" title="2.1 Hardware e Software">
<link href="ch-bas.html#s-basico-arquivo" rel="section" title="2.2 Arquivos">
<link href="ch-bas.html#s-basico-diretorio" rel="section" title="2.3 Diretório">
<link href="ch-bas.html#s-basico-nomeando" rel="section" title="2.4 Nomeando Arquivos e Diretórios">
<link href="ch-bas.html#s-basico-comandos" rel="section" title="2.5 Comandos">
<link href="ch-bas.html#s-basico-comandos-externos" rel="section" title="2.6 Comandos Externos">
<link href="ch-bas.html#s-basico-avisocmd" rel="section" title="2.7 Aviso de comando (Prompt)">
<link href="ch-bas.html#s-basico-interpcmd" rel="section" title="2.8 Interpretador de comandos">
<link href="ch-bas.html#s-basico-terminal" rel="section" title="2.9 Terminal Virtual (console)">
<link href="ch-bas.html#s-basico-login" rel="section" title="2.10 Login">
<link href="ch-bas.html#s-basico-logout" rel="section" title="2.11 Logout">
<link href="ch-bas.html#s-basico-coringas" rel="section" title="2.12 Coringas">
<link href="ch-hardw.html#s-hardw-placas" rel="section" title="3.1 Placa de expansão">
<link href="ch-hardw.html#s-hardw-nomesdisp" rel="section" title="3.2 Nomes de dispositivos">
<link href="ch-hardw.html#s-hardw-cfg" rel="section" title="3.3 Configuração de Hardware">
<link href="ch-hardw.html#s-hardw-metodoscfg" rel="section" title="3.4 Hardwares configuráveis por jumpers, dip-switches, jumperless e Plug-and-Play.">
<link href="ch-hardw.html#s-hardw-findhw" rel="section" title="3.5 Listando as placas e outros hardwares em um computador">
<link href="ch-hardw.html#s-hardw-conflitos" rel="section" title="3.6 Conflitos de hardware">
<link href="ch-hardw.html#s-hard-barramento" rel="section" title="3.7 Barramento">
<link href="ch-hardw.html#s-hard-onoffboard" rel="section" title="3.8 Placas on-board / off-board">
<link href="ch-hardw.html#s-hard-forwindows" rel="section" title="3.9 Hardwares específicos ou &quot;For Windows&quot;">
<link href="ch-hardw.html#s3.10" rel="section" title="3.10 Dispositivos específicos para GNU/Linux">
<link href="ch-hardw.html#s-hardw-cfgdisp" rel="section" title="3.11 Configurações de Dispositivos">
<link href="ch-d-l.html#s-d-l-compar" rel="section" title="4.1 Quais as diferenças iniciais">
<link href="ch-d-l.html#s-d-l-comandos" rel="section" title="4.2 Comandos equivalentes entre DOS/CMD do Windows e o Linux">
<link href="ch-d-l.html#s-d-l-mtools" rel="section" title="4.3 Usando a sintaxe de comandos DOS no Linux">
<link href="ch-d-l.html#s-d-l-programas" rel="section" title="4.4 Programas equivalentes entre Windows/DOS e o Linux">
<link href="ch-disc.html#s-disc-particoes" rel="section" title="5.1 Partições">
<link href="ch-disc.html#s-disc-formatando" rel="section" title="5.2 Formatando Pen-drives/Disquetes">
<link href="ch-disc.html#s-disc-pontomontagem" rel="section" title="5.3 Pontos de Montagem">
<link href="ch-disc.html#s-disc-id" rel="section" title="5.4 Identificação de discos e partições em sistemas Linux">
<link href="ch-disc.html#s-disc-montagem" rel="section" title="5.5 Montando (acessando) uma partição de disco">
<link href="ch-disc.html#s-disc-desmontagem" rel="section" title="5.6 Desmontando uma partição de disco">
<link href="ch-boot.html#s-boot-lilo" rel="section" title="6.1 LILO">
<link href="ch-boot.html#s-boot-grub" rel="section" title="6.2 GRUB">
<link href="ch-boot.html#s-boot-kernelparam" rel="section" title="6.3 Parâmetros de inicialização passados ao kernel">
<link href="ch-boot.html#s-boot-loadlin" rel="section" title="6.4 LOADLIN">
<link href="ch-boot.html#s-boot-syslinux" rel="section" title="6.5 syslinux">
<link href="ch-run.html#s-run-prgn" rel="section" title="7.1 Executando um comando/programa">
<link href="ch-run.html#s-run-path" rel="section" title="7.2 path">
<link href="ch-run.html#s-run-tipos" rel="section" title="7.3 Tipos de Execução de comandos/programas">
<link href="ch-run.html#s-run-seq" rel="section" title="7.4 Executando programas em seqüência">
<link href="ch-run.html#s-run-ps" rel="section" title="7.5 ps">
<link href="ch-run.html#s-run-top" rel="section" title="7.6 top">
<link href="ch-run.html#s-run-controle" rel="section" title="7.7 Controle de execução de processos">
<link href="ch-run.html#s-run-fechando" rel="section" title="7.8 Fechando um programa quando não se sabe como sair">
<link href="ch-run.html#s-run-reset" rel="section" title="7.9 Eliminando caracteres estranhos">
<link href="ch-cmdd.html#s-comando-ls" rel="section" title="8.1 ls">
<link href="ch-cmdd.html#s-comando-cd" rel="section" title="8.2 cd">
<link href="ch-cmdd.html#s-comando-pwd" rel="section" title="8.3 pwd">
<link href="ch-cmdd.html#s-comando-mkdir" rel="section" title="8.4 mkdir">
<link href="ch-cmdd.html#s-comando-rmdir" rel="section" title="8.5 rmdir">
<link href="ch-cmd.html#s-comandos-cat" rel="section" title="9.1 cat">
<link href="ch-cmd.html#s-comando-tac" rel="section" title="9.2 tac">
<link href="ch-cmd.html#s-comando-rm" rel="section" title="9.3 rm">
<link href="ch-cmd.html#s-comando-cp" rel="section" title="9.4 cp">
<link href="ch-cmd.html#s-comando-mv" rel="section" title="9.5 mv">
<link href="ch-cmdv.html#s-cmdv-clear" rel="section" title="10.1 clear">
<link href="ch-cmdv.html#s-cmdv-date" rel="section" title="10.2 date">
<link href="ch-cmdv.html#s-cmdv-df" rel="section" title="10.3 df">
<link href="ch-cmdv.html#s-cmdv-ln" rel="section" title="10.4 ln">
<link href="ch-cmdv.html#s-cmdv-du" rel="section" title="10.5 du">
<link href="ch-cmdv.html#s-cmdv-find" rel="section" title="10.6 find">
<link href="ch-cmdv.html#s-cmdv-free" rel="section" title="10.7 free">
<link href="ch-cmdv.html#s-cmdv-grep" rel="section" title="10.8 grep">
<link href="ch-cmdv.html#s-cmdv-head" rel="section" title="10.9 head">
<link href="ch-cmdv.html#s-cmdv-nl" rel="section" title="10.10 nl">
<link href="ch-cmdv.html#s-cmdv-more" rel="section" title="10.11 more">
<link href="ch-cmdv.html#s-cmdv-less" rel="section" title="10.12 less">
<link href="ch-cmdv.html#s-cmdv-sort" rel="section" title="10.13 sort">
<link href="ch-cmdv.html#s-cmdv-tail" rel="section" title="10.14 tail">
<link href="ch-cmdv.html#s-cmdv-time" rel="section" title="10.15 time">
<link href="ch-cmdv.html#s-cmdv-touch" rel="section" title="10.16 touch">
<link href="ch-cmdv.html#s-cmdv-uptime" rel="section" title="10.17 uptime">
<link href="ch-cmdv.html#s-cmdv-dmesg" rel="section" title="10.18 dmesg">
<link href="ch-cmdv.html#s-cmdv-mesg" rel="section" title="10.19 mesg">
<link href="ch-cmdv.html#s-cmdv-echo" rel="section" title="10.20 echo">
<link href="ch-cmdv.html#s-cmdv-su" rel="section" title="10.21 su">
<link href="ch-cmdv.html#s-cmdv-sync" rel="section" title="10.22 sync">
<link href="ch-cmdv.html#s-cmdv-uname" rel="section" title="10.23 uname">
<link href="ch-cmdv.html#s-cmdv-reboot" rel="section" title="10.24 reboot">
<link href="ch-cmdv.html#s-cmdv-shutdown" rel="section" title="10.25 shutdown">
<link href="ch-cmdv.html#s-cmdv-wc" rel="section" title="10.26 wc">
<link href="ch-cmdv.html#s-cmdv-seq" rel="section" title="10.27 seq">
<link href="ch-cmdn.html#s-cmdn-who" rel="section" title="11.1 who">
<link href="ch-cmdn.html#s-cmdn-telnet" rel="section" title="11.2 telnet">
<link href="ch-cmdn.html#s-cmdn-finger" rel="section" title="11.3 finger">
<link href="ch-cmdn.html#s-cmdn-ftp" rel="section" title="11.4 ftp">
<link href="ch-cmdn.html#s-cmdn-whoami" rel="section" title="11.5 whoami">
<link href="ch-cmdn.html#s-cmdn-dnsdomainname" rel="section" title="11.6 dnsdomainname">
<link href="ch-cmdn.html#s-cmdn-hostname" rel="section" title="11.7 hostname">
<link href="ch-cmdn.html#s-cmdn-talk" rel="section" title="11.8 talk">
<link href="ch-cmdc.html#s-cmdc-adduser" rel="section" title="12.1 adduser">
<link href="ch-cmdc.html#s-cmdc-addgroup" rel="section" title="12.2 addgroup">
<link href="ch-cmdc.html#s-cmdc-passwd" rel="section" title="12.3 passwd">
<link href="ch-cmdc.html#s-cmdc-gpasswd" rel="section" title="12.4 gpasswd">
<link href="ch-cmdc.html#s-cmdc-newgrp" rel="section" title="12.5 newgrp">
<link href="ch-cmdc.html#s-cmdc-userdel" rel="section" title="12.6 userdel">
<link href="ch-cmdc.html#s-cmdc-groupdel" rel="section" title="12.7 groupdel">
<link href="ch-cmdc.html#s-cmdc-sg" rel="section" title="12.8 sg">
<link href="ch-cmdc.html#s-cmdc-incluirgrupo" rel="section" title="12.9 Adicionando o usuário a um grupo extra">
<link href="ch-cmdc.html#s-cmdc-chfn" rel="section" title="12.10 chfn">
<link href="ch-cmdc.html#s-cmdc-id" rel="section" title="12.11 id">
<link href="ch-cmdc.html#s-cmdc-logname" rel="section" title="12.12 logname">
<link href="ch-cmdc.html#s-cmdc-users" rel="section" title="12.13 users">
<link href="ch-cmdc.html#s-cmdc-groups" rel="section" title="12.14 groups">
<link href="ch-perm.html#s-perm-user-group" rel="section" title="13.1 Donos, Grupos e outros usuários">
<link href="ch-perm.html#s-perm-tipos" rel="section" title="13.2 Tipos de Permissões de Acesso">
<link href="ch-perm.html#s-perm-acessando" rel="section" title="13.3 Etapas para acesso a um arquivo/diretório">
<link href="ch-perm.html#s-perm-exemplo" rel="section" title="13.4 Exemplos práticos de permissões de acesso">
<link href="ch-perm.html#s-perm-especiais" rel="section" title="13.5 Permissões de Acesso Especiais">
<link href="ch-perm.html#s-perm-root" rel="section" title="13.6 A conta root">
<link href="ch-perm.html#s-perm-chmod" rel="section" title="13.7 chmod">
<link href="ch-perm.html#s-perm-chgrp" rel="section" title="13.8 chgrp">
<link href="ch-perm.html#s-perm-chown" rel="section" title="13.9 chown">
<link href="ch-perm.html#s-perm-octal" rel="section" title="13.10 Modo de permissão octal">
<link href="ch-perm.html#s-perm-umask" rel="section" title="13.11 umask">
<link href="ch-redir.html#s-redir-maior" rel="section" title="14.1 &gt;">
<link href="ch-redir.html#s-redir-maior2" rel="section" title="14.2 &gt;&gt;">
<link href="ch-redir.html#s-redir-menor" rel="section" title="14.3 &lt;">
<link href="ch-redir.html#s-redir-menor2" rel="section" title="14.4 &lt;&lt;">
<link href="ch-redir.html#s-redir-pipe" rel="section" title="14.5 | (pipe)">
<link href="ch-redir.html#s14.6" rel="section" title="14.6 Diferença entre o &quot;|&quot; e o &quot;&gt;&quot;">
<link href="ch-redir.html#s-redir-tee" rel="section" title="14.7 tee">
<link href="ch-rede.html#s-rede-oque" rel="section" title="15.1 O que é uma rede">
<link href="ch-rede.html#s-rede-protocolo" rel="section" title="15.2 Protocolo de Rede">
<link href="ch-rede.html#s-rede-ip" rel="section" title="15.3 Endereço IP">
<link href="ch-rede.html#s-rede-interfaces" rel="section" title="15.4 Interface de rede">
<link href="ch-rede.html#s-rede-rota" rel="section" title="15.5 Roteamento">
<link href="ch-rede.html#s-rede-dns" rel="section" title="15.6 Resolvedor de nomes (DNS)">
<link href="ch-rede.html#s-rede-servicos" rel="section" title="15.7 Serviços de Rede">
<link href="ch-rede.html#s-rede-seg" rel="section" title="15.8 Segurança da Rede e controle de Acesso">
<link href="ch-rede.html#s-rede-outros" rel="section" title="15.9 Outros arquivos de configuração relacionados com a rede">
<link href="ch-cfgrede.html#s-cfgrede-ipalias" rel="section" title="16.1 IP Alias">
<link href="ch-cfgrede.html#s-cfgs-bridge" rel="section" title="16.2 Bridge">
<link href="ch-cfgrede.html#s-cfgs-plip" rel="section" title="16.3 Conectando dois computadores usando a porta paralela">
<link href="ch-cfgrede.html#s-cfgs-slattach" rel="section" title="16.4 Conectando dois computadores usando a porta serial">
<link href="ch-kern.html#s-kern-kernel" rel="section" title="17.1 O Kernel">
<link href="ch-kern.html#s-kern-modulos" rel="section" title="17.2 Módulos">
<link href="ch-kern.html#s-kern-suporte" rel="section" title="17.3 Como adicionar suporte a Hardwares e outros dispositivos no kernel">
<link href="ch-kern.html#s-kern-kmod" rel="section" title="17.4 kmod">
<link href="ch-kern.html#s-kern-lsmod" rel="section" title="17.5 lsmod">
<link href="ch-kern.html#s-kern-insmod" rel="section" title="17.6 insmod">
<link href="ch-kern.html#s-kern-rmmod" rel="section" title="17.7 rmmod">
<link href="ch-kern.html#s-kern-modprobe" rel="section" title="17.8 modprobe">
<link href="ch-kern.html#s-kern-depmod" rel="section" title="17.9 depmod">
<link href="ch-kern.html#s-kern-modconf" rel="section" title="17.10 modconf">
<link href="ch-kern.html#s-kern-recompilando" rel="section" title="17.11 Recompilando o Kernel">
<link href="ch-kern.html#s-kern-arquivos" rel="section" title="17.12 Arquivos relacionados com o Kernel e Módulos">
<link href="ch-kern.html#s-kern-patches" rel="section" title="17.13 Aplicando Patches no kernel">
<link href="ch-log.html#s18.1" rel="section" title="18.1 Formato do arquivo de log">
<link href="ch-log.html#s18.2" rel="section" title="18.2 Daemons de log do sistema">
<link href="ch-log.html#s-log-logger" rel="section" title="18.3 logger">
<link href="ch-cpctd.html#s-cpctd-oque" rel="section" title="19.1 O que fazem os compactadores/descompactadores?">
<link href="ch-cpctd.html#s-cpctd-extensoes" rel="section" title="19.2 Extensões de arquivos compactados">
<link href="ch-cpctd.html#s-cpctd-gzip" rel="section" title="19.3 gzip">
<link href="ch-cpctd.html#s-cpctd-zip" rel="section" title="19.4 zip">
<link href="ch-cpctd.html#s-cpctd-unzip" rel="section" title="19.5 unzip">
<link href="ch-cpctd.html#s-cpctd-tar" rel="section" title="19.6 tar">
<link href="ch-cpctd.html#s-cpctd-bzip2" rel="section" title="19.7 bzip2">
<link href="ch-cpctd.html#s-cpctd-rar" rel="section" title="19.8 rar">
<link href="ch-deb.html#s-deb-obtendo" rel="section" title="20.1 Como obter a Debian">
<link href="ch-deb.html#s-deb-prgnconfig" rel="section" title="20.2 Programas de configuração">
<link href="ch-deb.html#s-deb-startup" rel="section" title="20.3 Arquivos de inicialização">
<link href="ch-deb.html#s-deb-runlevels" rel="section" title="20.4 Níveis de Execução">
<link href="ch-deb.html#s-deb-rede" rel="section" title="20.5 Rede no sistema Debian">
<link href="ch-deb.html#s-deb-bts" rel="section" title="20.6 Bug tracking system">
<link href="ch-deb.html#s-deb-download" rel="section" title="20.7 Onde encontrar a Debian para Download?">
<link href="ch-dpkg.html#s-dpkg-introducao" rel="section" title="21.1 dpkg">
<link href="ch-dpkg.html#s-dpkg-apt" rel="section" title="21.2 apt">
<link href="ch-pers.html#s-pers-varamb" rel="section" title="22.1 Variáveis de Ambientes">
<link href="ch-pers.html#s-pers-idioma" rel="section" title="22.2 Modificando o Idioma usado em seu sistema">
<link href="ch-pers.html#s-pers-alias" rel="section" title="22.3 alias">
<link href="ch-pers.html#s-pers-profile" rel="section" title="22.4 Arquivo /etc/profile">
<link href="ch-pers.html#s-pers-bashprofile" rel="section" title="22.5 Arquivo .bash_profile">
<link href="ch-pers.html#s-pers-bashrc" rel="section" title="22.6 Arquivo .bashrc">
<link href="ch-pers.html#s-pers-hushlogin" rel="section" title="22.7 Arquivo .hushlogin">
<link href="ch-pers.html#s-pers-environment" rel="section" title="22.8 Arquivo /etc/environment">
<link href="ch-pers.html#s-pers-conf-skel" rel="section" title="22.9 Diretório /etc/skel">
<link href="ch-impr.html#s-impr-portas" rel="section" title="23.1 Portas de impressora">
<link href="ch-impr.html#s-impr-direta" rel="section" title="23.2 Imprimindo diretamente para a porta de impressora">
<link href="ch-impr.html#s-impr-spool" rel="section" title="23.3 Imprimindo via spool">
<link href="ch-impr.html#s-impr-graficos" rel="section" title="23.4 Impressão em modo gráfico">
<link href="ch-impr.html#s-impr-magicfilter" rel="section" title="23.5 Magic Filter">
<link href="ch-cfg.html#s-cfg-acentuacao" rel="section" title="24.1 Acentuação">
<link href="ch-tasks.html#s-tasks-cdwriting" rel="section" title="25.1 Gravando CDs e DVDs no Linux">
<link href="ch-tasks.html#s-tasks-cdwriting-rundivx" rel="section" title="25.2 Executando vídeos DIVX">
<link href="ch-tasks.html#s-tasks-rundvd" rel="section" title="25.3 Assistindo DVDs">
<link href="ch-tasks.html#s-tasks-wavtomp3" rel="section" title="25.4 Convertendo músicas no formato wav para mp3">
<link href="ch-tasks.html#s-tasks-mp3cdr" rel="section" title="25.5 Convertendo músicas do formato mp3 para cdr">
<link href="ch-compil.html#s-compil-descricao" rel="section" title="26.1 O que é compilação?">
<link href="ch-compil.html#s-compil-compilador" rel="section" title="26.2 Compilador">
<link href="ch-manut.html#s-manut-checagem" rel="section" title="27.1 Checagem dos sistemas de arquivos">
<link href="ch-manut.html#s-manut-checagem-reiserfsck" rel="section" title="27.2 reiserfsck">
<link href="ch-manut.html#s-manut-checagem-minix" rel="section" title="27.3 fsck.minix">
<link href="ch-manut.html#s-manut-badblocks" rel="section" title="27.4 badblocks">
<link href="ch-manut.html#s-manut-defrag" rel="section" title="27.5 defrag">
<link href="ch-manut.html#s-manut-hdbadblocks" rel="section" title="27.6 Verificando e marcando setores danificados em um HD">
<link href="ch-manut.html#s-manut-logs-l" rel="section" title="27.7 Limpando arquivos de LOGS">
<link href="ch-manut.html#s-manut-recpart" rel="section" title="27.8 Recuperando partições apagadas">
<link href="ch-manut.html#s-manut-senhaperdida" rel="section" title="27.9 Recuperando a senha de root perdida">
<link href="ch-manut.html#s-manut-tarefas" rel="section" title="27.10 Tarefas automáticas de manutenção do sistema">
<link href="ch-manut.html#s-manut-cron" rel="section" title="27.11 cron">
<link href="ch-manut.html#s-manut-at" rel="section" title="27.12 at">
<link href="ch-etc.html#s-etc-alternatives" rel="section" title="28.1 Diretório /etc/alternatives">
<link href="ch-etc.html#s-etc-devpts" rel="section" title="28.2 Arquivo /etc/default/devpts">
<link href="ch-etc.html#s-etc-rcs" rel="section" title="28.3 Arquivo /etc/default/rcS">
<link href="ch-etc.html#s-etc-config" rel="section" title="28.4 Arquivo /etc/console-tools/config">
<link href="ch-etc.html#s-etc-menu-methods" rel="section" title="28.5 Diretório /etc/menu-methods">
<link href="ch-etc.html#s-etc-menu-translate" rel="section" title="28.6 Arquivo /etc/menu-methods/translate_menus">
<link href="ch-etc.html#s-etc-networks" rel="section" title="28.7 Diretório /etc/network">
<link href="ch-etc.html#s-etc-network-interfaces" rel="section" title="28.8 Arquivo /etc/network/interfaces">
<link href="ch-etc.html#s-etc-networks-options" rel="section" title="28.9 Arquivo /etc/networks/options">
<link href="ch-etc.html#s-etc-pam" rel="section" title="28.10 Diretório /etc/pam.d">
<link href="ch-etc.html#s-etc-ppp" rel="section" title="28.11 Diretório /etc/ppp">
<link href="ch-etc.html#s-etc-security" rel="section" title="28.12 Diretório /etc/security">
<link href="ch-etc.html#s-etc-security-access" rel="section" title="28.13 Arquivo /etc/security/access.conf">
<link href="ch-etc.html#s-etc-securith-limits" rel="section" title="28.14 Arquivo /etc/security/limits.conf">
<link href="ch-etc.html#s-etc-crontab" rel="section" title="28.15 Arquivo /etc/crontab">
<link href="ch-etc.html#s28.16" rel="section" title="28.16 Arquivo /etc/fstab">
<link href="ch-etc.html#s28.17" rel="section" title="28.17 Arquivo /etc/group">
<link href="ch-etc.html#s-etc-gshadow" rel="section" title="28.18 Arquivo /etc/gshadow">
<link href="ch-etc.html#s28.19" rel="section" title="28.19 Arquivo /etc/host.conf">
<link href="ch-etc.html#s28.20" rel="section" title="28.20 Arquivo /etc/hostname">
<link href="ch-etc.html#s28.21" rel="section" title="28.21 Arquivo /etc/hosts">
<link href="ch-etc.html#s28.22" rel="section" title="28.22 Arquivo /etc/hosts.allow">
<link href="ch-etc.html#s28.23" rel="section" title="28.23 Arquivo /etc/hosts.deny">
<link href="ch-etc.html#s28.24" rel="section" title="28.24 Arquivo /etc/hosts.equiv">
<link href="ch-etc.html#s28.25" rel="section" title="28.25 Arquivo /etc/inetd.conf">
<link href="ch-etc.html#s-etc-inittab" rel="section" title="28.26 Arquivo /etc/inittab">
<link href="ch-etc.html#s-etc-inputrc" rel="section" title="28.27 Arquivo /etc/inputrc">
<link href="ch-etc.html#s-etc-issue" rel="section" title="28.28 Arquivo /etc/issue">
<link href="ch-etc.html#s-etc-issue-n" rel="section" title="28.29 Arquivo /etc/issue.net">
<link href="ch-etc.html#s28.30" rel="section" title="28.30 Arquivo /etc/lilo.conf">
<link href="ch-etc.html#s-etc-login-d" rel="section" title="28.31 Arquivo /etc/login.defs">
<link href="ch-etc.html#s28.32" rel="section" title="28.32 Arquivo /etc/modules">
<link href="ch-etc.html#s28.33" rel="section" title="28.33 Arquivo /etc/modules.conf">
<link href="ch-etc.html#s-etc-motd" rel="section" title="28.34 Arquivo /etc/motd">
<link href="ch-etc.html#s-etc-mtab" rel="section" title="28.35 Arquivo /etc/mtab">
<link href="ch-etc.html#s28.36" rel="section" title="28.36 Arquivo /etc/networks">
<link href="ch-etc.html#s-etc-passwd" rel="section" title="28.37 Arquivo /etc/passwd">
<link href="ch-etc.html#s-etc-printcap" rel="section" title="28.38 Arquivo /etc/printcap">
<link href="ch-etc.html#s28.39" rel="section" title="28.39 Arquivo /etc/protocols">
<link href="ch-etc.html#s28.40" rel="section" title="28.40 Arquivo /etc/resolv.conf">
<link href="ch-etc.html#s-serial-c" rel="section" title="28.41 Arquivo /etc/serial.conf">
<link href="ch-etc.html#s28.42" rel="section" title="28.42 Arquivo /etc/services">
<link href="ch-etc.html#s-etc-shadow" rel="section" title="28.43 Arquivo /etc/shadow">
<link href="ch-etc.html#s-etc-shells" rel="section" title="28.44 Arquivo /etc/shells">
<link href="ch-etc.html#s-etc-syslog-c" rel="section" title="28.45 Arquivo /etc/syslog.conf">
<link href="ch-etc.html#s-etc-timezones" rel="section" title="28.46 Arquivo /etc/timezone">
<link href="ch-inter.html#s-inter-conectando" rel="section" title="29.1 Conectando-se a Internet">
<link href="ch-inter.html#s-inter-navegando" rel="section" title="29.2 Navegando na Internet">
<link href="ch-inter.html#s-inter-emails-r" rel="section" title="29.3 Recebimento de E-Mails através do fetchmail">
<link href="ch-x11.html#s-x11-descricao" rel="section" title="30.1 O que é X Window?">
<link href="ch-x11.html#s-x11-estrutura" rel="section" title="30.2 A organização do ambiente gráfico X Window">
<link href="ch-x11.html#s-x11-iniciando" rel="section" title="30.3 Iniciando o X">
<link href="ch-x11.html#s-x11-servidor" rel="section" title="30.4 Servidor X">
<link href="ch-fw-iptables.html#s-fw-iptables-intro" rel="section" title="31.1 Introdução">
<link href="ch-fw-iptables.html#s-fw-iptables-chains" rel="section" title="31.2 Manipulando chains">
<link href="ch-fw-iptables.html#s-fw-iptables-outras" rel="section" title="31.3 Outras opções do iptables">
<link href="ch-fw-iptables.html#s-fw-iptables-nat" rel="section" title="31.4 A tabela nat (Network Address Translation) - fazendo nat">
<link href="ch-fw-iptables.html#s-fw-iptables-mangle" rel="section" title="31.5 A tabela mangle">
<link href="ch-fw-iptables.html#s-fw-iptables-mod" rel="section" title="31.6 Outros módulos do iptables">
<link href="ch-fw-iptables.html#s-fw-iptables-path" rel="section" title="31.7 Caminho percorrido pelos pacotes nas tabelas e chains">
<link href="ch-fw-iptables.html#s-fw-iptables-exemplo" rel="section" title="31.8 Exemplos de configurações do iptables">
<link href="ch-d-contas.html#s-d-contas-intro" rel="section" title="32.1 Introdução">
<link href="ch-d-contas.html#s-d-contas-cms" rel="section" title="32.2 Criação, monitoramento e segurança de contas">
<link href="ch-d-contas.html#s-d-contas-ataques" rel="section" title="32.3 Tipos de ataques mais comuns para se conseguir uma senha.">
<link href="ch-d-contas.html#s-d-contas-segsenhas" rel="section" title="32.4 Melhorando a segurança das senhas armazenadas em seu sistema">
<link href="ch-s-apache.html#s-s-apache-intro" rel="section" title="33.1 Introdução">
<link href="ch-s-apache.html#s-s-apache-port" rel="section" title="33.2 Configurando a porta padrão do Apache">
<link href="ch-s-apache.html#s-s-apache-adicpagina" rel="section" title="33.3 Adicionando uma página no Apache">
<link href="ch-s-apache.html#s-s-apache-bindaddress" rel="section" title="33.4 Configurando as interfaces que o Apache atenderá">
<link href="ch-s-apache.html#s-s-apache-listen" rel="section" title="33.5 Especificando endereços/portas adicionais (a diretiva Listen)">
<link href="ch-s-apache.html#s-s-apache-acesso" rel="section" title="33.6 Especificando opções/permissões para as páginas">
<link href="ch-s-apache.html#s-s-apache-acesso-restr" rel="section" title="33.7 Restrições de Acesso">
<link href="ch-s-apache.html#s-s-apache-errordocument" rel="section" title="33.8 Definindo documentos de erro personalizados">
<link href="ch-s-apache.html#s-s-apache-dso" rel="section" title="33.9 Módulos DSO">
<link href="ch-s-apache.html#s-s-apache-log" rel="section" title="33.10 Sistema de Log do Apache">
<link href="ch-s-apache.html#s-s-apache-proxy" rel="section" title="33.11 Configurando o Apache como servidor proxy">
<link href="ch-s-apache.html#s-s-apache-vhosts" rel="section" title="33.12 Virtual Hosts">
<link href="ch-s-apache.html#s-s-apache-ssl" rel="section" title="33.13 Uso de criptografia SSL">
<link href="ch-s-apache.html#s-s-apache-exemplo" rel="section" title="33.14 Exemplo comentado de um arquivo de configuração do Apache">
<link href="ch-s-apache.html#s-s-apache-httpcodes" rel="section" title="33.15 Códigos HTTP">
<link href="ch-s-ident.html#s-s-ident-intro" rel="section" title="34.1 Introdução">
<link href="ch-s-telnet.html#s-s-telnet-intro" rel="section" title="35.1 Introdução">
<link href="ch-s-telnet.html#s-s-telnet-access" rel="section" title="35.2 Controle de acesso">
<link href="ch-s-telnet.html#s-s-telnet-recomend" rel="section" title="35.3 Recomendações">
<link href="ch-s-telnet.html#s-s-telnet-telnet" rel="section" title="35.4 Fazendo conexões ao servidor telnet">
<link href="ch-s-ssh.html#s-s-ssh-intro" rel="section" title="36.1 Introdução">
<link href="ch-s-ssh.html#s-s-ssh-cliente" rel="section" title="36.2 Usando aplicativos clientes">
<link href="ch-s-ssh.html#s-s-ssh-server" rel="section" title="36.3 Servidor ssh">
<link href="ch-s-pop3.html#s-s-pop3-intro" rel="section" title="37.1 Introdução">
<link href="ch-s-cvs.html#s-s-cvs-intro" rel="section" title="38.1 Introdução ao CVS">
<link href="ch-s-cvs.html#s-s-cvs-d" rel="section" title="38.2 Servidor de CVS - configurando métodos de acesso ao repositório">
<link href="ch-s-cvs.html#s-s-cvs-p" rel="section" title="38.3 Criando projetos para serem usados no CVS">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot" rel="section" title="38.4 Arquivos administrativos em CVSROOT">
<link href="ch-s-cvs.html#s-s-cvs-c" rel="section" title="38.5 Clientes de CVS">
<link href="ch-s-cvs.html#s-s-cvs-exemplo" rel="section" title="38.6 Exemplo de uma seção CVS">
<link href="ch-s-samba.html#s-s-samba-intro" rel="section" title="39.1 Introdução">
<link href="ch-s-samba.html#s-s-samba-s" rel="section" title="39.2 Conceitos gerais para a configuração do SAMBA">
<link href="ch-s-samba.html#s-s-samba-s-a" rel="section" title="39.3 Compartilhamento de arquivos e diretórios">
<link href="ch-s-samba.html#s-s-samba-wrkgrp" rel="section" title="39.4 Configuração em Grupo de Trabalho">
<link href="ch-s-samba.html#s-s-samba-s-nameresolv" rel="section" title="39.5 Resolução de nomes de máquinas no samba">
<link href="ch-s-samba.html#s-s-samba-s-timeserver" rel="section" title="39.6 Servidor de data/hora">
<link href="ch-s-samba.html#s-s-samba-dom" rel="section" title="39.7 Configuração em Domínio">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto" rel="section" title="39.8 Ativando o suporte a senhas criptografadas">
<link href="ch-s-samba.html#s-s-samba-senhas-plano" rel="section" title="39.9 Ativando o suporte a senhas em texto plano">
<link href="ch-s-samba.html#s-s-samba-usermap" rel="section" title="39.10 Mapeamento de usuários/grupos em clientes">
<link href="ch-s-samba.html#s-s-samba-i" rel="section" title="39.11 Compartilhamento de impressão no servidor SAMBA">
<link href="ch-s-samba.html#s-s-samba-a" rel="section" title="39.12 Controle de acesso ao servidor SAMBA">
<link href="ch-s-samba.html#s-s-samba-perf" rel="section" title="39.13 Melhorando a performance do compartilhamento/servidor">
<link href="ch-s-samba.html#s-s-samba-c" rel="section" title="39.14 Configuração de Clientes NetBEUI">
<link href="ch-s-samba.html#s-s-samba-exemplos" rel="section" title="39.15 Exemplos de configuração do servidor SAMBA">
<link href="ch-d-restr.html#s-d-restr-bash" rel="section" title="40.1 Limitando recursos no bash">
<link href="ch-d-restr.html#s-d-restr-pam" rel="section" title="40.2 Limitação de recursos usando PAM">
<link href="ch-d-restr.html#s-d-restr-grupos" rel="section" title="40.3 Restrições de acesso a programas/diretórios/arquivos usando grupos">
<link href="ch-d-restr.html#s-d-restr-sudo" rel="section" title="40.4 Dando poderes de root para executar determinados programas">
<link href="ch-d-restr.html#s-d-restr-su" rel="section" title="40.5 Restringindo o comando su">
<link href="ch-d-restr.html#s-d-restr-identd" rel="section" title="40.6 Restrições baseadas em usuário/IP">
<link href="ch-d-restr.html#s-d-restr-ipmac" rel="section" title="40.7 Restrições por MAC Address/IP">
<link href="ch-d-restr.html#s-d-restr-inetd" rel="section" title="40.8 Desabilitando serviços não usados no Inetd">
<link href="ch-d-restr.html#s-d-restr-authinseg" rel="section" title="40.9 Evitando o uso de hosts.equiv e .rhosts">
<link href="ch-d-restr.html#s-d-restr-shutdown" rel="section" title="40.10 Restringindo o uso do shutdown">
<link href="ch-d-restr.html#s-d-restr-proc" rel="section" title="40.11 Restringindo o acesso ao sistema de arquivos /proc">
<link href="ch-d-restr.html#s-d-restr-quotas" rel="section" title="40.12 Limitando o uso de espaço em disco (quotas)">
<link href="ch-d-restr.html#s40.13" rel="section" title="40.13 Suporte a senhas ocultas">
<link href="ch-d-restr.html#s40.14" rel="section" title="40.14 Suporte a senhas md5">
<link href="ch-d-restr.html#s-d-restr-hardware" rel="section" title="40.15 Restrições no hardware do sistema">
<link href="ch-d-cripto.html#s-d-cripto-intro" rel="section" title="41.1 Introdução">
<link href="ch-d-cripto.html#s-d-cripto-sniffer" rel="section" title="41.2 Sniffer">
<link href="ch-d-cripto.html#s-d-cripto-alt" rel="section" title="41.3 Alternativas seguras a serviços sem criptografia">
<link href="ch-d-cripto.html#s-d-cripto-criptofs" rel="section" title="41.4 Sistemas de arquivos criptográfico">
<link href="ch-d-cripto.html#s-d-cripto-gpg" rel="section" title="41.5 Usando pgp (gpg)para criptografia de arquivos">
<link href="ch-aplic.html#s-aplic-b" rel="section" title="42.1 Aplicativos Básicos">
<link href="ch-aplic.html#s42.2" rel="section" title="42.2 Listagem de Aplicativos para GNU/Linux">
<link href="ch-ajuda.html#s-ajuda-man" rel="section" title="43.1 Páginas de Manual">
<link href="ch-ajuda.html#s-ajuda-info" rel="section" title="43.2 Info Pages">
<link href="ch-ajuda.html#s-ajuda-helponline" rel="section" title="43.3 Help on line">
<link href="ch-ajuda.html#s-ajuda-help" rel="section" title="43.4 help">
<link href="ch-ajuda.html#s-ajuda-apropos" rel="section" title="43.5 apropos/whatis">
<link href="ch-ajuda.html#s-ajuda-locate" rel="section" title="43.6 locate">
<link href="ch-ajuda.html#s-ajuda-which" rel="section" title="43.7 which">
<link href="ch-ajuda.html#s-ajuda-howto" rel="section" title="43.8 Documentos HOWTO's">
<link href="ch-ajuda.html#s-ajuda-docs" rel="section" title="43.9 Documentação de Programas">
<link href="ch-ajuda.html#s-ajuda-faq" rel="section" title="43.10 FAQ">
<link href="ch-ajuda.html#s-ajuda-internet" rel="section" title="43.11 Internet">
<link href="ch-ajuda.html#s-ajuda-netiqueta" rel="section" title="43.12 Netiqueta">
<link href="ch-systemd.html#s-s-systemd-historia" rel="section" title="44.1 Um pouco história sobre o systemd">
<link href="ch-systemd.html#s-s-systemd-uso" rel="section" title="44.2 Usando o systemd">
<link href="ch-git.html#s-s-git-historia" rel="section" title="45.1 Sobre o Git">
<link href="ch-git.html#s-s-git-caracteristicas" rel="section" title="45.2 Características e critérios">
<link href="ch-git.html#s-s-git-comandos" rel="section" title="45.3 Comandos do Git">
<link href="ch-virt-intro.html#s-virt-motivos" rel="section" title="46.1 Por que usar virtualização">
<link href="ch-virt-intro.html#s-virt-tipos" rel="section" title="46.2 Tipos de virtualização">
<link href="ch-virt-intro.html#s-virt-nomenclatura" rel="section" title="46.3 Nomenclaturas de virtualização">
<link href="ch-virt-intro.html#s-virt-lxc" rel="section" title="46.4 LXC - Linux Container">
<link href="ch-apend.html#s-apend-sobre" rel="section" title="47.1 Sobre este guia">
<link href="ch-apend.html#s-apend-autor" rel="section" title="47.2 Sobre o Autor">
<link href="ch-apend.html#s-apend-ref" rel="section" title="47.3 Referências de auxílio ao desenvolvimento do guia">
<link href="ch-apend.html#s-apend-homepage" rel="section" title="47.4 Onde encontrar a versão mais nova do guia?">
<link href="ch-apend.html#s-apend-colaboradores" rel="section" title="47.5 Colaboradores do Guia">
<link href="ch-apend.html#s-apend-mr" rel="section" title="47.6 Marcas Registradas">
<link href="ch-apend.html#s-apend-new" rel="section" title="47.7 Futuras versões">
<link href="ch-apend.html#s-apend-pgp" rel="section" title="47.8 Chave Pública PGP">
<link href="ch-intro.html#s-introducao-linux-carac" rel="subsection" title="1.4.1 Algumas Características do GNU/Linux">
<link href="ch-intro.html#s-introducao-conhecendo-tipo" rel="subsection" title="1.9.1 Tipos de Gabinete">
<link href="ch-intro.html#s-introducao-conhecendo-painel" rel="subsection" title="1.9.2 Painel Frontal">
<link href="ch-intro.html#s-introducao-conhecendo-monitor" rel="subsection" title="1.9.3 Monitor de Vídeo">
<link href="ch-intro.html#s-introducao-placamae-outros" rel="subsection" title="1.10.1 Alguns componentes da placa mãe">
<link href="ch-intro.html#s-introducao-memoria-principal" rel="subsection" title="1.11.1 Memória Principal">
<link href="ch-intro.html#s-introducao-memoria-auxiliar" rel="subsection" title="1.11.2 Memória Auxiliar">
<link href="ch-intro.html#s-introducao-discos-flexiveis" rel="subsection" title="1.12.1 Discos Flexíveis">
<link href="ch-intro.html#s-introducao-discos-rigidos" rel="subsection" title="1.12.2 Disco Rígido">
<link href="ch-intro.html#s-introducao-discos-cd" rel="subsection" title="1.12.3 CD/DVD/BluRay">
<link href="ch-bas.html#s-basico-arquivo-tipos" rel="subsection" title="2.2.1 Extensão de arquivos">
<link href="ch-bas.html#s-basico-arquivo-tamanho" rel="subsection" title="2.2.2 Tamanho de arquivos">
<link href="ch-bas.html#s-basico-arquivo-bintext" rel="subsection" title="2.2.3 Arquivo texto e binário">
<link href="ch-bas.html#s-basico-diretorio-raiz" rel="subsection" title="2.3.1 Diretório Raíz">
<link href="ch-bas.html#s-basico-diretorio-atual" rel="subsection" title="2.3.2 Diretório atual">
<link href="ch-bas.html#s-basico-diretorio-home" rel="subsection" title="2.3.3 Diretório home">
<link href="ch-bas.html#s-basico-diretorio-superior" rel="subsection" title="2.3.4 Diretório Superior">
<link href="ch-bas.html#s-basico-diretorio-anterior" rel="subsection" title="2.3.5 Diretório Anterior">
<link href="ch-bas.html#s-basico-diretorio-caminho" rel="subsection" title="2.3.6 Caminho na estrutura de diretórios">
<link href="ch-bas.html#s-basico-diretorio-exemplo" rel="subsection" title="2.3.7 Exemplo de diretório">
<link href="ch-bas.html#s-basico-diretorio-estrutura" rel="subsection" title="2.3.8 Estrutura básica de diretórios do Sistema Linux">
<link href="ch-bas.html#s-basico-comandos-internos" rel="subsection" title="2.5.1 Comandos Internos">
<link href="ch-hardw.html#s-hardw-cfg-irq" rel="subsection" title="3.3.1 IRQ - Requisição de Interrupção">
<link href="ch-hardw.html#s3.3.1.1" rel="subsection" title="3.3.1.1 Prioridade das Interrupções">
<link href="ch-hardw.html#s-hardw-cfg-dma" rel="subsection" title="3.3.2 DMA - Acesso Direto a Memória">
<link href="ch-hardw.html#s3.3.2.1" rel="subsection" title="3.3.2.1 Conflitos de DMA">
<link href="ch-hardw.html#s-hardw-cfg-io" rel="subsection" title="3.3.3 I/O - Porta de Entrada/Saída">
<link href="ch-hardw.html#s-hardw-metodoscfg-jumpers" rel="subsection" title="3.4.1 Jumpers">
<link href="ch-hardw.html#s-hardw-metodoscfg-dipswitche" rel="subsection" title="3.4.2 Dip-Switches">
<link href="ch-hardw.html#s-hardw-metodoscfg-jumperless" rel="subsection" title="3.4.3 Jumperless (sem jumper)">
<link href="ch-hardw.html#s-hardw-metodoscfg-plug-and-play" rel="subsection" title="3.4.4 Plug-and-Play">
<link href="ch-hardw.html#s-hardw-cfgdisp-rede" rel="subsection" title="3.11.1 Configurando uma placa de rede">
<link href="ch-hardw.html#s-hardw-cfgdisp-som" rel="subsection" title="3.11.2 Configurando uma placa de SOM no Linux">
<link href="ch-hardw.html#s-hardw-cfgdisp-som-oss" rel="subsection" title="3.11.2.1 Configurando uma placa de som usando o padrão OSS">
<link href="ch-hardw.html#s-hardw-cfgdisp-cdwritter" rel="subsection" title="3.11.3 Configurando um gravador de CD/DVD no Linux">
<link href="ch-hardw.html#s-hardw-cfgdisp-cdwritter-ide" rel="subsection" title="3.11.3.1 Configurando o suporte a um gravador IDE">
<link href="ch-hardw.html#s-hardw-cfgdisp-cdwritter-scsi" rel="subsection" title="3.11.3.2 Configurando o suporte a um gravador SCSI">
<link href="ch-hardw.html#s-hardw-cfgdisp-cdwritter-teste" rel="subsection" title="3.11.3.3 Testando o funcionamento">
<link href="ch-hardw.html#s-hardw-cfgdisp-apm" rel="subsection" title="3.11.4 Configurando o gerenciamento de energia usando o APM">
<link href="ch-hardw.html#s-hardw-cfgdisp-acpi" rel="subsection" title="3.11.5 Configurando o gerenciamento de energia usando ACPI">
<link href="ch-hardw.html#s-hardw-cfgdisp-wol" rel="subsection" title="3.11.6 Ativando WakeUP on Lan">
<link href="ch-d-l.html#s4.2.1" rel="subsection" title="4.2.1 Arquivos de configuração">
<link href="ch-disc.html#s-disc-formatando-l" rel="subsection" title="5.2.1 Formatando pen-drives para serem usados no Linux">
<link href="ch-disc.html#s-disc-formatando-d" rel="subsection" title="5.2.2 Formatando pen-drives compatíveis com o Windows">
<link href="ch-disc.html#s-disc-formatando-g" rel="subsection" title="5.2.3 Programas de Formatação Gráficos">
<link href="ch-disc.html#s-disc-fstab" rel="subsection" title="5.5.1 fstab">
<link href="ch-boot.html#s-boot-lilo-cfg" rel="subsection" title="6.1.1 Criando o arquivo de configuração do LILO">
<link href="ch-boot.html#s-boot-lilo-opcoes" rel="subsection" title="6.1.2 Opções usadas no LILO">
<link href="ch-boot.html#s-boot-lilo-exemplo" rel="subsection" title="6.1.3 Um exemplo do arquivo de configuração lilo.conf">
<link href="ch-boot.html#s-boot-grub-part" rel="subsection" title="6.2.1 Como o GRUB trabalha com discos e partições">
<link href="ch-boot.html#s-boot-grub-install" rel="subsection" title="6.2.2 Instalando o GRUB">
<link href="ch-boot.html#s-boot-grub-install-mbr" rel="subsection" title="6.2.2.1 No MBR">
<link href="ch-boot.html#s-boot-grub-install-fd-cmd" rel="subsection" title="6.2.3 No disco flexível (somente linha de comando)">
<link href="ch-boot.html#s-boot-grub-install-fd-menu" rel="subsection" title="6.2.4 No disco flexível (com interface de menu)">
<link href="ch-boot.html#s-boot-grub-opcoescfg" rel="subsection" title="6.2.5 Opções do arquivo de configuração">
<link href="ch-boot.html#s-boot-grub-exemplo" rel="subsection" title="6.2.6 Um exemplo de arquivo de configuração">
<link href="ch-boot.html#s-boot-grub-cmdline" rel="subsection" title="6.2.7 Usando a linha de comandos do GRUB">
<link href="ch-boot.html#s-boot-grub-removendo" rel="subsection" title="6.2.8 Removendo o GRUB do MBR">
<link href="ch-boot.html#s-boot-grub-detalhes" rel="subsection" title="6.2.9 Como obter informações mais detalhadas">
<link href="ch-boot.html#s-boot-loadlin-opcoes" rel="subsection" title="6.4.1 Opções do LOADLIN">
<link href="ch-boot.html#s-boot-loadlin-exemplo" rel="subsection" title="6.4.2 Exemplo de inicialização com o LOADLIN">
<link href="ch-boot.html#s-boot-syslinux-criando" rel="subsection" title="6.5.1 Criando um disquete de inicialização com o syslinux">
<link href="ch-boot.html#s-boot-syslinux-opcoes" rel="subsection" title="6.5.2 O arquivo SYSLINUX.CFG">
<link href="ch-boot.html#s-boot-syslinux-formatacao" rel="subsection" title="6.5.3 Formatação dos arquivos de tela do syslinux">
<link href="ch-run.html#s-run-break" rel="subsection" title="7.7.1 Interrompendo a execução de um processo">
<link href="ch-run.html#s-run-pausa" rel="subsection" title="7.7.2 Parando momentaneamente a execução de um processo">
<link href="ch-run.html#s-run-ver-backgrounds" rel="subsection" title="7.7.3 jobs">
<link href="ch-run.html#s-run-fg" rel="subsection" title="7.7.4 fg">
<link href="ch-run.html#s-run-bg" rel="subsection" title="7.7.5 bg">
<link href="ch-run.html#s-run-kill" rel="subsection" title="7.7.6 kill">
<link href="ch-run.html#s-run-killall" rel="subsection" title="7.7.7 killall">
<link href="ch-run.html#s-run-killall5" rel="subsection" title="7.7.8 killall5">
<link href="ch-run.html#s-run-sinais" rel="subsection" title="7.7.9 Sinais do Sistema">
<link href="ch-perm.html#s-perm-exemplo-a" rel="subsection" title="13.4.1 Exemplo de acesso a um arquivo">
<link href="ch-perm.html#s-perm-exemplo-d" rel="subsection" title="13.4.2 Exemplo de acesso a um diretório">
<link href="ch-rede.html#s-rede-ip-classes" rel="subsection" title="15.3.1 Classes de Rede IP">
<link href="ch-rede.html#s-rede-ip-nova" rel="subsection" title="15.3.2 Para instalar uma máquina usando o Linux em uma rede existente">
<link href="ch-rede.html#s-rede-ip-privada" rel="subsection" title="15.3.3 Endereços reservados para uso em uma rede Privada">
<link href="ch-rede.html#s-rede-interfaces-lo" rel="subsection" title="15.4.1 A interface loopback">
<link href="ch-rede.html#s-rede-interfaces-c" rel="subsection" title="15.4.2 Atribuindo um endereço de rede a uma interface (ifconfig)">
<link href="ch-rede.html#s-rede-rota-c" rel="subsection" title="15.5.1 Configurando uma rota no Linux">
<link href="ch-rede.html#s-rede-dns-oque" rel="subsection" title="15.6.1 O que é um nome?">
<link href="ch-rede.html#s-rede-dns-a" rel="subsection" title="15.6.2 Arquivos de configuração usados na resolução de nomes">
<link href="ch-rede.html#s-rede-dns-a-resolv" rel="subsection" title="15.6.2.1 /etc/resolv.conf">
<link href="ch-rede.html#s-rede-dns-a-hostconf" rel="subsection" title="15.6.2.2 /etc/host.conf">
<link href="ch-rede.html#s-rede-dns-a-hosts" rel="subsection" title="15.6.2.3 /etc/hosts">
<link href="ch-rede.html#s-rede-dns-a-networks" rel="subsection" title="15.6.2.4 /etc/networks">
<link href="ch-rede.html#s-rede-dns-servdns" rel="subsection" title="15.6.3 Executando um servidor de nomes">
<link href="ch-rede.html#s-rede-servicos-daemon" rel="subsection" title="15.7.1 Serviços iniciados como Daemons de rede">
<link href="ch-rede.html#s-rede-servicos-inetd" rel="subsection" title="15.7.2 Serviços iniciados através do inetd">
<link href="ch-rede.html#s-rede-servicos-inetd-c" rel="subsection" title="15.7.2.1 /etc/inetd.conf">
<link href="ch-rede.html#s-rede-seg-ftpusers" rel="subsection" title="15.8.1 /etc/ftpusers">
<link href="ch-rede.html#s-rede-seg-securetty" rel="subsection" title="15.8.2 /etc/securetty">
<link href="ch-rede.html#s-rede-seg-tcpd" rel="subsection" title="15.8.3 O mecanismo de controle de acessos tcpd">
<link href="ch-rede.html#s-rede-seg-tcpd-a" rel="subsection" title="15.8.3.1 /etc/hosts.allow">
<link href="ch-rede.html#s-rede-seg-tcpd-d" rel="subsection" title="15.8.3.2 /etc/hosts.deny">
<link href="ch-rede.html#s-rede-seg-tcpd-e" rel="subsection" title="15.8.3.3 /etc/hosts.equiv e /etc/shosts.equiv">
<link href="ch-rede.html#s-rede-seg-tcpd-v" rel="subsection" title="15.8.3.4 Verificando a segurança do TCPD e a sintaxe dos arquivos">
<link href="ch-rede.html#s-rede-seg-firewall" rel="subsection" title="15.8.4 Firewall">
<link href="ch-rede.html#s-rede-outros-services" rel="subsection" title="15.9.1 /etc/services">
<link href="ch-rede.html#s-rede-outros-protocols" rel="subsection" title="15.9.2 /etc/protocols">
<link href="ch-cfgrede.html#s-cfgs-bridge-req" rel="subsection" title="16.2.1 Requerimentos para a Instalação">
<link href="ch-cfgrede.html#s-cfgs-bridge-cfg" rel="subsection" title="16.2.2 Configuração da bridge">
<link href="ch-cfgrede.html#s-cfgs-bridge-cfgadv" rel="subsection" title="16.2.3 Configurações mais avançadas de bridge">
<link href="ch-cfgrede.html#s-cfgs-bridge-cfgmanual" rel="subsection" title="16.2.4 Configuração manual da bridge">
<link href="ch-cfgrede.html#s-cfgs-bridge-fw" rel="subsection" title="16.2.5 Usando o iptables para construir um firewall na máquina da bridge">
<link href="ch-cfgrede.html#s-cfgs-bridge-filternoip" rel="subsection" title="16.2.6 Filtrando pacotes não IP na bridge">
<link href="ch-cfgrede.html#s-cfgs-plip-cabo" rel="subsection" title="16.3.1 Construindo um cabo LapLink Paralelo">
<link href="ch-cfgrede.html#s-cfgs-slattach-cabo" rel="subsection" title="16.4.1 Construindo um cabo LapLink Serial">
<link href="ch-kern.html#s-kern-arquivos-modules" rel="subsection" title="17.12.1 /etc/modules">
<link href="ch-kern.html#s-kern-arquivos-modulesconf" rel="subsection" title="17.12.2 modules.conf">
<link href="ch-log.html#s-log-syslogd" rel="subsection" title="18.2.1 syslogd">
<link href="ch-log.html#s-log-syslogd-exemplo" rel="subsection" title="18.2.1.1 Arquivo de configuração syslog.conf">
<link href="ch-log.html#s-log-klogd" rel="subsection" title="18.2.2 klogd">
<link href="ch-cpctd.html#s-cpctd-tipos" rel="subsection" title="19.1.1 Tipos de compactação">
<link href="ch-deb.html#s-deb-runlevels-e" rel="subsection" title="20.4.1 Entendendo o funcionamento dos níveis de execução do sistema (runlevels)">
<link href="ch-dpkg.html#s-dpkg-pacotes" rel="subsection" title="21.1.1 Pacotes">
<link href="ch-dpkg.html#s-dpkg-instalar" rel="subsection" title="21.1.2 Instalar pacotes">
<link href="ch-dpkg.html#s-dpkg-dependencias" rel="subsection" title="21.1.3 Dependências">
<link href="ch-dpkg.html#s-dpkg-l" rel="subsection" title="21.1.4 Listar pacotes existentes no sistema">
<link href="ch-dpkg.html#s-dpkg-r" rel="subsection" title="21.1.5 Removendo pacotes do sistema">
<link href="ch-dpkg.html#s-dpkg-purge" rel="subsection" title="21.1.6 Removendo completamente um pacote">
<link href="ch-dpkg.html#s-dpkg-I" rel="subsection" title="21.1.7 Mostrar descrição do pacote">
<link href="ch-dpkg.html#s-dpkg-S" rel="subsection" title="21.1.8 Procura de pacotes através do nome de um arquivo">
<link href="ch-dpkg.html#s-dpkg-s" rel="subsection" title="21.1.9 Status do pacote">
<link href="ch-dpkg.html#s-dpkg-C" rel="subsection" title="21.1.10 Procurando pacotes com problemas de instalação">
<link href="ch-dpkg.html#s-dpkg-get-selections" rel="subsection" title="21.1.11 Mostrando a lista de pacotes do sistema">
<link href="ch-dpkg.html#s-dpkg-set-selections" rel="subsection" title="21.1.12 Obtendo uma lista de pacotes para instalar no sistema">
<link href="ch-dpkg.html#s-dpkg-configure" rel="subsection" title="21.1.13 Configurando pacotes desconfigurados">
<link href="ch-dpkg.html#s-dpkg-c" rel="subsection" title="21.1.14 Listando arquivos de um pacote">
<link href="ch-dpkg.html#s21.2.1" rel="subsection" title="21.2.1 O arquivo /etc/apt/sources.list">
<link href="ch-dpkg.html#s21.2.1.1" rel="subsection" title="21.2.1.1 Endereços de servidores e mirrors nacionais da Debian">
<link href="ch-dpkg.html#s21.2.1.2" rel="subsection" title="21.2.1.2 Um modelo de arquivo sources.list">
<link href="ch-dpkg.html#s21.2.2" rel="subsection" title="21.2.2 O arquivo /etc/apt/apt.conf">
<link href="ch-dpkg.html#s21.2.3" rel="subsection" title="21.2.3 Copiando a lista de pacotes disponíveis">
<link href="ch-dpkg.html#s21.2.4" rel="subsection" title="21.2.4 Utilizando CDs oficiais/não-oficiais/terceiros com o apt">
<link href="ch-dpkg.html#s21.2.5" rel="subsection" title="21.2.5 Instalando novos pacotes">
<link href="ch-dpkg.html#s21.2.6" rel="subsection" title="21.2.6 Removendo pacotes instalado">
<link href="ch-dpkg.html#s21.2.7" rel="subsection" title="21.2.7 Atualizando sua distribuição">
<link href="ch-dpkg.html#s21.2.8" rel="subsection" title="21.2.8 Removendo pacotes baixados pelo apt">
<link href="ch-dpkg.html#s21.2.9" rel="subsection" title="21.2.9 Procurando por pacotes através da descrição">
<link href="ch-dpkg.html#s21.2.10" rel="subsection" title="21.2.10 Procurando um pacote que contém determinado arquivo">
<link href="ch-dpkg.html#s21.2.11" rel="subsection" title="21.2.11 Modos eficazes de compilação do código fonte para a Debian">
<link href="ch-dpkg.html#s21.2.12" rel="subsection" title="21.2.12 Verificando pacotes corrompidos">
<link href="ch-dpkg.html#s21.2.13" rel="subsection" title="21.2.13 Corrigindo problemas de dependências e outros erros">
<link href="ch-impr.html#s-impr-ghostscript" rel="subsection" title="23.4.1 Ghost Script">
<link href="ch-impr.html#s-impr-magicfilter-i" rel="subsection" title="23.5.1 Instalação e configuração do Magic Filter">
<link href="ch-impr.html#s-impr-magicfilter-c" rel="subsection" title="23.5.2 Outros detalhes técnicos sobre o Magic Filter">
<link href="ch-cfg.html#s-cfg-acentuacao-t" rel="subsection" title="24.1.1 Acentuação em modo Texto">
<link href="ch-cfg.html#s-cfg-acentuacao-g" rel="subsection" title="24.1.2 Acentuação em modo gráfico">
<link href="ch-tasks.html#s-tasks-cdwriting-data" rel="subsection" title="25.1.1 Gravando CDs / DVDs de dados">
<link href="ch-tasks.html#s-tasks-cdwriting-audio" rel="subsection" title="25.1.2 Gravando um CD de audio">
<link href="ch-tasks.html#s-tasks-cdwriting-cdcd" rel="subsection" title="25.1.3 Cópia de CD para CD no mesmo gravador">
<link href="ch-tasks.html#s-tasks-cdwriting-massivewrite" rel="subsection" title="25.1.4 Gravação massiva de CDs">
<link href="ch-tasks.html#s-tasks-cdwriting-cdfrommp3" rel="subsection" title="25.1.5 Gravação de CDs diretamente através de arquivos mp3 ou Ogg">
<link href="ch-tasks.html#s-tasks-cdwriting-backupcd" rel="subsection" title="25.1.6 Backup de dados para 1 ou mais CDs">
<link href="ch-tasks.html#s-tasks-cdwriting-graphicapps" rel="subsection" title="25.1.7 Aplicações gráficas para gravação de CDs">
<link href="ch-tasks.html#s-tasks-cdwriting-cover" rel="subsection" title="25.1.8 Criar a capa de frente e verso do CD/DVD">
<link href="ch-manut.html#s-manut-checagem-ext2" rel="subsection" title="27.1.1 fsck.ext2">
<link href="ch-manut.html#s-manut-cron-formato" rel="subsection" title="27.11.1 O formato de um arquivo crontab">
<link href="ch-inter.html#s-inter-conectando-adsl" rel="subsection" title="29.1.1 Conectando através de ADSL">
<link href="ch-inter.html#s-inter-conectando-ppp" rel="subsection" title="29.1.2 Conectando através de Internet Discada">
<link href="ch-inter.html#s-inter-procmail" rel="subsection" title="29.3.1 Processamento de mensagens através do procmail">
<link href="ch-fw-iptables.html#s-fw-iptables-versao" rel="subsection" title="31.1.1 Versão">
<link href="ch-fw-iptables.html#s-fw-iptables-historia" rel="subsection" title="31.1.2 Um resumo da história do iptables">
<link href="ch-fw-iptables.html#s-fw-iptables-caracteristicas" rel="subsection" title="31.1.3 Características do firewall iptables">
<link href="ch-fw-iptables.html#s-fw-iptables-ficha" rel="subsection" title="31.1.4 Ficha técnica">
<link href="ch-fw-iptables.html#s-fw-iptables-hwreq" rel="subsection" title="31.1.5 Requerimentos">
<link href="ch-fw-iptables.html#s-fw-iptables-logs" rel="subsection" title="31.1.6 Arquivos de logs criados pelo iptables">
<link href="ch-fw-iptables.html#s-fw-iptables-install" rel="subsection" title="31.1.7 Instalação">
<link href="ch-fw-iptables.html#s-fw-iptables-contribuindo" rel="subsection" title="31.1.8 Enviando Correções/Contribuindo com o projeto">
<link href="ch-fw-iptables.html#s-fw-iptables-oldfw" rel="subsection" title="31.1.9 O que aconteceu com o ipchains e ipfwadm?">
<link href="ch-fw-iptables.html#s-fw-iptables-tiposfw" rel="subsection" title="31.1.10 Tipos de firewalls">
<link href="ch-fw-iptables.html#s-fw-iptables-proteger-oque" rel="subsection" title="31.1.11 O que proteger?">
<link href="ch-fw-iptables.html#s-fw-iptables-regras-oque" rel="subsection" title="31.1.12 O que são regras?">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-oque" rel="subsection" title="31.1.13 O que são chains?">
<link href="ch-fw-iptables.html#s-fw-iptables-tabelas" rel="subsection" title="31.1.14 O que são tabelas?">
<link href="ch-fw-iptables.html#s-fw-iptables-supkernel" rel="subsection" title="31.1.15 Habilitando o suporte ao iptables no kernel">
<link href="ch-fw-iptables.html#s-fw-iptables-proxy" rel="subsection" title="31.1.16 Ligando sua rede interna a Internet">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-A" rel="subsection" title="31.2.1 Adicionando regras - A">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-L" rel="subsection" title="31.2.2 Listando regras - L">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-D" rel="subsection" title="31.2.3 Apagando uma regra - D">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-I" rel="subsection" title="31.2.4 Inserindo uma regra - I">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-R" rel="subsection" title="31.2.5 Substituindo uma regra - R">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-N" rel="subsection" title="31.2.6 Criando um novo chain - N">
<link href="ch-fw-iptables.html#s31.2.7" rel="subsection" title="31.2.7 Renomeando um chain criado pelo usuário - E">
<link href="ch-fw-iptables.html#s31.2.8" rel="subsection" title="31.2.8 Listando os nomes de todas as tabelas atuais">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-F" rel="subsection" title="31.2.9 Limpando as regras de um chain - F">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-X" rel="subsection" title="31.2.10 Apagando um chain criado pelo usuário - X">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-Z" rel="subsection" title="31.2.11 Zerando contador de bytes dos chains - Z">
<link href="ch-fw-iptables.html#s-fw-iptables-chains-P" rel="subsection" title="31.2.12 Especificando a política padrão de um chain - P">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-endOD" rel="subsection" title="31.3.1 Especificando um endereço de origem/destino">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-iface" rel="subsection" title="31.3.2 Especificando a interface de origem/destino">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-proto" rel="subsection" title="31.3.3 Especificando um protocolo">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-proto-p" rel="subsection" title="31.3.3.1 Especificando portas de origem/destino">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-proto-micmp" rel="subsection" title="31.3.3.2 Especificando mensagens do protocolo ICMP">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-proto-syn" rel="subsection" title="31.3.3.3 Especificando pacotes syn">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-fragmentos" rel="subsection" title="31.3.4 Especificando fragmentos">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-excessoes" rel="subsection" title="31.3.5 Especificando uma exceção">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-alvo" rel="subsection" title="31.3.6 Especificando um alvo">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-alvo-REJECT" rel="subsection" title="31.3.6.1 Alvo REJECT">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-alvo-LOG" rel="subsection" title="31.3.6.2 Especificando LOG como alvo">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-alvo-RETURN" rel="subsection" title="31.3.6.3 Especificando RETURN como alvo">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-save-restore" rel="subsection" title="31.3.7 Salvando e Restaurando regras">
<link href="ch-fw-iptables.html#s-fw-iptables-nat-N" rel="subsection" title="31.4.1 Criando um novo chain na tabela NAT">
<link href="ch-fw-iptables.html#s-fw-iptables-nat-fastmasquerade" rel="subsection" title="31.4.2 Fazendo IP masquerading (para os apressados)">
<link href="ch-fw-iptables.html#s-fw-iptables-nat-snat" rel="subsection" title="31.4.3 Fazendo SNAT">
<link href="ch-fw-iptables.html#s-fw-iptables-nat-snat-masquerade" rel="subsection" title="31.4.3.1 Fazendo IP Masquerading">
<link href="ch-fw-iptables.html#s-fw-iptables-nat-dnat" rel="subsection" title="31.4.4 Fazendo DNAT">
<link href="ch-fw-iptables.html#s-fw-iptables-nat-dnat-redir" rel="subsection" title="31.4.4.1 Redirecionamento de portas">
<link href="ch-fw-iptables.html#s-fw-iptables-nat-monitorando" rel="subsection" title="31.4.5 Monitorando conexões feitas na tabela nat">
<link href="ch-fw-iptables.html#s-fw-iptables-mangle-TOS" rel="subsection" title="31.5.1 Especificando o tipo de serviço">
<link href="ch-fw-iptables.html#s-fw-iptables-mangle-TOS-out" rel="subsection" title="31.5.1.1 Especificando o TOS para tráfego de saída">
<link href="ch-fw-iptables.html#s-fw-iptables-mangle-TOS-in" rel="subsection" title="31.5.1.2 Especificando o TOS para o tráfego de entrada">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-state" rel="subsection" title="31.6.1 Conferindo de acordo com o estado da conexão">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-limit" rel="subsection" title="31.6.2 Limitando o número de vezes que a regra confere">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-limit-ping" rel="subsection" title="31.6.3 Proteção contra ping da morte">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-limit-synflood" rel="subsection" title="31.6.4 Proteção contra syn flood">
<link href="ch-fw-iptables.html#s-fw-iptables-outras-ipspoof" rel="subsection" title="31.6.5 Proteção contra IP spoofing">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-multiport" rel="subsection" title="31.6.6 Especificando múltiplas portas de origem/destino">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-mac" rel="subsection" title="31.6.7 Especificando o endereço MAC da interface">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-owner" rel="subsection" title="31.6.8 Conferindo com quem criou o pacote">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-string" rel="subsection" title="31.6.9 Conferindo com o conteúdo do pacote">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-ttl" rel="subsection" title="31.6.10 Conferindo com o tempo de vida do pacote">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-rpc" rel="subsection" title="31.6.11 Conferindo com números RPC">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-pkttype" rel="subsection" title="31.6.12 Conferindo com tipo de pacote">
<link href="ch-fw-iptables.html#s-fw-iptables-mod-length" rel="subsection" title="31.6.13 Conferindo com o tamanho do pacote">
<link href="ch-fw-iptables.html#s-fw-iptables-path-PingICMPLocal-Local" rel="subsection" title="31.7.1 Ping de 192.168.1.1 para 192.168.1.1">
<link href="ch-fw-iptables.html#s-fw-iptables-path-FtpTCPLocal-Local" rel="subsection" title="31.7.2 Conexão FTP de 192.168.1.1 para 192.168.1.1">
<link href="ch-fw-iptables.html#s-fw-iptables-path-FtpTCPLocal-LocalNet" rel="subsection" title="31.7.3 Conexão FTP de 192.168.1.1 para 192.168.1.4">
<link href="ch-fw-iptables.html#s-fw-iptables-path-FtpTCPLocal-RemoteNet" rel="subsection" title="31.7.4 Conexão FTP de 200.217.29.67 para a máquina ftp.debian.org.br">
<link href="ch-fw-iptables.html#s-fw-iptables-path-PingICMPLocalNet-Local" rel="subsection" title="31.7.5 Ping de 192.168.1.4 para 192.168.1.1">
<link href="ch-fw-iptables.html#s-fw-iptables-path-FtpTCPLocalNet-Local" rel="subsection" title="31.7.6 Conexão FTP de 192.168.1.4 para 192.168.1.1">
<link href="ch-fw-iptables.html#s-fw-iptables-path-FtpTCPLocalNet-RemoteNet" rel="subsection" title="31.7.7 Conexão FTP de 192.168.1.4 para ftp.debian.org.br">
<link href="ch-fw-iptables.html#s-fw-iptables-path-FtpTCPRemoteNet-Local" rel="subsection" title="31.7.8 Conexão FTP de 200.198.129.162 para 200.217.29.167">
<link href="ch-fw-iptables.html#s-fw-iptables-path-grafico" rel="subsection" title="31.7.9 Gráfico geral da passagem dos pacotes">
<link href="ch-fw-iptables.html#s-fw-iptables-exemplo-bloqueio" rel="subsection" title="31.8.1 Bloqueando conexões de fora para sua máquina">
<link href="ch-fw-iptables.html#s-fw-iptables-exemplo-trojans" rel="subsection" title="31.8.2 Monitorando tentativa de conexão de trojans em sua máquina">
<link href="ch-fw-iptables.html#s-fw-iptables-exemplo-snat" rel="subsection" title="31.8.3 Conectando sua rede interna a Internet">
<link href="ch-fw-iptables.html#s-fw-iptables-exemplo-fw" rel="subsection" title="31.8.4 Um exemplo de firewall simples">
<link href="ch-d-contas.html#s-d-contas-cms-padroes" rel="subsection" title="32.2.1 Definindo valores padrões de restrição">
<link href="ch-d-contas.html#s-d-contas-cms-senhas" rel="subsection" title="32.2.2 Senhas fáceis de adivinhar e escolha de boas senhas">
<link href="ch-d-contas.html#s-d-contas-cms-multipasswd" rel="subsection" title="32.2.3 Atualização de senhas de múltiplas contas">
<link href="ch-d-contas.html#s-d-contas-cms-senharoot" rel="subsection" title="32.2.4 A senha do usuário root">
<link href="ch-d-contas.html#s-d-contas-ataques-deducao" rel="subsection" title="32.3.1 Dedução">
<link href="ch-d-contas.html#s-d-contas-ataques-engsocial" rel="subsection" title="32.3.2 Engenharia Social">
<link href="ch-d-contas.html#s-d-contas-ataques-dicionario" rel="subsection" title="32.3.3 Ataques por dicionário">
<link href="ch-d-contas.html#s-d-contas-ataques-bruteforce" rel="subsection" title="32.3.4 Brute Force">
<link href="ch-d-contas.html#s-d-contas-ataques-monteclad" rel="subsection" title="32.3.5 Monitoramento de toques do teclado">
<link href="ch-d-contas.html#s-d-contas-ataques-loginfalso" rel="subsection" title="32.3.6 Login falso">
<link href="ch-d-contas.html#s-d-contas-segsenhas-shadow" rel="subsection" title="32.4.1 Shadow Passwords">
<link href="ch-d-contas.html#s-d-contas-segsenhas-md5" rel="subsection" title="32.4.2 Senhas MD5">
<link href="ch-s-apache.html#s-s-apache-versao" rel="subsection" title="33.1.1 Versão">
<link href="ch-s-apache.html#s-s-apache-historia" rel="subsection" title="33.1.2 Um resumo da História do Apache">
<link href="ch-s-apache.html#s-s-apache-contribuindo" rel="subsection" title="33.1.3 Enviando Correções/Contribuindo com o projeto">
<link href="ch-s-apache.html#s-s-apache-caracteristicas" rel="subsection" title="33.1.4 Características do Apache">
<link href="ch-s-apache.html#s-s-apache-ficha" rel="subsection" title="33.1.5 Ficha técnica">
<link href="ch-s-apache.html#s-s-apache-hwreq" rel="subsection" title="33.1.6 Requerimentos">
<link href="ch-s-apache.html#s-s-apache-logs" rel="subsection" title="33.1.7 Arquivos de log criados pelo Apache">
<link href="ch-s-apache.html#s-s-apache-install" rel="subsection" title="33.1.8 Instalação">
<link href="ch-s-apache.html#s-s-apache-rodando" rel="subsection" title="33.1.9 Iniciando o servidor/reiniciando/recarregando a configuração">
<link href="ch-s-apache.html#s-s-apache-opcoescmd" rel="subsection" title="33.1.10 Opções de linha de comando">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-autor" rel="subsection" title="33.7.1 Autorização">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-auth" rel="subsection" title="33.7.2 Autenticação">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-auth-arqsenha" rel="subsection" title="33.7.2.1 Criando um arquivo de Senhas">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-auth-arqsenha-htpasswd" rel="subsection" title="33.7.2.1.1 htpasswd">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-auth-arqsenha-htdigest" rel="subsection" title="33.7.2.1.2 htdigest e dbmmanage">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-auth-usuarios" rel="subsection" title="33.7.2.2 Autenticação através de usuários">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-auth-grupos" rel="subsection" title="33.7.2.3 Autenticação usando grupos">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-autor+auth" rel="subsection" title="33.7.3 Usando autorização e autenticação juntos">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-autor+auth-diferenciado" rel="subsection" title="33.7.3.1 Acesso diferenciado em uma mesma diretiva">
<link href="ch-s-apache.html#s-s-apache-acesso-restr-htaccess" rel="subsection" title="33.7.4 O arquivo .htaccess">
<link href="ch-s-apache.html#s-s-apache-acesso-setenvif" rel="subsection" title="33.7.5 Usando a diretiva SetEnvIf com Allow e Deny">
<link href="ch-s-apache.html#s-s-apache-acesso-limit" rel="subsection" title="33.7.6 A diretiva &lt;Limit&gt;">
<link href="ch-s-apache.html#s-s-apache-acesso-limitexcept" rel="subsection" title="33.7.7 Diretiva &lt;LimitExcept&gt;">
<link href="ch-s-apache.html#s-s-apache-log-agentlog" rel="subsection" title="33.10.1 AgentLog">
<link href="ch-s-apache.html#s-s-apache-log-errorlog" rel="subsection" title="33.10.2 ErrorLog">
<link href="ch-s-apache.html#s-s-apache-log-customlog" rel="subsection" title="33.10.3 CustomLog">
<link href="ch-s-apache.html#s-s-apache-log-refererlog" rel="subsection" title="33.10.4 RefererLog">
<link href="ch-s-apache.html#s-s-apache-log-rewritelog" rel="subsection" title="33.10.5 RewriteLog">
<link href="ch-s-apache.html#s-s-apache-log-rewriteloglevel" rel="subsection" title="33.10.6 RewriteLogLevel">
<link href="ch-s-apache.html#s-s-apache-log-scriptlog" rel="subsection" title="33.10.7 ScriptLog">
<link href="ch-s-apache.html#s-s-apache-log-scriptlogbuffer" rel="subsection" title="33.10.8 ScriptLogBuffer">
<link href="ch-s-apache.html#s-s-apache-log-scriptloglength" rel="subsection" title="33.10.9 ScriptLogLength">
<link href="ch-s-apache.html#s-s-apache-log-logformat" rel="subsection" title="33.10.10 LogFormat">
<link href="ch-s-apache.html#s-s-apache-log-transferlog" rel="subsection" title="33.10.11 TransferLog">
<link href="ch-s-apache.html#s-s-apache-log-loglevel" rel="subsection" title="33.10.12 LogLevel">
<link href="ch-s-apache.html#s-s-apache-log-anonylogmail" rel="subsection" title="33.10.13 Anonymous_LogEmail">
<link href="ch-s-apache.html#s-s-apache-log-cookielog" rel="subsection" title="33.10.14 CookieLog">
<link href="ch-s-apache.html#s-s-apache-log-webalizer" rel="subsection" title="33.10.15 Relatório gráfico de acesso ao sistema">
<link href="ch-s-apache.html#s-s-apache-proxy-access" rel="subsection" title="33.11.1 Controlando o acesso ao servidor proxy">
<link href="ch-s-apache.html#s-s-apache-proxy-redir" rel="subsection" title="33.11.2 Redirecionamento de conexões no Apache">
<link href="ch-s-apache.html#s-s-apache-vhosts-ip" rel="subsection" title="33.12.1 Virtual hosts baseados em IP">
<link href="ch-s-apache.html#s-s-apache-vhosts-nome" rel="subsection" title="33.12.2 Virtual hosts baseados em nome">
<link href="ch-s-apache.html#s-s-apache-vhosts-dnssec" rel="subsection" title="33.12.3 Segurança no uso de IP's em Virtual Hosts">
<link href="ch-s-apache.html#s-s-apache-ssl-s" rel="subsection" title="33.13.1 Servidor apache com suporte a ssl">
<link href="ch-s-apache.html#s-s-apache-ssl-instal" rel="subsection" title="33.13.2 Instalando o suporte a módulo SSL no Apache">
<link href="ch-s-apache.html#s-s-apache-ssl-mkcert" rel="subsection" title="33.13.3 Gerando um certificado digital">
<link href="ch-s-apache.html#s-s-apache-ssl-exemplo" rel="subsection" title="33.13.4 Exemplo de configuração do módulo mod-ssl">
<link href="ch-s-apache.html#s-s-apache-ssl-sslreq" rel="subsection" title="33.13.5 Autorizando acesso somente a conexões SSL">
<link href="ch-s-apache.html#s-s-apache-ssl-inic" rel="subsection" title="33.13.6 Iniciando o servidor Web com suporte a SSL">
<link href="ch-s-apache.html#s-s-apache-exemplo-httpd" rel="subsection" title="33.14.1 httpd.conf">
<link href="ch-s-apache.html#s-s-apache-exemplo-srm" rel="subsection" title="33.14.2 srm.conf">
<link href="ch-s-apache.html#s-s-apache-exemplo-access" rel="subsection" title="33.14.3 access.conf">
<link href="ch-s-ident.html#s-s-ident-versao" rel="subsection" title="34.1.1 Versão">
<link href="ch-s-ident.html#s-s-ident-contribuindo" rel="subsection" title="34.1.2 Contribuindo">
<link href="ch-s-ident.html#s-s-ident-caracteristicas" rel="subsection" title="34.1.3 Características">
<link href="ch-s-ident.html#s-s-ident-ficha" rel="subsection" title="34.1.4 Ficha técnica">
<link href="ch-s-ident.html#s-s-ident-hwreq" rel="subsection" title="34.1.5 Requerimentos de Hardware">
<link href="ch-s-ident.html#s-s-ident-logs" rel="subsection" title="34.1.6 Arquivos de log criados pelo Ident">
<link href="ch-s-ident.html#s-s-ident-install" rel="subsection" title="34.1.7 Instalação">
<link href="ch-s-ident.html#s-s-ident-install-inetd" rel="subsection" title="34.1.8 Instalação via Inetd">
<link href="ch-s-ident.html#s-s-ident-tcpwrappers" rel="subsection" title="34.1.9 Usando tcpwrappers com oidentd">
<link href="ch-s-ident.html#s-s-ident-rodando" rel="subsection" title="34.1.10 Iniciando o servidor/reiniciando/recarregando a configuração">
<link href="ch-s-ident.html#s-s-ident-opcoescmd" rel="subsection" title="34.1.11 Opções de linha de comando">
<link href="ch-s-ident.html#s-s-ident-exemplo" rel="subsection" title="34.1.12 Exemplos">
<link href="ch-s-telnet.html#s-s-telnet-versao" rel="subsection" title="35.1.1 Versão">
<link href="ch-s-telnet.html#s-s-telnet-caracteristicas" rel="subsection" title="35.1.2 Características">
<link href="ch-s-telnet.html#s-s-telnet-ficha" rel="subsection" title="35.1.3 Ficha técnica">
<link href="ch-s-telnet.html#s-s-telnet-hwreq" rel="subsection" title="35.1.4 Requerimentos de Hardware">
<link href="ch-s-telnet.html#s-s-telnet-logs" rel="subsection" title="35.1.5 Arquivos de log criados pelo servidor telnet">
<link href="ch-s-telnet.html#s-s-telnet-install" rel="subsection" title="35.1.6 Instalação">
<link href="ch-s-telnet.html#s-s-telnet-rodando" rel="subsection" title="35.1.7 Iniciando o servidor/reiniciando/recarregando a configuração">
<link href="ch-s-telnet.html#s-s-telnet-opcoescmd" rel="subsection" title="35.1.8 Opções de linha de comando">
<link href="ch-s-ssh.html#s-s-ssh-versao" rel="subsection" title="36.1.1 Versão">
<link href="ch-s-ssh.html#s-s-ssh-historia" rel="subsection" title="36.1.2 História">
<link href="ch-s-ssh.html#s-s-ssh-contribuindo" rel="subsection" title="36.1.3 Contribuindo">
<link href="ch-s-ssh.html#s-s-ssh-caracteristicas" rel="subsection" title="36.1.4 Características">
<link href="ch-s-ssh.html#s-s-ssh-ficha" rel="subsection" title="36.1.5 Ficha técnica">
<link href="ch-s-ssh.html#s-s-ssh-hwreq" rel="subsection" title="36.1.6 Requerimentos de Hardware">
<link href="ch-s-ssh.html#s-s-ssh-logs" rel="subsection" title="36.1.7 Arquivos de log criados pelo servidor ssh">
<link href="ch-s-ssh.html#s-s-ssh-install" rel="subsection" title="36.1.8 Instalação do servidor openSSH">
<link href="ch-s-ssh.html#s-s-ssh-rodando" rel="subsection" title="36.1.9 Iniciando o servidor/reiniciando/recarregando a configuração">
<link href="ch-s-ssh.html#s-s-ssh-opcoescmd" rel="subsection" title="36.1.10 Opções de linha de comando">
<link href="ch-s-ssh.html#s-s-ssh-cliente-ssh" rel="subsection" title="36.2.1 ssh">
<link href="ch-s-ssh.html#s-s-ssh-cliente-ssh-Xforward" rel="subsection" title="36.2.1.1 Redirecionamento de conexões do X">
<link href="ch-s-ssh.html#s-s-ssh-cliente-ssh-win" rel="subsection" title="36.2.1.2 Cliente ssh para Windows">
<link href="ch-s-ssh.html#s-s-ssh-cliente-scp" rel="subsection" title="36.2.2 scp">
<link href="ch-s-ssh.html#s-s-ssh-cliente-scp-win" rel="subsection" title="36.2.2.1 Cliente scp para Windows">
<link href="ch-s-ssh.html#s-s-ssh-cliente-sftp" rel="subsection" title="36.2.3 sftp">
<link href="ch-s-ssh.html#s-s-ssh-server-sshd" rel="subsection" title="36.3.1 sshd">
<link href="ch-s-ssh.html#s-s-ssh-acesso" rel="subsection" title="36.3.2 Controle de acesso">
<link href="ch-s-ssh.html#s-s-ssh-server-rsaauth" rel="subsection" title="36.3.3 Usando autenticação RSA/DSA - chave pública/privada">
<link href="ch-s-ssh.html#s-s-ssh-server-cmdkey" rel="subsection" title="36.3.4 Execução de comandos específicos usando chaves">
<link href="ch-s-ssh.html#s-s-ssh-server-gatewayssh" rel="subsection" title="36.3.5 Criando um gateway ssh">
<link href="ch-s-ssh.html#s-s-ssh-server-proxy" rel="subsection" title="36.3.6 Criando um tunel proxy">
<link href="ch-s-ssh.html#s-s-ssh-server-protodiff" rel="subsection" title="36.3.7 Diferenças nas versões do protocolo">
<link href="ch-s-ssh.html#s-s-ssh-server-sshd_config" rel="subsection" title="36.3.8 Exemplo de sshd_config com explicações das diretivas">
<link href="ch-s-pop3.html#s-s-pop3-versao" rel="subsection" title="37.1.1 Versão">
<link href="ch-s-pop3.html#s-s-pop3-contribuindo" rel="subsection" title="37.1.2 Contribuindo">
<link href="ch-s-pop3.html#s-s-pop3-caracteristicas" rel="subsection" title="37.1.3 Características">
<link href="ch-s-pop3.html#s-s-pop3-ficha" rel="subsection" title="37.1.4 Ficha técnica">
<link href="ch-s-pop3.html#s-s-pop3-hwreq" rel="subsection" title="37.1.5 Requerimentos de Hardware">
<link href="ch-s-pop3.html#s-s-pop3-logs" rel="subsection" title="37.1.6 Arquivos de log criados pelo qpopper">
<link href="ch-s-pop3.html#s-s-pop3-install" rel="subsection" title="37.1.7 Instalação">
<link href="ch-s-pop3.html#s-s-pop3-rodando" rel="subsection" title="37.1.8 Iniciando o servidor/reiniciando/recarregando a configuração">
<link href="ch-s-pop3.html#s-s-pop3-testando" rel="subsection" title="37.1.9 Teste de acesso no pop3">
<link href="ch-s-pop3.html#s-s-pop3-opcoescmd" rel="subsection" title="37.1.10 Opções de linha de comando">
<link href="ch-s-pop3.html#s-s-pop3-boletins" rel="subsection" title="37.1.11 Enviando boletins de mensagens">
<link href="ch-s-pop3.html#s-s-pop3-quotas" rel="subsection" title="37.1.12 Especificando quotas para as caixas de correio">
<link href="ch-s-pop3.html#s-s-pop3-restricao" rel="subsection" title="37.1.13 Restringindo acesso ao servidor pop3">
<link href="ch-s-cvs.html#s-s-cvs-versao" rel="subsection" title="38.1.1 Versão">
<link href="ch-s-cvs.html#s-s-cvs-historia" rel="subsection" title="38.1.2 História">
<link href="ch-s-cvs.html#s-s-cvs-contribuindo" rel="subsection" title="38.1.3 Contribuindo com o CVS">
<link href="ch-s-cvs.html#s-s-cvs-caracteristicas" rel="subsection" title="38.1.4 Características">
<link href="ch-s-cvs.html#s-s-cvs-ficha" rel="subsection" title="38.1.5 Ficha técnica">
<link href="ch-s-cvs.html#s-s-cvs-hwreq" rel="subsection" title="38.1.6 Requerimentos de Hardware">
<link href="ch-s-cvs.html#s-s-cvs-logs" rel="subsection" title="38.1.7 Arquivos de log criados pelo CVS">
<link href="ch-s-cvs.html#s-s-cvs-install" rel="subsection" title="38.1.8 Instalação">
<link href="ch-s-cvs.html#s-s-cvs-rodando" rel="subsection" title="38.1.9 Iniciando o servidor/reiniciando/recarregando a configuração">
<link href="ch-s-cvs.html#s-s-cvs-opcoescmd" rel="subsection" title="38.1.10 Opções de linha de comando">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-local" rel="subsection" title="38.2.1 local">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-local-c" rel="subsection" title="38.2.1.1 Configurando o método local">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-fork" rel="subsection" title="38.2.2 fork">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-fork-c" rel="subsection" title="38.2.2.1 Configurando o método fork">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-ext" rel="subsection" title="38.2.3 ext">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-ext-c" rel="subsection" title="38.2.3.1 Configurando o método ext">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-pserver" rel="subsection" title="38.2.4 pserver (password server)">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-pserver-c" rel="subsection" title="38.2.5 Configurando um servidor pserver">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-pserver-c-pserver" rel="subsection" title="38.2.5.1 Ativando o servidor pserver">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-pserver-c-system" rel="subsection" title="38.2.5.2 Servidor pserver usando autenticação do sistema">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-pserver-c-pwrepos" rel="subsection" title="38.2.5.3 Servidor pserver com autenticação própria">
<link href="ch-s-cvs.html#s-s-cvs-d-metodos-gssapi" rel="subsection" title="38.2.6 gssapi">
<link href="ch-s-cvs.html#s-s-cvs-p-repos" rel="subsection" title="38.3.1 Repositório">
<link href="ch-s-cvs.html#s-s-cvs-p-mkrepos" rel="subsection" title="38.3.2 Criando um repositório">
<link href="ch-s-cvs.html#s-s-cvs-p-login" rel="subsection" title="38.3.3 Logando no servidor de CVS via pserver">
<link href="ch-s-cvs.html#s-s-cvs-p-logout" rel="subsection" title="38.3.4 Encerrando uma seção de CVS">
<link href="ch-s-cvs.html#s-s-cvs-p-checkout" rel="subsection" title="38.3.5 Baixando arquivos">
<link href="ch-s-cvs.html#s-s-cvs-p-import" rel="subsection" title="38.3.6 Adicionando um novo projeto">
<link href="ch-s-cvs.html#s-s-cvs-p-update" rel="subsection" title="38.3.7 Sincronizando a cópia remota com a cópia local">
<link href="ch-s-cvs.html#s-s-cvs-p-commit" rel="subsection" title="38.3.8 Enviando as mudanças para o servidor remoto">
<link href="ch-s-cvs.html#s-s-cvs-p-add" rel="subsection" title="38.3.9 Adicionando um arquivo ao módulo CVS do servidor">
<link href="ch-s-cvs.html#s-s-cvs-p-add-dir" rel="subsection" title="38.3.10 Adicionando um diretório ao módulo CVS do servidor">
<link href="ch-s-cvs.html#s-s-cvs-p-remove" rel="subsection" title="38.3.11 Removendo um arquivo do módulo CVS remoto">
<link href="ch-s-cvs.html#s-s-cvs-p-removed" rel="subsection" title="38.3.12 Removendo um diretório do módulo CVS remoto">
<link href="ch-s-cvs.html#s-s-cvs-p-release" rel="subsection" title="38.3.13 Dizendo que o módulo atual não está mais em uso">
<link href="ch-s-cvs.html#s-s-cvs-p-diff" rel="subsection" title="38.3.14 Visualizando diferenças entre versões de um arquivo">
<link href="ch-s-cvs.html#s-s-cvs-p-status" rel="subsection" title="38.3.15 Visualizando o status de versão de arquivos">
<link href="ch-s-cvs.html#s-s-cvs-p-utils" rel="subsection" title="38.3.16 Outros utilitários para trabalho no repositório">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-config" rel="subsection" title="38.4.1 config">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-modules" rel="subsection" title="38.4.2 modules">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-cvswrappers" rel="subsection" title="38.4.3 cvswrappers">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-commitinfo" rel="subsection" title="38.4.4 commitinfo">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-verifymsg" rel="subsection" title="38.4.5 verifymsg">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-loginfo" rel="subsection" title="38.4.6 loginfo">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-cvsignore" rel="subsection" title="38.4.7 cvsignore">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-checkoutlist" rel="subsection" title="38.4.8 checkoutlist">
<link href="ch-s-cvs.html#s-s-cvs-cvsroot-history" rel="subsection" title="38.4.9 history">
<link href="ch-s-cvs.html#s-s-cvs-c-cvs" rel="subsection" title="38.5.1 cvs">
<link href="ch-s-cvs.html#s-s-cvs-c-gcvs" rel="subsection" title="38.5.2 gcvs - Linux">
<link href="ch-s-cvs.html#s-s-cvs-c-wincvs" rel="subsection" title="38.5.3 WinCVS - Windows">
<link href="ch-s-cvs.html#s-s-cvs-c-maccvs" rel="subsection" title="38.5.4 MacCVS - Macintosh (PPC)">
<link href="ch-s-cvs.html#s-s-cvs-c-viewcvs" rel="subsection" title="38.5.5 viewcvs">
<link href="ch-s-samba.html#s-s-samba-versao" rel="subsection" title="39.1.1 Versão documentada">
<link href="ch-s-samba.html#s-s-samba-historia" rel="subsection" title="39.1.2 História">
<link href="ch-s-samba.html#s-s-samba-contribuindo" rel="subsection" title="39.1.3 Contribuindo">
<link href="ch-s-samba.html#s-s-samba-caracteristicas" rel="subsection" title="39.1.4 Características">
<link href="ch-s-samba.html#s-s-samba-ficha" rel="subsection" title="39.1.5 Ficha técnica">
<link href="ch-s-samba.html#s-s-samba-hwreq" rel="subsection" title="39.1.6 Requerimentos de Hardware">
<link href="ch-s-samba.html#s-s-samba-logs" rel="subsection" title="39.1.7 Arquivos de log criados">
<link href="ch-s-samba.html#s-s-samba-install" rel="subsection" title="39.1.8 Instalação">
<link href="ch-s-samba.html#s-s-samba-rodando" rel="subsection" title="39.1.9 Iniciando o servidor/reiniciando/recarregando a configuração">
<link href="ch-s-samba.html#s-s-samba-opcoescmd" rel="subsection" title="39.1.10 Opções de linha de comando">
<link href="ch-s-samba.html#s-s-samba-nome" rel="subsection" title="39.2.1 Nome de máquina (nome NetBios)">
<link href="ch-s-samba.html#s-s-samba-workgroup" rel="subsection" title="39.2.2 Grupo de trabalho">
<link href="ch-s-samba.html#s-s-samba-dominio" rel="subsection" title="39.2.3 Domínio">
<link href="ch-s-samba.html#s-s-samba-compart" rel="subsection" title="39.2.4 Compartilhamento">
<link href="ch-s-samba.html#s-s-samba-mapeamento" rel="subsection" title="39.2.5 Mapeamento">
<link href="ch-s-samba.html#s-s-samba-nmbd" rel="subsection" title="39.2.6 Navegação na Rede e controle de domínio">
<link href="ch-s-samba.html#s-s-samba-arquivocfg" rel="subsection" title="39.2.7 Arquivo de configuração do samba">
<link href="ch-s-samba.html#s-s-samba-s-global" rel="subsection" title="39.2.8 Seção [global]">
<link href="ch-s-samba.html#s-s-samba-s-global-nome" rel="subsection" title="39.2.8.1 Nomes e grupos de trabalho">
<link href="ch-s-samba.html#s-s-samba-s-global-carac" rel="subsection" title="39.2.8.2 Caracteres e página de código">
<link href="ch-s-samba.html#s-s-samba-s-global-restrusu" rel="subsection" title="39.2.8.3 Restrições de acesso/mapeamento de usuários">
<link href="ch-s-samba.html#s-s-samba-s-global-nivelauth" rel="subsection" title="39.2.8.4 Níveis de autenticação">
<link href="ch-s-samba.html#s-s-samba-s-global-log" rel="subsection" title="39.2.8.5 Log de acessos/serviços">
<link href="ch-s-samba.html#s-s-samba-s-global-browsing" rel="subsection" title="39.2.8.6 Navegação no servidor/tipo de servidor">
<link href="ch-s-samba.html#s-s-samba-s-global-outras" rel="subsection" title="39.2.8.7 Outros parâmetros de configuração">
<link href="ch-s-samba.html#s-s-samba-s-homes" rel="subsection" title="39.2.9 Seção [homes]">
<link href="ch-s-samba.html#s-s-samba-s-printers" rel="subsection" title="39.2.10 Seção [printers]">
<link href="ch-s-samba.html#s-s-samba-s-testparm" rel="subsection" title="39.2.11 Buscando problemas na configuração">
<link href="ch-s-samba.html#s-s-samba-s-oslevel" rel="subsection" title="39.2.12 Níveis de sistema para eleição de rede">
<link href="ch-s-samba.html#s-s-samba-s-varsubst" rel="subsection" title="39.2.13 Variáveis de substituição">
<link href="ch-s-samba.html#s-s-samba-s-a-param" rel="subsection" title="39.3.1 Descrição de parâmetros usados em compartilhamento">
<link href="ch-s-samba.html#s-s-samba-s-nameresolv-lmhosts" rel="subsection" title="39.5.1 Arquivo /etc/samba/lmhosts">
<link href="ch-s-samba.html#s-s-samba-s-nameresolv-lmhosts-unix-ex" rel="subsection" title="39.5.1.1 Exemplo de lmhosts do UNIX">
<link href="ch-s-samba.html#s-s-samba-s-nameresolve-lmhosts-windows-ex" rel="subsection" title="39.5.1.2 Exemplo de lmhosts do Windows">
<link href="ch-s-samba.html#s-s-samba-s-nameresolv-wins" rel="subsection" title="39.5.2 WINS">
<link href="ch-s-samba.html#s-s-samba-s-nameresolv-wins-s" rel="subsection" title="39.5.2.1 Configurando o servidor WINS">
<link href="ch-s-samba.html#s-s-samba-s-nameresolv-wins-c" rel="subsection" title="39.5.2.2 Configurando o Cliente WINS">
<link href="ch-s-samba.html#s-s-samba-s-timeserver-s" rel="subsection" title="39.6.1 Configuração do serviço de data/hora no SAMBA">
<link href="ch-s-samba.html#s-s-samba-s-timeserver-c" rel="subsection" title="39.6.2 Sincronizando a data/hora no Cliente">
<link href="ch-s-samba.html#s-s-samba-dom-intro" rel="subsection" title="39.7.1 Uma breve introdução a um Domínio de rede">
<link href="ch-s-samba.html#s-s-samba-dom-lmbrowser" rel="subsection" title="39.7.2 Local Master Browser">
<link href="ch-s-samba.html#s-s-samba-dom-dmbrowser" rel="subsection" title="39.7.3 Domain Master Browser">
<link href="ch-s-samba.html#s-s-samba-dom-config" rel="subsection" title="39.7.4 Configurando um servidor PDC no SAMBA">
<link href="ch-s-samba.html#s-s-samba-dom-contasmac" rel="subsection" title="39.7.5 Contas de máquinas de domínio">
<link href="ch-s-samba.html#s-s-samba-dom-contasmac-dom-m" rel="subsection" title="39.7.5.1 Criando contas de máquinas manualmente">
<link href="ch-s-samba.html#s-s-samba-dom-contasmac-dom-a" rel="subsection" title="39.7.5.2 Criando contas de máquinas automaticamente">
<link href="ch-s-samba.html#s-s-samba-dom-admin" rel="subsection" title="39.7.6 Criando uma conta de administrador de domínio">
<link href="ch-s-samba.html#s-s-samba-dom-logonscripts" rel="subsection" title="39.7.7 Criando Scripts de logon">
<link href="ch-s-samba.html#s-s-samba-dom-profiles" rel="subsection" title="39.7.8 Configurando perfis de usuários">
<link href="ch-s-samba.html#s-s-samba-dom-perm-clientes" rel="subsection" title="39.7.9 Modificações de permissões de acesso pelos clientes do domínio">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto-migrando" rel="subsection" title="39.8.1 Migrando de senhas texto plano para criptografadas">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto-criando" rel="subsection" title="39.8.2 Adicionando usuários no smbpasswd">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto-removendo" rel="subsection" title="39.8.3 Removendo usuários do smbpasswd">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto-desabilitando" rel="subsection" title="39.8.4 Desabilitando uma conta no smbpasswd">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto-habilitando" rel="subsection" title="39.8.5 Habilitando uma conta no smbpasswd">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto-chpasswd" rel="subsection" title="39.8.6 Alterando a senha de um usuário">
<link href="ch-s-samba.html#s-s-samba-senhas-crypto-nopasswd" rel="subsection" title="39.8.7 Definindo acesso sem senha para o usuário">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c" rel="subsection" title="39.9.1 Configurando o acesso de clientes para uso de senhas em texto plano">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-lanmanager" rel="subsection" title="39.9.1.1 Lan Manager">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-wfw" rel="subsection" title="39.9.1.2 Windows for Workgroups">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-win95a" rel="subsection" title="39.9.1.3 Windows 95 / Windows 95A">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-win95b" rel="subsection" title="39.9.1.4 Windows 95B">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-win98" rel="subsection" title="39.9.1.5 Windows 98/98SE">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-winME" rel="subsection" title="39.9.1.6 Windows ME">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-winNT" rel="subsection" title="39.9.1.7 Windows NT Server/WorkStation">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-win2000" rel="subsection" title="39.9.1.8 Windows 2000">
<link href="ch-s-samba.html#s-s-samba-senhas-plano-c-linux" rel="subsection" title="39.9.1.9 Linux">
<link href="ch-s-samba.html#s-s-samba-usermap-w" rel="subsection" title="39.10.1 Mapeamento de usuários/grupos domínio em Windows">
<link href="ch-s-samba.html#s-s-samba-usermap-l" rel="subsection" title="39.10.2 Mapeamento de usuários/grupos domínio em Linux">
<link href="ch-s-samba.html#s-s-samba-i-win-linux" rel="subsection" title="39.11.1 Configurando o Linux como um servidor de impressão Windows">
<link href="ch-s-samba.html#s-s-samba-a-compart" rel="subsection" title="39.12.1 Nível de acesso de usuários conectados ao SAMBA">
<link href="ch-s-samba.html#s-s-samba-a-restrip" rel="subsection" title="39.12.2 Restringindo o acesso por IP/rede">
<link href="ch-s-samba.html#s-s-samba-a-restrip-test" rel="subsection" title="39.12.2.1 Testando a restrição de Acesso por IP/Redes">
<link href="ch-s-samba.html#s-s-samba-a-restrif" rel="subsection" title="39.12.3 Restringindo o acesso por interface de rede">
<link href="ch-s-samba.html#s-s-samba-a-restrusu" rel="subsection" title="39.12.4 Restringindo o acesso por usuários">
<link href="ch-s-samba.html#s-s-samba-a-hostsequiv" rel="subsection" title="39.12.5 Evite o uso do parâmetro hosts equiv!">
<link href="ch-s-samba.html#s-s-asmba-a-nullpasswd" rel="subsection" title="39.12.6 Evite o uso de senhas em branco!">
<link href="ch-s-samba.html#s-s-samba-a-publico" rel="subsection" title="39.12.7 Criando um compartilhamento para acesso sem senha">
<link href="ch-s-samba.html#s-s-samba-a-ro" rel="subsection" title="39.12.8 Criando um compartilhamento com acesso somente leitura">
<link href="ch-s-samba.html#s-s-samba-a-rw" rel="subsection" title="39.12.9 Criando um compartilhamento com acesso leitura/gravação">
<link href="ch-s-samba.html#s-s-samba-a-restr" rel="subsection" title="39.12.10 Excessão de acesso na permissão padrão de compartilhamento">
<link href="ch-s-samba.html#s-s-samba-a-ipc-admin" rel="subsection" title="39.12.11 Restringindo o IPC$ e ADMIN$">
<link href="ch-s-samba.html#s-s-samba-a-invisivel" rel="subsection" title="39.12.12 Criando um compartilhamento invisível">
<link href="ch-s-samba.html#s-s-samba-a-comandos" rel="subsection" title="39.12.13 Executando comandos antes e após o acesso ao compartilhamento">
<link href="ch-s-samba.html#s-s-samba-a-public-access" rel="subsection" title="39.12.14 Considerações de segurança com o uso do parâmetro &quot;public = yes&quot;">
<link href="ch-s-samba.html#s-s-samba-a-passwords" rel="subsection" title="39.12.15 Senhas criptografadas ou em texto puro?">
<link href="ch-s-samba.html#s-s-samba-a-usernamemap" rel="subsection" title="39.12.16 Mapeamento de nomes de usuários">
<link href="ch-s-samba.html#s-s-samba-c-wfw-lman" rel="subsection" title="39.14.1 Considerações sobre o Windows for Workgroups e LanManager">
<link href="ch-s-samba.html#s-s-samba-c-workgroup" rel="subsection" title="39.14.2 Configurando clientes em Grupo de Trabalho">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-w9x" rel="subsection" title="39.14.2.1 Windows 9X">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-wXPHome" rel="subsection" title="39.14.2.2 Windows XP Home Edition">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-wXPprofessional" rel="subsection" title="39.14.2.3 Windows XP Professional Edition">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-wXPServer" rel="subsection" title="39.14.2.4 Windows XP Server Edition">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-NTWorkstation" rel="subsection" title="39.14.2.5 Windows NT WorkStation">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-NTServer" rel="subsection" title="39.14.2.6 Windows NT Server">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-w2kProfessional" rel="subsection" title="39.14.2.7 Windows 2000 Professional">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-w2kServer" rel="subsection" title="39.14.2.8 Windows 2000 Server">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-linux" rel="subsection" title="39.14.2.9 Linux">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-linux-smbmount" rel="subsection" title="39.14.2.9.1 smbmount">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-linux-smbclient" rel="subsection" title="39.14.2.9.2 smbclient">
<link href="ch-s-samba.html#s-s-samba-c-workgroup-linux-nmblookup" rel="subsection" title="39.14.2.9.3 nmblookup">
<link href="ch-s-samba.html#s-s-samba-c-dominio" rel="subsection" title="39.14.3 Configurando clientes em Domínio">
<link href="ch-s-samba.html#s-s-samba-c-dominio-w9x" rel="subsection" title="39.14.3.1 Windows 9X">
<link href="ch-s-samba.html#s-s-samba-c-dominio-wXPHome" rel="subsection" title="39.14.3.2 Windows XP Home Edition">
<link href="ch-s-samba.html#s-s-samba-c-dominio-wXPprofessional" rel="subsection" title="39.14.3.3 Windows XP Professional Edition">
<link href="ch-s-samba.html#s-s-samba-c-dominio-wXPServer" rel="subsection" title="39.14.3.4 Windows XP Server Edition">
<link href="ch-s-samba.html#s-s-samba-c-dominio-NTWorkstation" rel="subsection" title="39.14.3.5 Windows NT WorkStation">
<link href="ch-s-samba.html#s-s-samba-c-dominio-NTServer" rel="subsection" title="39.14.3.6 Windows NT Server">
<link href="ch-s-samba.html#s-s-samba-c-dominio-w2kProfessional" rel="subsection" title="39.14.3.7 Windows 2000 Professional">
<link href="ch-s-samba.html#s-s-samba-c-dominio-w2kServer" rel="subsection" title="39.14.3.8 Windows 2000 Server">
<link href="ch-s-samba.html#s-s-samba-c-dominio-linux" rel="subsection" title="39.14.3.9 Linux">
<link href="ch-s-samba.html#s-s-samba-c-dominio-erros" rel="subsection" title="39.14.4 Erros conhecidos durante o logon do cliente">
<link href="ch-s-samba.html#s-s-samba-c-graficos" rel="subsection" title="39.14.5 Programas de navegação gráficos">
<link href="ch-s-samba.html#s-s-samba-c-graficos-linneighborhood" rel="subsection" title="39.14.5.1 linneighborhood">
<link href="ch-s-samba.html#s-s-samba-c-graficos-tksmb" rel="subsection" title="39.14.5.2 TkSmb">
<link href="ch-s-samba.html#s-s-samba-c-conf" rel="subsection" title="39.14.6 Cliente de configuração gráficos">
<link href="ch-s-samba.html#s-s-samba-c-conf-gnosamba" rel="subsection" title="39.14.6.1 gnosamba">
<link href="ch-s-samba.html#s-s-samba-c-conf-swat" rel="subsection" title="39.14.6.2 swat">
<link href="ch-s-samba.html#s-s-samba-exemplos-workgroup-p" rel="subsection" title="39.15.1 Grupo de Trabalho com acesso público">
<link href="ch-s-samba.html#s-s-samba-exemplos-workgroup-u" rel="subsection" title="39.15.2 Grupo de Trabalho com acesso por usuário">
<link href="ch-s-samba.html#s-s-samba-exemplos-dominio" rel="subsection" title="39.15.3 Domínio">
<link href="ch-d-restr.html#s-d-restr-bash-readonly" rel="subsection" title="40.1.1 Uso do comando readonly para exportar variáveis">
<link href="ch-d-restr.html#s-d-restr-homedir" rel="subsection" title="40.1.2 Restrições nos diretórios de usuários e root">
<link href="ch-d-restr.html#s-d-restr-bash-restricted" rel="subsection" title="40.1.3 Restrições básicas do shell bash com bash -r/--restricted, rbash">
<link href="ch-d-restr.html#s-d-restr-bash-logoutocioso" rel="subsection" title="40.1.4 Finalizando consoles inativos">
<link href="ch-d-restr.html#s-d-restr-bash-logging" rel="subsection" title="40.1.5 Desabilitando o registro de comandos digitados">
<link href="ch-d-restr.html#s-d-restr-bash-desshell" rel="subsection" title="40.1.6 Desabilitando serviços de shell para usuários">
<link href="ch-d-restr.html#s-d-restr-pam-suporte" rel="subsection" title="40.2.1 Descobrindo se um determinado programa tem suporte a PAM">
<link href="ch-d-restr.html#s-d-restr-pam-policy" rel="subsection" title="40.2.2 Definindo uma política padrão restritiva">
<link href="ch-d-restr.html#s-d-restr-pam-login" rel="subsection" title="40.2.3 Restringindo/Bloqueando o login">
<link href="ch-d-restr.html#s-d-restr-pam-root" rel="subsection" title="40.2.4 Restringindo o acesso a root no su">
<link href="ch-d-restr.html#s-d-restr-pam-time" rel="subsection" title="40.2.5 Restrições de serviços PAM baseados em dia/hora">
<link href="ch-d-restr.html#s-d-restr-pam-group" rel="subsection" title="40.2.6 Permitindo acesso a grupos extras">
<link href="ch-d-restr.html#s-d-restr-pam-limits" rel="subsection" title="40.2.7 Limitação de recursos do shell">
<link href="ch-d-restr.html#s-d-restr-quotas-install" rel="subsection" title="40.12.1 Instalando o sistema de quotas">
<link href="ch-d-restr.html#s-d-restr-quotas-editando" rel="subsection" title="40.12.2 Editando quotas de usuários/grupos">
<link href="ch-d-restr.html#s-d-restr-quotas-mudtodos" rel="subsection" title="40.12.3 Modificando a quota de todos os usuários de uma vez">
<link href="ch-d-restr.html#s-d-restr-quotas-checando" rel="subsection" title="40.12.4 Verificando a quota disponível ao usuário">
<link href="ch-d-restr.html#s-d-restr-quotas-todas" rel="subsection" title="40.12.5 Verificando a quota de todos os usuários/grupos do sistema">
<link href="ch-d-restr.html#s-d-restr-quotas-warn" rel="subsection" title="40.12.6 Avisando usuários sobre o estouro de quota">
<link href="ch-d-restr.html#s-d-restr-hardware-bios" rel="subsection" title="40.15.1 BIOS do sistema">
<link href="ch-d-restr.html#s-d-restr-hardware-floppy" rel="subsection" title="40.15.2 Retirada da unidade de disquetes">
<link href="ch-d-restr.html#s-d-restr-hardware-netboot" rel="subsection" title="40.15.3 Placas de rede com eprom de boot">
<link href="ch-d-restr.html#s-d-restr-hardware-lilo" rel="subsection" title="40.15.4 Protegendo o LILO">
<link href="ch-d-restr.html#s-d-restr-hardware-harddisk" rel="subsection" title="40.15.5 Disco rígido">
<link href="ch-d-cripto.html#s-d-cripto-sniffer-detect" rel="subsection" title="41.2.1 Detectando a presença de sniffers">
<link href="ch-d-cripto.html#s-d-cripto-http" rel="subsection" title="41.3.1 http">
<link href="ch-d-cripto.html#s-d-cripto-emails" rel="subsection" title="41.3.2 Transmissão segura de e-mails">
<link href="ch-d-cripto.html#s-d-cripto-pop3" rel="subsection" title="41.3.3 Servidor pop3">
<link href="ch-d-cripto.html#s-d-cripto-ftp" rel="subsection" title="41.3.4 Transferência de arquivos">
<link href="ch-d-cripto.html#s-d-cripto-rlogin" rel="subsection" title="41.3.5 login remoto">
<link href="ch-d-cripto.html#s-d-cripto-irc" rel="subsection" title="41.3.6 Bate papo via IRC">
<link href="ch-d-cripto.html#s-d-cripto-icq" rel="subsection" title="41.3.7 Transmissão de mensagens via ICQ">
<link href="ch-d-cripto.html#s-d-cripto-gpg-pacote" rel="subsection" title="41.5.1 Instalando o PGP">
<link href="ch-d-cripto.html#s-d-cripto-gpg-criando" rel="subsection" title="41.5.2 Criando um par de chaves pública/privada">
<link href="ch-d-cripto.html#s-d-cripto-gpg-e" rel="subsection" title="41.5.3 Encriptando dados">
<link href="ch-d-cripto.html#s-d-cripto-gpg-d" rel="subsection" title="41.5.4 Decriptando dados com o gpg">
<link href="ch-d-cripto.html#s-d-cripto-gpg-a" rel="subsection" title="41.5.5 Assinando arquivos">
<link href="ch-d-cripto.html#s-d-cripto-gpg-a-c" rel="subsection" title="41.5.6 Checando assinaturas">
<link href="ch-d-cripto.html#s-d-cripto-gpg-c-e" rel="subsection" title="41.5.7 Extraindo sua chave pública do chaveiro">
<link href="ch-d-cripto.html#s-d-cripto-gpg-c-a" rel="subsection" title="41.5.8 Adicionando chaves públicas ao seu chaveiro pessoal">
<link href="ch-d-cripto.html#s-d-cripto-gpg-c-l" rel="subsection" title="41.5.9 Listando chaves de seu chaveiro">
<link href="ch-d-cripto.html#s-d-cripto-gpg-c-d" rel="subsection" title="41.5.10 Apagando chaves de seu chaveiro">
<link href="ch-d-cripto.html#s-d-cripto-gpg-chpasswd" rel="subsection" title="41.5.11 Mudando sua FraseSenha">
<link href="ch-d-cripto.html#s-d-cripto-gpg-sign" rel="subsection" title="41.5.12 Assinando uma chave digital">
<link href="ch-d-cripto.html#s-d-cripto-gpg-c-sign-l" rel="subsection" title="41.5.13 Listando assinaturas digitais">
<link href="ch-d-cripto.html#s-d-cripto-gpg-c-sign-guia" rel="subsection" title="41.5.14 Recomendações para a assinatura de chaves gpg">
<link href="ch-aplic.html#s-aplic-b-editores" rel="subsection" title="42.1.1 Editores de Texto">
<link href="ch-aplic.html#s-aplic-b-escritorio" rel="subsection" title="42.1.2 Aplicativos para Escritório">
<link href="ch-aplic.html#s-aplic-b-internet" rel="subsection" title="42.1.3 Internet">
<link href="ch-aplic.html#s-aplic-b-emuladores" rel="subsection" title="42.1.4 Emuladores">
<link href="ch-aplic.html#s-aplic-b-utils" rel="subsection" title="42.1.5 Utilitários">
<link href="ch-aplic.html#s-aplic-b-admin" rel="subsection" title="42.1.6 Administração do Sistema">
<link href="ch-aplic.html#s-aplic-l-perifericos" rel="subsection" title="42.2.1 Periféricos / Gerenciamento de Hardware">
<link href="ch-aplic.html#s-aplic-l-internet" rel="subsection" title="42.2.2 Internet">
<link href="ch-aplic.html#s-aplic-l-conferencia" rel="subsection" title="42.2.3 Conferência de audio/vídeo via Internet/Intranet">
<link href="ch-aplic.html#s-aplic-l-webhtml" rel="subsection" title="42.2.4 Gerenciamento de WebSites / Linguagem HTML">
<link href="ch-aplic.html#s-aplic-l-multimidia" rel="subsection" title="42.2.5 Multimídia">
<link href="ch-aplic.html#s-aplic-l-som" rel="subsection" title="42.2.6 Som">
<link href="ch-aplic.html#s-aplic-l-comm" rel="subsection" title="42.2.7 Comunicação/Fax">
<link href="ch-aplic.html#s-aplic-l-x11" rel="subsection" title="42.2.8 X Window">
<link href="ch-aplic.html#s-aplic-l-edicao" rel="subsection" title="42.2.9 Editoração Gráfica/Visualizadores">
<link href="ch-aplic.html#s-aplic-l-emul" rel="subsection" title="42.2.10 Emuladores/Ferramentas p/ Interação com outros SO">
<link href="ch-aplic.html#s-aplic-l-prog" rel="subsection" title="42.2.11 Programação / Bancos de Dados / Acesso a Dados">
<link href="ch-aplic.html#s-aplic-l-impressao" rel="subsection" title="42.2.12 Impressão">
<link href="ch-aplic.html#s-aplic-l-texto" rel="subsection" title="42.2.13 Texto">
<link href="ch-aplic.html#s-aplic-l-kernel" rel="subsection" title="42.2.14 Kernel">
<link href="ch-aplic.html#s-aplic-l-notebooks" rel="subsection" title="42.2.15 Notebooks">
<link href="ch-aplic.html#s-aplic-l-cdrec" rel="subsection" title="42.2.16 Gravação de CD/DVD">
<link href="ch-aplic.html#s-aplic-l-cluster" rel="subsection" title="42.2.17 Computação Paralela/Clusters">
<link href="ch-aplic.html#s-aplic-l-handhelds" rel="subsection" title="42.2.18 PalmTop / Palm Pilot / Computadores de Mão">
<link href="ch-aplic.html#s-aplic-l-backup" rel="subsection" title="42.2.19 Backup">
<link href="ch-aplic.html#s-aplic-l-uteis" rel="subsection" title="42.2.20 Utilitários">
<link href="ch-aplic.html#s-aplic-l-compactadores" rel="subsection" title="42.2.21 Compactadores/Descompactadores/Arquivadores">
<link href="ch-aplic.html#s-aplic-l-x10" rel="subsection" title="42.2.22 Dispositivos X-10 (Controle de eletrodomésticos e aparelhos via PC)">
<link href="ch-aplic.html#s-aplic-l-outros" rel="subsection" title="42.2.23 Outros">
<link href="ch-ajuda.html#s-ajuda-paginas" rel="subsection" title="43.11.1 Páginas Internet de Referência">
<link href="ch-ajuda.html#s-ajuda-redes-sociais" rel="subsection" title="43.11.2 Redes sociais">
<link href="ch-ajuda.html#s-ajuda-listas" rel="subsection" title="43.11.3 Listas de discussão">
<link href="ch-ajuda.html#s-ajuda-netiqueta-geral" rel="subsection" title="43.12.1 Recomendações Gerais sobre a Comunicação Eletrônica">
<link href="ch-ajuda.html#s-ajuda-netiqueta-email" rel="subsection" title="43.12.2 Email">
<link href="ch-ajuda.html#s-ajuda-netiqueta-icq" rel="subsection" title="43.12.3 ICQ/Google Hangout/FaceBook Messenger/WhatsApp/Telegram/Jabber/Skype">
<link href="ch-ajuda.html#s-ajuda-netiqueta-talk" rel="subsection" title="43.12.4 Talk">
<link href="ch-ajuda.html#s-ajuda-netiqueta-listas" rel="subsection" title="43.12.5 Listas de Discussão via Email">
<link href="ch-systemd.html#s-s-systemd-sysvinit" rel="subsection" title="44.1.1 sysvinit">
<link href="ch-systemd.html#s-s-systemd-upstart" rel="subsection" title="44.1.2 upstart">
<link href="ch-systemd.html#s-s-systemd-systemd" rel="subsection" title="44.1.3 systemd">
<link href="ch-systemd.html#s-s-systemd-polemicas" rel="subsection" title="44.1.4 As polêmicas em torno do systemd">
<link href="ch-systemd.html#s-s-systemd-systemctl" rel="subsection" title="44.2.1 systemctl">
<link href="ch-systemd.html#s-s-systemd-journalctl" rel="subsection" title="44.2.2 journalctl">
<link href="ch-systemd.html#s-s-systemd-runlevel" rel="subsection" title="44.2.3 Mudando o runlevel com systemd (ou como dar boot em &quot;single mode&quot;)">
<link href="ch-virt-intro.html#s-virt-lxc-creation" rel="subsection" title="46.4.1 Criando um convidado LXC">

</head>

<body>

<p><a name="ch-fw-iptables"></a></p>
<hr>

<p>
[ <a href="ch-x11.html">anterior</a> ]
[ <a href="index.html#contents">Conteúdo</a> ]
[ <a href="ch-intro.html">1</a> ]
[ <a href="ch-bas.html">2</a> ]
[ <a href="ch-hardw.html">3</a> ]
[ <a href="ch-d-l.html">4</a> ]
[ <a href="ch-disc.html">5</a> ]
[ <a href="ch-boot.html">6</a> ]
[ <a href="ch-run.html">7</a> ]
[ <a href="ch-cmdd.html">8</a> ]
[ <a href="ch-cmd.html">9</a> ]
[ <a href="ch-cmdv.html">10</a> ]
[ <a href="ch-cmdn.html">11</a> ]
[ <a href="ch-cmdc.html">12</a> ]
[ <a href="ch-perm.html">13</a> ]
[ <a href="ch-redir.html">14</a> ]
[ <a href="ch-rede.html">15</a> ]
[ <a href="ch-cfgrede.html">16</a> ]
[ <a href="ch-kern.html">17</a> ]
[ <a href="ch-log.html">18</a> ]
[ <a href="ch-cpctd.html">19</a> ]
[ <a href="ch-deb.html">20</a> ]
[ <a href="ch-dpkg.html">21</a> ]
[ <a href="ch-pers.html">22</a> ]
[ <a href="ch-impr.html">23</a> ]
[ <a href="ch-cfg.html">24</a> ]
[ <a href="ch-tasks.html">25</a> ]
[ <a href="ch-compil.html">26</a> ]
[ <a href="ch-manut.html">27</a> ]
[ <a href="ch-etc.html">28</a> ]
[ <a href="ch-inter.html">29</a> ]
[ <a href="ch-x11.html">30</a> ]
[ 31 ]
[ <a href="ch-d-contas.html">32</a> ]
[ <a href="ch-s-apache.html">33</a> ]
[ <a href="ch-s-ident.html">34</a> ]
[ <a href="ch-s-telnet.html">35</a> ]
[ <a href="ch-s-ssh.html">36</a> ]
[ <a href="ch-s-pop3.html">37</a> ]
[ <a href="ch-s-cvs.html">38</a> ]
[ <a href="ch-s-samba.html">39</a> ]
[ <a href="ch-d-restr.html">40</a> ]
[ <a href="ch-d-cripto.html">41</a> ]
[ <a href="ch-aplic.html">42</a> ]
[ <a href="ch-ajuda.html">43</a> ]
[ <a href="ch-systemd.html">44</a> ]
[ <a href="ch-git.html">45</a> ]
[ <a href="ch-virt-intro.html">46</a> ]
[ <a href="ch-apend.html">47</a> ]
[ <a href="ch-d-contas.html">próximo</a> ]
</p>

<hr>

<h1>
Guia Foca GNU/Linux
<br>Capítulo 31 - Firewall iptables
</h1>

<hr>

<p>
Este capítulo documenta o funcionamento do firewall <code>iptables</code> que
acompanha a série do kernel 2.4, opções usadas, e aponta alguns pontos
fundamentais para iniciar a configuração e construção de bons sistemas de
firewall.
</p>

<hr>

<h2 id="s-fw-iptables-intro">31.1 Introdução</h2>

<p>
O <em>Firewall</em> é um programa que como objetivo proteger a máquina contra
acessos indesejados, tráfego indesejado, proteger serviços que estejam
rodando na máquina e bloquear a passagem de coisas que você não deseja
receber (como conexões vindas da Internet para sua segura rede local, evitando
acesso aos dados corporativos de uma empresa ou a seus dados pessoais).  No
kernel do Linux 2.4, foi introduzido o firewall <code>iptables</code> (também
chamado de netfilter) que substitui o <code>ipchains</code> dos kernels da
série 2.2.  Este novo firewall tem como vantagem ser muito estável (assim
como o <code>ipchains</code> e <code>ipfwadm</code>), confiável, permitir
muita flexibilidade na programação de regras pelo administrador do sistema,
mais opções disponíveis ao administrador para controle de tráfego, controle
independente do tráfego da rede local/entre redes/interfaces devido a nova
organização das etapas de roteamento de pacotes.
</p>

<p>
O <code>iptables</code> é um firewall em nível de pacotes e funciona baseado
no endereço/porta de origem/destino do pacote, prioridade, etc.  Ele funciona
através da comparação de regras para saber se um pacote tem ou não
permissão para passar.  Em firewalls mais restritivos, o pacote é bloqueado e
registrado para que o administrador do sistema tenha conhecimento sobre o que
está acontecendo em seu sistema.
</p>

<p>
Ele também pode ser usado para modificar e monitorar o tráfego da rede, fazer
NAT (masquerading, source nat, destination nat), redirecionamento de pacotes,
marcação de pacotes, modificar a prioridade de pacotes que chegam/saem do seu
sistema, contagem de bytes, dividir tráfego entre máquinas, criar proteções
anti-spoofing, contra syn flood, DoS, etc.  O tráfego vindo de máquinas
desconhecidas da rede pode também ser bloqueado/registrado através do uso de
simples regras.  As possibilidades oferecidas pelos recursos de filtragem
<code>iptables</code> como todas as ferramentas UNIX maduras dependem de sua
imaginação, pois ele garante uma grande flexibilidade na manipulação das
regras de acesso ao sistema, precisando apenas conhecer quais interfaces o
sistema possui, o que deseja bloquear, o que tem acesso garantido, quais
serviços devem estar acessíveis para cada rede, e iniciar a construção de
seu firewall.
</p>

<p>
O <code>iptables</code> ainda tem a vantagem de ser modularizável, funções
podem ser adicionadas ao firewall ampliando as possibilidades oferecidas.  Usei
por 2 anos o <code>ipchains</code> e afirmo que este é um firewall que tem
possibilidades de gerenciar tanto a segurança em máquinas isoladas como
roteamento em grandes organizações, onde a passagem de tráfego entre redes
deve ser minuciosamente controlada.
</p>

<p>
Um firewall não funciona de forma automática (instalando e esperar que ele
faça as coisas por você), é necessário pelo menos conhecimentos básicos de
rede tcp/ip, roteamento e portas para criar as regras que farão a segurança
de seu sistema.  A segurança do sistema depende do controle das regras que
serão criadas por você, as falhas humanas são garantia de mais de 95% de
sucesso nas invasões.
</p>

<p>
Enfim o <code>iptables</code> é um firewall que agradará tanto a pessoas que
desejam uma segurança básica em seu sistema, quando administradores de
grandes redes que querem ter um controle minucioso sobre o tráfego que passam
entre suas interfaces de rede (controlando tudo o que pode passar de uma rede a
outra), controlar o uso de tráfego, monitoração, etc.
</p>

<hr>

<h3 id="s-fw-iptables-versao">31.1.1 Versão</h3>

<p>
É assumido que esteja usando a versão 1.2.3 do <code>iptables</code> e
baseadas nas opções do kernel 2.4.16 (sem o uso de módulos experimentais).
As explicações contidas aqui podem funcionar para versões posteriores, mas
é recomendável que leia a documentação sobre modificações no programa
(changelog) em busca de mudanças que alterem o sentido das explicações
fornecidas aqui.
</p>

<hr>

<h3 id="s-fw-iptables-historia">31.1.2 Um resumo da história do iptables</h3>

<p>
O <code>iptables</code> é um código de firewall das versões 2.4 do kernel,
que substituiu o <code>ipchains</code> (presente nas séries 2.2 do kernel).
Ele foi incluído no kernel da série 2.4 em meados de Junho/Julho de 1999.
</p>

<p>
A história do desenvolvimento (desde o porte do <code>ipfw</code> do
<code>BSD</code> para o <code>Linux</code> até o <code>iptables</code> (que é
a quarta geração de firewalls do kernel) está disponível no documento,
<samp>Netfilter-howto</samp>.
</p>

<hr>

<h3 id="s-fw-iptables-caracteristicas">31.1.3 Características do firewall iptables</h3>

<ul>
<li>
<p>
Especificação de portas/endereço de origem/destino
</p>
</li>
<li>
<p>
Suporte a protocolos TCP/UDP/ICMP (incluindo tipos de mensagens icmp)
</p>
</li>
<li>
<p>
Suporte a interfaces de origem/destino de pacotes
</p>
</li>
<li>
<p>
Manipula serviços de proxy na rede
</p>
</li>
<li>
<p>
Tratamento de tráfego dividido em chains (para melhor controle do tráfego que
entra/sai da máquina e tráfego redirecionado.
</p>
</li>
<li>
<p>
Permite um número ilimitado de regras por chain
</p>
</li>
<li>
<p>
Muito rápido, estável e seguro
</p>
</li>
<li>
<p>
Possui mecanismos internos para rejeitar automaticamente pacotes duvidosos ou
mal formados.
</p>
</li>
<li>
<p>
Suporte a módulos externos para expansão das funcionalidades padrões
oferecidas pelo código de firewall
</p>
</li>
<li>
<p>
Suporte completo a roteamento de pacotes, tratadas em uma área diferente de
tráfegos padrões.
</p>
</li>
<li>
<p>
Suporte a especificação de tipo de serviço para priorizar o tráfego de
determinados tipos de pacotes.
</p>
</li>
<li>
<p>
Permite especificar exceções para as regras ou parte das regras
</p>
</li>
<li>
<p>
Suporte a detecção de fragmentos
</p>
</li>
<li>
<p>
Permite enviar alertas personalizados ao <code>syslog</code> sobre o tráfego
aceito/bloqueado.
</p>
</li>
<li>
<p>
Redirecionamento de portas
</p>
</li>
<li>
<p>
Masquerading
</p>
</li>
<li>
<p>
Suporte a SNAT (modificação do endereço de origem das máquinas para um
único IP ou faixa de IP's).
</p>
</li>
<li>
<p>
Suporte a DNAT (modificação do endereço de destino das máquinas para um
único IP ou fixa de IP's)
</p>
</li>
<li>
<p>
Contagem de pacotes que atravessaram uma interface/regra
</p>
</li>
<li>
<p>
Limitação de passagem de pacotes/conferência de regra (muito útil para
criar proteções contra, syn flood, ping flood, DoS, etc).
</p>
</li>
</ul>

<hr>

<h3 id="s-fw-iptables-ficha">31.1.4 Ficha técnica</h3>

<p>
Pacote: <code>iptables</code>
</p>

<ul>
<li>
<p>
<samp>iptables</samp> - Sistema de controle principal para protocolos ipv4
</p>
</li>
<li>
<p>
<samp>ip6tables</samp> - Sistema de controle principal para protocolos ipv6
</p>
</li>
<li>
<p>
<samp>iptables-save</samp> - Salva as regras atuais em um arquivo especificado
como argumento.  Este utilitário pode ser dispensado por um shell script
contendo as regras executado na inicialização da máquina.
</p>
</li>
<li>
<p>
<samp>iptables-restore</samp> - Restaura regras salvas pelo utilitário
<code>iptables-save</code>.
</p>
</li>
</ul>

<hr>

<h3 id="s-fw-iptables-hwreq">31.1.5 Requerimentos</h3>

<p>
É necessário que o seu kernel tenha sido compilado com suporte ao
<code>iptables</code> (veja <a href="#s-fw-iptables-supkernel">Habilitando o
suporte ao iptables no kernel, Seção 31.1.15</a>.  O requerimento mínimo de
memória necessária para a execução do <code>iptables</code> é o mesmo do
kernel 2.4 (4MB).  Dependendo do tráfego que será manipulado pela(s)
interface(s) do firewall ele poderá ser executado com folga em uma máquina
386 SX com 4MB de RAM.
</p>

<p>
Como as configurações residem no kernel não é necessário espaço extra em
disco rígido para a execução deste utilitário.
</p>

<hr>

<h3 id="s-fw-iptables-logs">31.1.6 Arquivos de logs criados pelo iptables</h3>

<p>
Todo tráfego que for registrado pelo <code>iptables</code> é registrado por
padrão no arquivo <code>/var/log/kern.log</code>.
</p>

<hr>

<h3 id="s-fw-iptables-install">31.1.7 Instalação</h3>

<p>
<samp>apt-get install iptables</samp>
</p>

<p>
O pacote <code>iptables</code> contém o utilitário <code>iptables</code> (e
<code>ip6tables</code> para redes ipv6) necessários para inserir suas regras
no kernel.  Se você não sabe o que é ipv6, não precisará se preocupar com
o utilitário <code>ip6tables</code> por enquanto.
</p>

<hr>

<h3 id="s-fw-iptables-contribuindo">31.1.8 Enviando Correções/Contribuindo com o projeto</h3>

<p>
A página principal do projeto é <samp><code><a
href="http://netfilter.filewatcher.org">http://netfilter.filewatcher.org</a></code></samp>.
Sugestões podem ser enviadas para a lista de desenvolvimento oficial do
<code>iptables</code>: <samp><code><a
href="http://lists.samba.org">http://lists.samba.org</a></code></samp>.
</p>

<hr>

<h3 id="s-fw-iptables-oldfw">31.1.9 O que aconteceu com o <code>ipchains</code> e <code>ipfwadm</code>?</h3>

<p>
O <code>iptables</code> faz parte da nova geração de firewalls que acompanha
o kernel 2.4, mas o suporte ao <code>ipchains</code> e <code>ipfwadm</code>
ainda será mantido através de módulos de compatibilidade do kernel até
2004.  Seria uma grande falta de consideração retirar o suporte a estes
firewalls do kernel como forma de obrigar a &quot;aprenderem&quot; o
<code>iptables</code> (mesmo o suporte sendo removido após este período,
acredito que criarão patches &quot;externos&quot; para futuros kernels que
não trarão mais este suporte).  Se precisa do suporte a estes firewalls antes
de passar em definitivo para o <code>iptables</code> leia <a
href="#s-fw-iptables-supkernel">Habilitando o suporte ao iptables no kernel,
Seção 31.1.15</a>.
</p>

<p>
Se você é um administrador que gosta de explorar todos os recursos de um
firewall, usa todos os recursos que ele oferece ou mantém uma complexa rede
corporativa, tenho certeza que gostará do <code>iptables</code>.
</p>

<hr>

<h3 id="s-fw-iptables-tiposfw">31.1.10 Tipos de firewalls</h3>

<p>
Existem basicamente dois tipos de firewalls:
</p>
<ul>
<li>
<p>
<samp>nível de aplicação</samp> - Este tipo de firewall analisam o conteúdo
do pacote para tomar suas decisões de filtragem.  Firewalls deste tipo são
mais intrusivos (pois analisam o conteúdo de tudo que passa por ele) e
permitem um controle relacionado com o conteúdo do tráfego.  Alguns firewalls
em nível de aplicação combinam recursos básicos existentes em firewalls em
nível de pacotes combinando as funcionalidade de controle de tráfego/controle
de acesso em uma só ferramenta.  Servidores proxy, como o <code>squid</code>,
são um exemplo deste tipo de firewall.
</p>
</li>
<li>
<p>
<samp>nível de pacotes</samp> - Este tipo de firewall toma as decisões
baseadas nos parâmetros do pacote, como porta/endereço de origem/destino,
estado da conexão, e outros parâmetros do pacote.  O firewall então pode
negar o pacote (DROP) ou deixar o pacote passar (ACCEPT).  O
<code>iptables</code> é um excelente firewall que se encaixa nesta categoria.
</p>
<p>
Firewall em nível de pacotes é o assunto explicado nesta seção do guia mas
será apresentada uma explicação breve sobre o funcionamento de análise de
strings do <code>iptables</code>.
</p>
</li>
</ul>

<p>
Os dois tipos de firewalls podem ser usados em conjunto para fornecer uma
camada dupla de segurança no acesso as suas máquinas/máquinas clientes.
</p>

<hr>

<h3 id="s-fw-iptables-proteger-oque">31.1.11 O que proteger?</h3>

<p>
Antes de iniciar a construção do firewall é bom pensar nos seguintes pontos:
</p>
<ul>
<li>
<p>
Quais serviços precisa proteger.  Serviços que devem ter acesso garantido a
usuários externos e quais serão bloqueados a todas/determinadas máquinas.
É recomendável bloquear o acesso a todas portas menores que 1024 por
executarem serviços que rodam com privilégio de usuário <samp>root</samp>, e
autorizar somente o acesso as portas que realmente deseja (configuração
restritiva nesta faixa de portas).
</p>
</li>
<li>
<p>
Que tipo de conexões eu posso deixar passar e quais bloquear.  Serviços com
autenticação em texto plano e potencialmente inseguros como rlogin, telnet,
ftp, NFS, DNS, LDAP, SMTP RCP, X-Window são serviços que devem ser ter acesso
garantido somente para máquinas/redes que você confia.  Estes serviços podem
não ser só usados para tentativa de acesso ao seu sistema, mas também como
forma de atacar outras pessoas aproveitando-se de problemas de configuração.
</p>
<p>
A configuração do firewall ajuda a prevenir isso, mesmo se um serviço
estiver mal configurado e tentando enviar seus pacotes para fora, será
impedido.  Da mesma forma se uma máquina Windows de sua rede for infectada por
um trojan não haverá pânico: o firewall poderá estar configurado para
bloquear qualquer tentativa de conexão vinda da internet (cracker) para as
máquinas de sua rede.
</p>
<p>
Para cópia de arquivos via rede insegura (como através da Internet), é
recomendado o uso de serviços que utilizam criptografia para login e
transferência de arquivos (veja <a href="ch-s-ssh.html">Servidor ssh,
Capítulo 36</a>) ou a configuração de uma VPN.
</p>
</li>
<li>
<p>
Que máquinas terão acesso livre e quais serão restritas.
</p>
</li>
<li>
<p>
Que serviços deverão ter prioridade no processamento.
</p>
</li>
<li>
<p>
Que máquinas/redes NUNCA deverão ter acesso a certas/todas máquinas.
</p>
</li>
<li>
<p>
O volume de tráfego que o servidor manipulará.  Através disso você pode ter
que balancear o tráfego entre outras máquinas, configurar proteções contra
DoS, syn flood, etc.
</p>
</li>
<li>
<p>
O que tem permissão de passar de uma rede para outra (em máquinas que atuam
como roteadores/gateways de uma rede interna).
</p>
</li>
<li>
<p>
Etc.
</p>
</li>
</ul>

<p>
A análise destes pontos pode determinar a complexidade do firewall, custos de
implementação, prazo de desenvolvimento e tempo de maturidade do código para
implementação.  Existem muitos outros pontos que podem entrar na questão de
desenvolvimento de um sistema de firewall, eles dependem do tipo de firewall
que está desenvolvendo e das políticas de segurança de sua rede.
</p>

<hr>

<h3 id="s-fw-iptables-regras-oque">31.1.12 O que são regras?</h3>

<p>
As regras são como comandos passados ao <code>iptables</code> para que ele
realize uma determinada ação (como bloquear ou deixar passar um pacote) de
acordo com o endereço/porta de origem/destino, interface de origem/destino,
etc.  As regras são armazenadas dentro dos chains e processadas na ordem que
são inseridas.
</p>

<p>
As regras são armazenadas no kernel, o que significa que quando o computador
for reiniciado tudo o que fez será perdido.  Por este motivo elas deverão ser
gravadas em um arquivo para serem carregadas a cada inicialização.
</p>

<p>
Um exemplo de regra: <samp>iptables -A INPUT -s 123.123.123.1 -j DROP</samp>.
</p>

<hr>

<h3 id="s-fw-iptables-chains-oque">31.1.13 O que são chains?</h3>

<p>
Os <em>Chains</em> são locais onde as regras do firewall definidas pelo
usuário são armazenadas para operação do firewall.  Existem dois tipos de
chains: os embutidos (como os chains <em>INPUT</em>, <em>OUTPUT</em> e
<em>FORWARD</em>) e os criados pelo usuário.  Os nomes dos chains embutidos
devem ser especificados sempre em maiúsculas (note que os nomes dos chains
são case-sensitive, ou seja, o chain <samp>input</samp> é completamente
diferente de <samp>INPUT</samp>).
</p>

<hr>

<h3 id="s-fw-iptables-tabelas">31.1.14 O que são tabelas?</h3>

<p>
Tabelas são os locais usados para armazenar os chains e conjunto de regras com
uma determinada característica em comum.  As tabelas podem ser referenciadas
com a opção <em>-t tabela</em> e existem 3 tabelas disponíveis no
<code>iptables</code>:
</p>
<ul>
<li>
<p>
<samp>filter</samp> - Esta é a tabela padrão, contém 3 chains padrões:
</p>
<ul>
<li>
<p>
<samp>INPUT</samp> - Consultado para dados que chegam a máquina
</p>
</li>
<li>
<p>
<samp>OUTPUT</samp> - Consultado para dados que saem da máquina
</p>
</li>
<li>
<p>
<samp>FORWARD</samp> - Consultado para dados que são redirecionados para outra
interface de rede ou outra máquina.
</p>
</li>
</ul>

<p>
Os chains <em>INPUT</em> e <em>OUTPUT</em> somente são atravessados por
conexões indo/se originando de localhost.
</p>

<p>
<strong>OBS</strong>: Para conexões locais, somente os chains <em>INPUT</em> e
<em>OUTPUT</em> são consultados na tabela filter.
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>nat</samp> - Usada para dados que gera outra conexão (masquerading,
source nat, destination nat, port forwarding, proxy transparente são alguns
exemplos).  Possui 3 chains padrões:
</p>
<ul>
<li>
<p>
<samp>PREROUTING</samp> - Consultado quando os pacotes precisam ser modificados
logo que chegam.  É o chain ideal para realização de DNAT e redirecionamento
de portas (<a href="#s-fw-iptables-nat-dnat">Fazendo DNAT, Seção 31.4.4</a>).
</p>
</li>
<li>
<p>
<samp>OUTPUT</samp> - Consultado quando os pacotes gerados localmente precisam
ser modificados antes de serem roteados.  Este chain somente é consultado para
conexões que se originam de IPs de interfaces locais.
</p>
</li>
<li>
<p>
<samp>POSTROUTING</samp> - Consultado quando os pacotes precisam ser
modificados após o tratamento de roteamento.  É o chain ideal para
realização de SNAT e IP Masquerading (<a
href="#s-fw-iptables-nat-snat">Fazendo SNAT, Seção 31.4.3</a>).
</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>
<samp>mangle</samp> - Utilizada para alterações especiais de pacotes (como
modificar o tipo de serviço (TOS) ou outros detalhes que serão explicados no
decorrer do capítulo.  Possui 2 chains padrões:
</p>
<ul>
<li>
<p>
<samp>INPUT</samp> - Consultado quando os pacotes precisam ser modificados
antes de serem enviados para o chain <em>INPUT</em> da tabela <em>filter</em>.
</p>
</li>
<li>
<p>
<samp>FORWARD</samp> - Consultado quando os pacotes precisam ser modificados
antes de serem enviados para o chain <em>FORWARD</em> da tabela
<em>filter</em>.
</p>
</li>
<li>
<p>
<samp>PREROUTING</samp> - Consultado quando os pacotes precisam ser modificados
antes de ser enviados para o chain <em>PREROUTING</em> da tabela <em>nat</em>.
</p>
</li>
<li>
<p>
<samp>POSTROUTING</samp> - Consultado quando os pacotes precisam ser
modificados antes de serem enviados para o chain <em>POSTROUTING</em> da tabela
<em>nat</em>.
</p>
</li>
<li>
<p>
<samp>OUTPUT</samp> - Consultado quando os pacotes precisam ser modificados
antes de serem enviados para o chain <em>OUTPUT</em> da tabela <em>nat</em>.
</p>
</li>
</ul>

<p>
Veja <a href="#s-fw-iptables-mangle">A tabela mangle, Seção 31.5</a> para
mais detalhes sobre a tabela mangle.
</p>
</li>
</ul>

<hr>

<h3 id="s-fw-iptables-supkernel">31.1.15 Habilitando o suporte ao iptables no kernel</h3>

<p>
Para usar toda a funcionalidade do firewall <code>iptables</code>, permitindo
fazer o controle do que tem ou não permissão de acessar sua máquina, fazer
Masquerading/NAT em sua rede, etc., você precisará dos seguintes componentes
compilados em seu kernel (os módulos experimentais fora ignorados
intencionalmente):
</p>

<pre>
     *
     * Network Options:
     *
     
     Network packet filtering (replaces ipchains) [Y/m/n/?]
      Network packet filtering debugging [Y/m/n/?]
     
     e na Subseção:
     
     *
     *   IP: Netfilter Configuration
     *
     Connection tracking (required for masq/NAT) (CONFIG_IP_NF_CONNTRACK) [M/n/y/?] 
       FTP protocol support (CONFIG_IP_NF_FTP) [M/n/?] 
       IRC protocol support (CONFIG_IP_NF_IRC) [M/n/?]
     IP tables support (required for filtering/masq/NAT) (CONFIG_IP_NF_IPTABLES) [Y/m/n/?]
       limit match support (CONFIG_IP_NF_MATCH_LIMIT) [Y/m/n/?] 
       MAC address match support (CONFIG_IP_NF_MATCH_MAC) [M/n/y/?] 
       netfilter MARK match support (CONFIG_IP_NF_MATCH_MARK) [M/n/y/?] 
       Multiple port match support (CONFIG_IP_NF_MATCH_MULTIPORT) [M/n/y/?] 
       TOS match support (CONFIG_IP_NF_MATCH_TOS) [M/n/y/?] 
       LENGTH match support (CONFIG_IP_NF_MATCH_LENGTH) [M/n/y/?]
       TTL match support (CONFIG_IP_NF_TTL) [M/n/y/?]
       tcpmss match support (CONFIG_IP_NF_MATCH_TCPMSS) [M/n/y/?] 
       Connection state match support (CONFIG_IP_NF_MATCH_STATE) [M/n/?] 
       Packet filtering (CONFIG_IP_NF_FILTER) [M/n/y/?] 
         REJECT target support (CONFIG_IP_NF_TARGET_REJECT) [M/n/?] 
       Full NAT (CONFIG_IP_NF_NAT) [M/n/?] 
         MASQUERADE target support (CONFIG_IP_NF_TARGET_MASQUERADE) [M/n/?] 
         REDIRECT target support (CONFIG_IP_NF_TARGET_REDIRECT) [M/n/?] 
       Packet mangling (CONFIG_IP_NF_MANGLE) [M/n/y/?] 
         TOS target support (CONFIG_IP_NF_TARGET_TOS) [M/n/?] 
         MARK target support (CONFIG_IP_NF_TARGET_MARK) [M/n/?] 
       LOG target support (CONFIG_IP_NF_TARGET_LOG) [M/n/y/?] 
       TCPMSS target support (CONFIG_IP_NF_TARGET_TCPMSS) [M/n/y/?]
</pre>

<p>
Esta configuração permite que você não tenha problemas para iniciar o uso e
configuração do seu firewall iptables, ela ativa os módulos necessários
para utilização de todos os recursos do firewall <code>iptables</code>.
Quando conhecer a função de cada um dos parâmetros acima (durante o decorrer
do texto), você poderá eliminar muitas das opções desnecessárias para seu
estilo de firewall ou continuar fazendo uso de todas ;-)
</p>

<p>
<strong>OBS1:</strong> A configuração acima leva em consideração que você
NÃO executará os códigos antigos de firewall <code>ipfwadm</code> e
<code>ipchains</code>.  Caso deseje utilizar o <code>ipchains</code> ou o
<code>ipfwadm</code>, será preciso responder com &quot;M&quot; a questão
&quot;IP tables support (required for filtering/masq/NAT)
(CONFIG_IP_NF_IPTABLES)&quot;.  Será necessário carregar manualmente o
módulo correspondente ao firewall que deseja utilizar (<samp>modprobe
<code>iptables_filter.o</code></samp> no caso do <code>iptables</code>).
</p>

<p>
Não execute mais de um tipo de firewall ao mesmo tempo!!!
</p>

<p>
<strong>OBS2:</strong> É recomendável ativar o daemon <code>kmod</code> para
carga automática de módulos, caso contrário será necessário compilar todas
as partes necessárias embutidas no kernel, carregar os módulos necessários
manualmente ou pelo <code>iptables</code> (através da opção
<em>--modprobe=módulo</em>).
</p>

<hr>

<h3 id="s-fw-iptables-proxy">31.1.16 Ligando sua rede interna a Internet</h3>

<p>
Se a sua intenção (como da maioria dos usuários) é conectar sua rede
interna a Internet de forma rápida e simples, leia <a
href="#s-fw-iptables-nat-fastmasquerade">Fazendo IP masquerading (para os
apressados), Seção 31.4.2</a> ou <a href="#s-fw-iptables-nat-snat">Fazendo
SNAT, Seção 31.4.3</a>.  Um exemplo prático de configuração de
Masquerading deste tipo é encontrado em <a
href="#s-fw-iptables-exemplo-snat">Conectando sua rede interna a Internet,
Seção 31.8.3</a>.
</p>

<p>
Após configurar o masquerading, você só precisará especificar o endereço
IP da máquina masquerading (servidor) como <em>Gateway</em> da rede.  No
<code>Windows 9x/NT/2000</code> isto é feito no Painel de
Controle/Rede/Propriedades de Tcp/IP.  No <code>Linux</code> pode ser feito com
<samp>route add default gw IP_do_Servidor</samp>.
</p>

<hr>

<h2 id="s-fw-iptables-chains">31.2 Manipulando chains</h2>

<p>
O <code>iptables</code> trabalha com uma tabela de regras que é analisada uma
a uma até que a última seja processada.  Por padrão, se uma regra tiver
qualquer erro, uma mensagem será mostrada e ela descartada.  O pacote não
conferirá e a ação final (se ele vai ser aceito ou rejeitado) dependerá das
regras seguintes.
</p>

<p>
As opções passadas ao <code>iptables</code> usadas para manipular os chains
são <strong>SEMPRE</strong> em maiúsculas.  As seguintes operações podem
ser realizadas:
</p>

<hr>

<h3 id="s-fw-iptables-chains-A">31.2.1 Adicionando regras - A</h3>

<p>
Como exemplo vamos criar uma regra que bloqueia o acesso a nosso própria
máquina (127.0.0.1 - loopback).  Primeiro daremos um ping para verificar seu
funcionamento:
</p>

<pre>
     #ping 127.0.0.1
     PING 127.0.0.1 (127.0.0.1): 56 data bytes
     64 bytes from 127.0.0.1: icmp_seq=0 ttl=255 time=0.6 ms
     64 bytes from 127.0.0.1: icmp_seq=1 ttl=255 time=0.5 ms
     
     --- 127.0.0.1 ping statistics ---
     2 packets transmitted, 2 packets received, 0% packet loss
     round-trip min/avg/max = 0.5/0.5/0.6 ms
</pre>

<p>
Ok, a máquina responde, agora vamos incluir uma regra no chain INPUT (<em>-A
INPUT</em>) que bloqueie (<em>-j DROP</em>) qualquer acesso indo ao endereço
127.0.0.1 (<em>-d 127.0.0.1</em>):
</p>

<p>
<samp>iptables -t filter -A INPUT -d 127.0.0.1 -j DROP</samp>
</p>

<p>
Agora verificamos um novo ping:
</p>

<pre>
     #ping 127.0.0.1
     PING 127.0.0.1 (127.0.0.1): 56 data bytes
     
     --- 127.0.0.1 ping statistics ---
     2 packets transmitted, 0 packets received, 100% packet loss
</pre>

<p>
Desta vez a máquina 127.0.0.1 não respondeu, pois todos os pacotes com o
destino 127.0.0.1 (-d 127.0.0.1) são rejeitados (-j DROP).  A opção
<em>-A</em> é usada para adicionar novas regras no final do chain.  Além de
<em>-j DROP</em> que serve para rejeitar os pacotes, podemos também usar
<em>-j ACCEPT</em> para aceitar pacotes.  A opção <samp>-j</samp> é chamada
de <em>alvo da regra</em> ou somente <em>alvo</em> pois define o destino do
pacote que atravessa a regra (veja <a
href="#s-fw-iptables-outras-alvo">Especificando um alvo, Seção 31.3.6</a>).
Bem vindo a base de um sistema de firewall :-)
</p>

<p>
<strong>OBS1:</strong> - O acesso a interface loopback não deve ser de forma
alguma bloqueado, pois muitos aplicativos utilizam soquetes tcp para realizarem
conexões, mesmo que você não possua uma rede interna.
</p>

<p>
<strong>OBS2:</strong> - A tabela <em>filter</em> será usada como padrão caso
nenhuma tabela seja especificada através da opção <samp>-t</samp>.
</p>

<hr>

<h3 id="s-fw-iptables-chains-L">31.2.2 Listando regras - L</h3>

<p>
A seguinte sintaxe é usada para listar as regras criadas:
</p>

<p>
<samp>iptables [<em>-t tabela</em>] -L [<em>chain</em>]
[<em>opções</em>]</samp>
</p>

<p>
Onde:
</p>
<dl>
<dt><em>tabela</em></dt>
<dd>
<p>
É uma das tabelas usadas pelo <code>iptables</code>.  Se a tabela não for
especificada, a tabela <em>filter</em> será usada como padrão.  Veja <a
href="#s-fw-iptables-tabelas">O que são tabelas?, Seção 31.1.14</a> para
detalhes.
</p>
</dd>
<dt><em>chain</em></dt>
<dd>
<p>
Um dos chains disponíveis na tabela acima (veja <a
href="#s-fw-iptables-tabelas">O que são tabelas?, Seção 31.1.14</a>) ou
criado pelo usuário (<a href="#s-fw-iptables-chains-N">Criando um novo chain -
N, Seção 31.2.6</a>).  Caso o chain não seja especificado, todos os chains
da tabela serão mostrados.
</p>
</dd>
<dt><em>opções</em></dt>
<dd>
<p>
As seguintes opções podem ser usadas para listar o conteúdo de chains:
</p>
<ul>
<li>
<p>
<samp>-v</samp> - Exibe mais detalhes sobre as regras criadas nos chains.
</p>
</li>
<li>
<p>
<samp>-n</samp> - Exibe endereços de máquinas/portas como números ao invés
de tentar a resolução DNS e consulta ao <code>/etc/services</code>.  A
resolução de nomes pode tomar muito tempo dependendo da quantidade de regras
que suas tabelas possuem e velocidade de sua conexão.
</p>
</li>
<li>
<p>
<samp>-x</samp> - Exibe números exatos ao invés de números redondos.
Também mostra a faixa de portas de uma regra de firewall.
</p>
</li>
<li>
<p>
<samp>--line-numbers</samp> - Exibe o número da posição da regra na primeira
coluna da listagem.
</p>
</li>
</ul>
</dd>
</dl>

<p>
Para listar a regra criada anteriormente usamos o comando:
</p>

<pre>
     #iptables -t filter -L INPUT
     
     Chain INPUT (policy ACCEPT)
     target     prot opt source               destination         
     DROP       all  --  anywhere             localhost
</pre>

<p>
O comando <samp>iptables -L INPUT -n</samp> tem o mesmo efeito, a diferença é
que são mostrados números ao invés de nomes:
</p>

<pre>
     #iptables -L INPUT -n
     
     Chain INPUT (policy ACCEPT)
     target     prot opt source               destination
     DROP       all  --  0.0.0.0/0            127.0.0.1
     
     
     #iptables -L INPUT -n --line-numbers
     
     Chain INPUT (policy ACCEPT)
     num target     prot opt source               destination
     1   DROP       all  --  0.0.0.0/0            127.0.0.1
     
     #iptables -L INPUT -n -v
     Chain INPUT (policy ACCEPT 78 packets, 5820 bytes)
      pkts bytes target     prot opt in     out     source               destination
         2   194 DROP       icmp --  *      *       0.0.0.0/0            127.0.0.1
</pre>

<p>
Os campos assim possuem o seguinte significado:
</p>
<dl>
<dt>Chain INPUT</dt>
<dd>
<p>
Nome do chain listado
</p>
</dd>
<dt>(policy ACCEPT 78 packets, 5820 bytes)</dt>
<dd>
<p>
política padrão do chain (veja <a
href="#s-fw-iptables-chains-P">Especificando a política padrão de um chain -
P, Seção 31.2.12</a>).
</p>
</dd>
<dt>pkts</dt>
<dd>
<p>
Quantidade de pacotes que atravessaram a regra (veja <a
href="#s-fw-iptables-chains-Z">Zerando contador de bytes dos chains - Z,
Seção 31.2.11</a>).
</p>
</dd>
<dt>bytes</dt>
<dd>
<p>
Quantidade de bytes que atravessaram a regra.  Pode ser referenciado com K
(Kilobytes), M (Megabytes), G (Gigabytes).
</p>
</dd>
<dt>target</dt>
<dd>
<p>
O alvo da regra, o destino do pacote.  Pode ser ACCEPT, DROP ou outro chain.
Veja <a href="#s-fw-iptables-outras-alvo">Especificando um alvo, Seção
31.3.6</a> para detalhes sobre a especificação de um alvo.
</p>
</dd>
<dt>prot</dt>
<dd>
<p>
Protocolo especificado pela regra.  Pode ser udp, tcp, icmp ou all.  Veja <a
href="#s-fw-iptables-outras-proto">Especificando um protocolo, Seção
31.3.3</a> para detalhes.
</p>
</dd>
<dt>opt</dt>
<dd>
<p>
Opções extras passadas a regra.  Normalmente &quot;!&quot; (veja <a
href="#s-fw-iptables-outras-excessoes">Especificando uma exceção, Seção
31.3.5</a>) ou &quot;f&quot; (veja <a
href="#s-fw-iptables-outras-fragmentos">Especificando fragmentos, Seção
31.3.4</a>).
</p>
</dd>
<dt>in</dt>
<dd>
<p>
Interface de entrada (de onde os dados chegam).  Veja <a
href="#s-fw-iptables-outras-iface">Especificando a interface de origem/destino,
Seção 31.3.2</a>.
</p>
</dd>
<dt>out</dt>
<dd>
<p>
Interface de saída (para onde os dados vão).  Veja <a
href="#s-fw-iptables-outras-iface">Especificando a interface de origem/destino,
Seção 31.3.2</a>.
</p>
</dd>
<dt>source</dt>
<dd>
<p>
Endereço de origem.  Veja <a href="#s-fw-iptables-outras-endOD">Especificando
um endereço de origem/destino, Seção 31.3.1</a>.
</p>
</dd>
<dt>destination</dt>
<dd>
<p>
Endereço de destino.  Veja <a href="#s-fw-iptables-outras-endOD">Especificando
um endereço de origem/destino, Seção 31.3.1</a>.
</p>
</dd>
<dt>outras opções</dt>
<dd>
<p>
Estas opções normalmente aparecem quando são usadas a opção -x:
</p>
<ul>
<li>
<p>
<samp>dpt ou dpts</samp> - Especifica a porta ou faixa de portas de destino.
</p>
</li>
<li>
<p>
<samp>reject-with icmp-port-unreachable</samp> - Significa que foi usado o alvo
REJECT naquela regra (veja <a href="#s-fw-iptables-outras-alvo-REJECT">Alvo
REJECT, Seção 31.3.6.1</a>).
</p>
</li>
</ul>
</dd>
</dl>

<hr>

<h3 id="s-fw-iptables-chains-D">31.2.3 Apagando uma regra - D</h3>

<p>
Para apagar um chain, existem duas alternativas:
</p>
<!-- ol type="1" start="1"  -->
<li>
<p>
Quando sabemos qual é o número da regra no chain (listado com a opção
<samp>-L</samp>) podemos referenciar o número diretamente.  Por exemplo, para
apagar a regra criada acima:
</p>
<p>
<samp>iptables -t filter -D INPUT 1</samp>
</p>
<p>
Esta opção não é boa quando temos um firewall complexo com um grande
número de regras por chains, neste caso a segunda opção é a mais
apropriada.
</p>
</li>
<li>
<p>
Usamos a mesma sintaxe para criar a regra no chain, mas trocamos
<samp>-A</samp> por <samp>-D</samp>:
</p>
<p>
<samp>iptables -t filter -D INPUT -d 127.0.0.1 -j DROP</samp>
</p>
<p>
Então a regra correspondentes no chain INPUT será automaticamente apagada
(confira listando o chain com a opção &quot;-L&quot;).  Caso o chain possua
várias regras semelhantes, somente a primeira será apagada.
</p>
<p>
<strong>OBS:</strong> Não é possível apagar os chains defaults do
<code>iptables</code> (<em>INPUT</em>, <em>OUTPUT</em>...).
</p>
</li>
</ol>

<hr>

<h3 id="s-fw-iptables-chains-I">31.2.4 Inserindo uma regra - I</h3>

<p>
Precisamos que o tráfego vindo de <code>192.168.1.15</code> não seja
rejeitado pelo nosso firewall.  Não podemos adicionar uma nova regra (-A) pois
esta seria incluída no final do chain e o tráfego seria rejeitado pela
primeira regra (nunca atingindo a segunda).  A solução é inserir a nova
regra antes da regra que bloqueia todo o tráfego ao endereço
<code>127.0.0.1</code> na posição 1:
</p>

<p>
<samp>iptables -t filter -I INPUT 1 -s 192.168.1.15 -d 127.0.0.1 -j
ACCEPT</samp>
</p>

<p>
Após este comando, temos a regra inserida na primeira posição do chain
(repare no número 1 após INPUT) e a antiga regra número 1 passa a ser a
número 2.  Desta forma a regra acima será consultada, se a máquina de origem
for 192.168.1.15 então o tráfego estará garantido, caso contrário o
tráfego com o destino 127.0.0.1 será bloqueado na regra seguinte.
</p>

<hr>

<h3 id="s-fw-iptables-chains-R">31.2.5 Substituindo uma regra - R</h3>

<p>
Após criar nossa regra, percebemos que a nossa intenção era somente bloquear
os pings com o destino <code>127.0.0.1</code> (pacotes ICMP) e não havia
necessidade de bloquear todo o tráfego da máquina.  Existem duas
alternativas: apagar a regra e inserir uma nova no lugar ou modificar
diretamente a regra já criada sem afetar outras regras existentes e mantendo a
sua ordem no chain (isso é muito importante).  Use o seguinte comando:
</p>

<p>
<samp>iptables -R INPUT 2 -d 127.0.0.1 -p icmp -j DROP</samp>
</p>

<p>
O número <samp>2</samp> é o número da regra que será substituída no chain
INPUT, e deve ser especificado.  O comando acima substituirá a regra 2 do
chain INPUT (-R INPUT 2) bloqueando (-j DROP) qualquer pacote icmp (-p icmp)
com o destino <code>127.0.0.1</code> (-d 127.0.0.1).
</p>

<hr>

<h3 id="s-fw-iptables-chains-N">31.2.6 Criando um novo chain - N</h3>

<p>
Em firewalls organizados com um grande número de regras, é interessante criar
chains individuais para organizar regras de um mesmo tipo ou que tenha por
objetivo analisar um tráfego de uma mesma categoria (interface, endereço de
origem, destino, protocolo, etc) pois podem consumir muitas linhas e tornar o
gerenciamento do firewall confuso (e conseqüentemente causar sérios riscos de
segurança).  O tamanho máximo de um nome de chain é de 31 caracteres e podem
conter tanto letras maiúsculas quanto minúsculas.
</p>

<p>
<samp>iptables [<em>-t tabela</em>] [<em>-N novochain</em>]</samp>
</p>

<p>
Para criar o chain <em>internet</em> (que pode ser usado para agrupar as regras
de internet) usamos o seguinte comando:
</p>

<pre>
      iptables -t filter -N internet
</pre>

<p>
Para inserir regras no chain <em>internet</em> basta especifica-lo após a
opção -A:
</p>

<pre>
      iptables -t filter -A internet -s 200.200.200.200 -j DROP
</pre>

<p>
E então criamos um pulo (-j) do chain <em>INPUT</em> para o chain
<em>internet</em>:
</p>

<p>
<samp>iptables -t filter -A INPUT -j internet</samp>
</p>

<p>
<strong>OBS:</strong> O chain criando pelo usuário pode ter seu nome tanto em
maiúsculas como minúsculas.
</p>

<p>
Se uma máquina do endereço 200.200.200.200 tentar acessar sua máquina, o
<code>iptables</code> consultará as seguintes regras:
</p>

<pre>
     `INPUT'                         `internet'
      ----------------------------    -----------------------------
      | Regra1: -s 192.168.1.15  |    | Regra1: -s 200.200.200.200|
      |--------------------------|    |---------------------------|
      | Regra2: -s 192.168.1.1   |    | Regra2: -d 192.168.1.1    |
      |--------------------------|    -----------------------------
      | Regra3: -j DROP          |
      ----------------------------
     
     O pacote tem o endereço de origem 
     200.200.200.200, ele passa pela
     primeira e segunda regras do chain
     INPUT, a terceira regra direciona 
     para o chain internet
     
                                         _______________________________________
                                v       /                                      v
      /-------------------------|-\    / /-------------------------------------|-\
      | Regra1: -s 192.168.1.15 | |   /  | Regra1: -s 200.200.200.200 -j DROP  \_____\
      |-------------------------|-|  /   |---------------------------------------|   /
      | Regra2: -s 192.168.1.1  | | /    | Regra2: -d 200.200.200.202 -j DROP    |
      |-------------------------|-|/     \---------------------------------------/
      | Regra3: -j internet      /|
      |---------------------------|       No chain internet, a primeira regra confere
      | Regra4: -j DROP           |       com o endereço de origem 200.200.200.200 e 
      \---------------------------/       o pacote é bloqueado. 
      
     
     Se uma máquina com o endereço de origem 200.200.200.201 tentar acessar a máquina, 
     então as regra consultadas serão as seguintes:
     
     
     O pacote tem o endereço de origem 
     200.200.200.201, ele passa pela
     primeira e segunda regras do chain
     INPUT, a terceira regra direciona 
     para o chain internet               ______________________________________
                                v       /                                      v
      /-------------------------|-\    / /-------------------------------------|-\
      | Regra1: -s 192.168.1.15 | |   /  | Regra1: -s 200.200.200.200 -j DROP  | |
      |-------------------------|-|  /   |-------------------------------------|-|
      | Regra2: -s 192.168.1.1  | | /    | Regra2: -s 200.200.200.202 -j DROP  | |
      |-------------------------|-|/     \-------------------------------------|-/
      | Regra3: -j internet      /|                                            v
      |---------------------------|                                           /
      | Regra4: -j DROP         --+-------------------------------------------      
      \------------------------/-/       O pacote passa pelas regras 1 e 2 do chain
                               |         internet, como ele não confere com nenhuma
                               v         das 2 regras ele retorna ao chain INPUT e é 
      Esta regra é a número 4            analisado pela regra seguinte.
      que diz para rejeitar o 
      pacote.
</pre>

<hr>

<h3 id="s31.2.7">31.2.7 Renomeando um chain criado pelo usuário - E</h3>

<p>
Se por algum motivo precisar renomear um chain criado por você na tabela
<em>filter</em>, <em>nat</em> ou <em>mangle</em>, isto poderá ser feito usando
a opção <em>-E</em> do <code>iptables</code>:
</p>

<pre>
     iptables -t filter -E chain-antigo novo-chain
</pre>

<p>
Note que não é possível renomear os chains defaults do
<code>iptables</code>.
</p>

<hr>

<h3 id="s31.2.8">31.2.8 Listando os nomes de todas as tabelas atuais</h3>

<p>
Use o comando <samp>cat /proc/net/ip_tables_names</samp> para fazer isto.  É
interessante dar uma olhada nos arquivos dentro do diretório
<code>/proc/net</code>, pois os arquivos existentes podem lhe interessar para
outras finalidades.
</p>

<hr>

<h3 id="s-fw-iptables-chains-F">31.2.9 Limpando as regras de um chain - F</h3>

<p>
Para limpar todas as regras de um chain, use a seguinte sintaxe:
</p>

<p>
<samp>iptables [<em>-t tabela</em>] [<em>-F chain</em>]</samp>
</p>

<p>
Onde:
</p>
<dl>
<dt><em>tabela</em></dt>
<dd>
<p>
Tabela que contém o chain que desejamos zerar.
</p>
</dd>
</dl>
<dl>
<dt><em>chain</em></dt>
<dd>
<p>
Chain que desejamos limpar.  Caso um chain não seja especificado, todos os
chains da tabela serão limpos.
</p>
</dd>
</dl>

<pre>
       iptables -t filter -F INPUT
       iptables -t filter -F
</pre>

<hr>

<h3 id="s-fw-iptables-chains-X">31.2.10 Apagando um chain criado pelo usuário - X</h3>

<p>
Para apagarmos um chain criado pelo usuário, usamos a seguinte sintaxe:
</p>

<p>
<samp>iptables [<em>-t tabela</em>] [<em>-X chain</em>]</samp>
</p>

<p>
Onde:
</p>
<dl>
<dt>tabela</dt>
<dd>
<p>
Nome da tabela que contém o chain que desejamos excluir.
</p>
</dd>
<dt>chain</dt>
<dd>
<p>
Nome do chain que desejamos apagar.  Caso não seja especificado, todos os
chains definidos pelo usuário na tabela especificada serão excluídos.
</p>
</dd>
</dl>

<p>
<strong>OBS:</strong> - Chains embutidos nas tabelas não podem ser apagados
pelo usuário.  Veja os nomes destes chains em <a
href="#s-fw-iptables-tabelas">O que são tabelas?, Seção 31.1.14</a>.
</p>

<pre>
      iptables -t filter -X internet
      iptables -X
</pre>

<hr>

<h3 id="s-fw-iptables-chains-Z">31.2.11 Zerando contador de bytes dos chains - Z</h3>

<p>
Este comando zera o campo <em>pkts</em> e <em>bytes</em> de uma regra do
<code>iptables</code>.  Estes campos podem ser visualizados com o comando
<code>iptables -L -v</code>.  A seguinte sintaxe é usada:
</p>

<p>
<samp>iptables [<em>-t tabela</em>] [<em>-Z chain</em>] [<em>-L</em>]</samp>
</p>

<p>
Onde:
</p>
<dl>
<dt><em>tabela</em></dt>
<dd>
<p>
Nome da tabela que contém o chain que queremos zerar os contadores de bytes e
pacotes.
</p>
</dd>
<dt><em>chain</em></dt>
<dd>
<p>
Chain que deve ter os contadores zerados.  Caso não seja especificado, todos
os chains da tabela terão os contadores zerados.  Note que as opções
<em>-Z</em> e <em>-L</em> podem ser usadas juntas, assim o chain será listado
e imediatamente zerado.  Isto evita a passagem de pacotes durante a listagem de
um chain.
</p>
</dd>
</dl>

<pre>
      iptables -t filter -Z INPUT
</pre>

<hr>

<h3 id="s-fw-iptables-chains-P">31.2.12 Especificando a política padrão de um chain - P</h3>

<p>
A política padrão determina o que acontecerá com um pacote quando ele chegar
ao final das regras contidas em um chain.  A política padrão do
<code>iptables</code> é &quot;ACCEPT&quot; mas isto pode ser alterado com o
comando:
</p>

<p>
<samp>iptables [<em>-t tabela</em>] [<em>-P chain</em>]
[<em>ACCEPT/DROP</em>]</samp>
</p>

<p>
Onde:
</p>
<dl>
<dt>tabela</dt>
<dd>
<p>
Tabela que contém o chain que desejamos modificar a política padrão.
</p>
</dd>
<dt>chain</dt>
<dd>
<p>
Define o chain que terá a política modificada.  O chain deve ser
especificado.
</p>
</dd>
<dt>ACCEPT/DROP</dt>
<dd>
<p>
ACCEPT aceita os pacotes caso nenhuma regra do chain conferir (usado em regras
permissivas).  DROP rejeita os pacotes caso nenhuma regra do chain conferir
(usado em regras restritivas).
</p>
</dd>
</dl>

<p>
A política padrão de um chain é mostrada com o comando <code>iptables
-L</code>:
</p>

<pre>
     # iptables -L INPUT
     
     Chain INPUT (policy ACCEPT)
     target     prot opt source               destination         
     DROP       icmp --  anywhere             localhost
</pre>

<p>
No exemplo acima, a política padrão de INPUT é ACCEPT (policy ACCEPT), o que
significa que qualquer pacote que não seja rejeitado pela regra do chain,
será aceito.  Para alterar a política padrão deste chain usamos o comando:
</p>

<pre>
      iptables -t filter -P INPUT DROP
</pre>

<p>
<strong>NOTA:</strong> As políticas de acesso PERMISSIVASS (ACCEPT)
normalmente são usadas em conjunto com regras restritivas no chain
correspondentes (tudo é bloqueado e o que sobrar é liberado) e políticas
RESTRITIVAS (DROP) são usadas em conjunto com regras permissivas no chain
correspondente (tudo é liberado e o que sobrar é bloqueado pela política
padrão).
</p>

<hr>

<h2 id="s-fw-iptables-outras">31.3 Outras opções do iptables</h2>

<hr>

<h3 id="s-fw-iptables-outras-endOD">31.3.1 Especificando um endereço de origem/destino</h3>

<p>
As opções <samp>-s</samp> (ou --src/--source)e <samp>-d</samp> (ou
--dst/--destination) servem para especificar endereços de <em>origem</em> e
<em>destino</em> respectivamente.  É permitido usar um endereço IP completo
(como 192.168.1.1), um hostname (debian), um endereço fqdn (www.debian.org) ou
um par <em>rede/máscara</em> (como 200.200.200.0/255.255.255.0 ou
200.200.200.0/24).
</p>

<p>
Caso um endereço/máscara não sejam especificados, é assumido <em>0/0</em>
como padrão (todos as máquinas de todas as redes).  A interpretação dos
endereços de origem/destino dependem do chain que está sendo especificado
(como INPUT e OUTPUT por exemplo).
</p>

<p>
<strong>OBS:</strong> Caso seja especificado um endereço fqdn e este resolver
mais de um endereço IP, serão criadas várias regras, cada uma se aplicando a
este endereço IP específico.  É recomendável sempre que possível a
especificação de endereços IP's nas regras, pois além de serem muito
rápidos (pois não precisar de resolução DNS) são mais seguros para evitar
que nosso firewall seja enganado por um ataque de IP spoofing.
</p>

<pre>
     # Bloqueia o tráfego vindo da rede 200.200.200.*:
      iptables -A INPUT -s 200.200.200.0/24 -j DROP
     
     # Bloqueia conexões com o destino 10.1.2.3:
     iptables -A OUTPUT -d 10.1.2.3 -j DROP
     
     # Bloqueia o tráfego da máquina www.dominio.teste.org a rede 210.21.1.3
     # nossa máquina possui o endereço 210.21.1.3
     iptables -A INPUT -s www.dominio.teste.org -d 210.21.1.3 -j DROP
</pre>

<hr>

<h3 id="s-fw-iptables-outras-iface">31.3.2 Especificando a interface de origem/destino</h3>

<p>
As opções <em>-i</em> (ou --in-interface) e <em>-o</em> (ou --out-interface)
especificam as interfaces de origem/destino de pacotes.  Nem todos as chains
aceitam as interfaces de origem/destino simultaneamente, a interface de entrada
(-i) nunca poderá ser especificada em um chain OUTPUT e a interface de saída
(-o) nunca poderá ser especificada em um chain INPUT.  Abaixo uma rápida
referência:
</p>

<pre>
     
               +---------------------+--------------------------------+
       TABELA  |      CHAIN          |            INTERFACE           |
               |                     +----------------+---------------+
               |                     |  ENTRADA (-i)  |    SAÍDA (-o) |
     +---------+---------------------+----------------+---------------+
     |         |  INPUT              |      SIM       |      NÃO      |
     | filter  |  OUTPUT             |      NÃO       |      SIM      |
     |         |  FORWARD            |      SIM       |      SIM      |
     +---------+---------------------+----------------+---------------+
     |         | PREROUTING          |      SIM       |      NÃO      |
     | nat     | OUTPUT              |      NÃO       |      SIM      |
     |         | POSTROUTING         |      NÃO       |      SIM      |
     +---------+---------------------+----------------+---------------+
     |         | PREROUTING          |      SIM       |      NÃO      |
     | mangle  |                     |                |               |
     |         | OUTPUT              |      NÃO       |      SIM      |
     +---------+---------------------+----------------+---------------+
</pre>

<p>
O caminho do pacote na interface será determinado pelo tipo da interface e
pela posição dos chains nas etapas de seu roteamento.  O chain OUTPUT da
tabela filter somente poderá conter a interface de saída (veja a tabela
acima).  O chain FORWARD da tabela filter é o único que aceita a
especificação de ambas as interfaces, este é um ótimo chain para controlar
o tráfego que passa entre interfaces do firewall.
</p>

<p>
Por exemplo para bloquear o acesso do tráfego de qualquer máquina com o
endereço 200.123.123.10 vinda da interface ppp0 (uma placa de fax-modem):
</p>

<pre>
     iptables -A INPUT -s 200.123.123.10 -i ppp0 -j DROP
</pre>

<p>
A mesma regra pode ser especificada como
</p>

<pre>
     iptables -A INPUT -s 200.123.123.10 -i ppp+ -j DROP
</pre>

<p>
O sinal de &quot;+&quot; funciona como um coringa, assim a regra terá efeito
em qualquer interface de ppp0 a ppp9.  As interfaces ativas no momento podem
ser listadas com o comando <code>ifconfig</code>, mas é permitido especificar
uma regra que faz referência a uma interface que ainda não existe, isto é
interessante para conexões intermitentes como o PPP.  Para bloquear qualquer
tráfego local para a Internet:
</p>

<pre>
     iptables -A OUTPUT -o ppp+ -j DROP
</pre>

<p>
Para bloquear a passagem de tráfego da interface ppp0 para a interface eth1
(de uma de nossas redes internas):
</p>

<pre>
     iptables -A FORWARD -i ppp0 -o eth1 -j DROP
</pre>

<hr>

<h3 id="s-fw-iptables-outras-proto">31.3.3 Especificando um protocolo</h3>

<p>
A opção <samp>-p</samp> (ou --protocol) é usada para especificar protocolos
no <code>iptables</code>.  Podem ser especificados os protocolos <em>tcp</em>,
<em>udp</em> e <em>icmp</em>.  Por exemplo, para rejeitar todos os pacotes UDP
vindos de 200.200.200.200:
</p>

<pre>
      iptables -A INPUT -s 200.200.200.200 -p udp -j DROP
</pre>

<p>
<strong>OBS1:</strong> Tanto faz especificar os nomes de protocolos em
maiúsculas ou minúsculas.
</p>

<hr>

<h4 id="s-fw-iptables-outras-proto-p">31.3.3.1 Especificando portas de origem/destino</h4>

<p>
As portas de origem/destino devem ser especificadas após o protocolo e podem
ser precedidas por uma das seguintes opções:
</p>
<ul>
<li>
<p>
<samp>--source-port ou --sport</samp> - Especifica uma porta ou faixa de portas
de origem.
</p>
</li>
<li>
<p>
<samp>--destination-port ou --dport</samp> - Especifica uma porta ou faixa de
portas de destino.
</p>
</li>
</ul>

<p>
Uma faixa de portas pode ser especificada através de
<samp>PortaOrigem:PortaDestino</samp>:
</p>

<pre>
     # Bloqueia qualquer pacote indo para 200.200.200.200 na faixa de 
     # portas 0 a 1023
     iptables -A OUTPUT -d 200.200.200.200 -p tcp --dport :1023 -j DROP
</pre>

<p>
Caso a <em>PortaOrigem</em> de uma faixa de portas não seja especificada, 0 é
assumida como padrão, caso a <em>Porta Destino</em> não seja especificada,
65535 é assumida como padrão.  Caso precise especificar diversas regras que
envolvam o tratamento de portas diferentes, recomendo da uma olhada em <a
href="#s-fw-iptables-mod-multiport">Especificando múltiplas portas de
origem/destino, Seção 31.6.6</a>, antes de criar um grande número de regras.
</p>

<hr>

<h4 id="s-fw-iptables-outras-proto-micmp">31.3.3.2 Especificando mensagens do protocolo ICMP</h4>

<p>
O protocolo ICMP não possui portas, mas é possível fazer um controle maior
sobre o tráfego ICMP que entra/sai da rede através da especificação dos
tipos de mensagens ICMP.  Os tipos de mensagens devem ser especificados com a
opção &quot;--icmp-type <em>CódigoICMP</em>&quot; logo após a
especificação do protocolo icmp:
</p>

<pre>
     iptables -A INPUT -s 200.123.123.10 -p icmp --icmp-type time-exceeded -i ppp+ -j DROP
</pre>

<p>
A regra acima rejeitará mensagens ICMP do tipo &quot;time-exceeded&quot;
(tempo de requisição excedido) que venham do endereço 200.123.123.10
através da interface <em>ppp+</em>.
</p>

<p>
Alguns tipos de mensagens ICMP são classificados por categoria (como o
próprio &quot;time-exceeded&quot;), caso a categoria &quot;time-exceeded&quot;
seja especificada, todas as mensagens daquela categoria (como
&quot;ttl-zero-during-transit&quot;, &quot;ttl-zero-during-reassembly&quot;)
conferirão na regra especificada.Os tipos de mensagens ICMP podem ser obtidos
com o comando <samp>iptables -p icmp -h</samp>:
</p>

<pre>
     echo-reply (pong)
     destination-unreachable
        network-unreachable
        host-unreachable
        protocol-unreachable
        port-unreachable
        fragmentation-needed
        source-route-failed
        network-unknown
        host-unknown
        network-prohibited
        host-prohibited
        TOS-network-unreachable
        TOS-host-unreachable
        communication-prohibited
        host-precedence-violation
        precedence-cutoff
     source-quench
     redirect
        network-redirect
        host-redirect
        TOS-network-redirect
        TOS-host-redirect
     echo-request (ping)
     router-advertisement
     router-solicitation
     time-exceeded (ttl-exceeded)
        ttl-zero-during-transit
        ttl-zero-during-reassembly
     parameter-problem
        ip-header-bad
        required-option-missing
     timestamp-request
     timestamp-reply
     address-mask-request
     address-mask-reply
</pre>

<p>
<strong>OBS1:</strong> Não bloqueie mensagens do tipo
&quot;host-unreachable&quot; e &quot;source-quench&quot;, pois terá sérios
problemas no controle de suas conexões.  A primeira diz que o destino está
inalcançavel e a segunda que o host está sobrecarregado, assim os pacotes
devem ser enviados mais lentamente.
</p>

<hr>

<h4 id="s-fw-iptables-outras-proto-syn">31.3.3.3 Especificando pacotes syn</h4>

<p>
Pacotes syn são usados para iniciarem uma conexão, o uso da opção --syn
serve para especificar estes tipos de pacotes.  Desta maneira é possível
bloquear somente os pacotes que iniciam uma conexão, sem afetar os pacotes
restantes.  Para que uma conexão ocorra é necessário que a máquina obtenha
a resposta a pacotes syn enviados, caso ele seja bloqueado a resposta nunca
será retornada e a conexão não será estabelecida.
</p>

<pre>
     iptables -A INPUT -p tcp --syn --dport 23 -i ppp+ -j DROP
</pre>

<p>
A regra acima bloqueia (-j DROP) qualquer tentativa de conexão (--syn) vindas
da interface ppp+ ao telnet (--dport 23) da máquina local, conexões já
efetuadas ão são afetadas por esta regra.  A opção --syn somente pode ser
especificada para o protocolo tcp.
</p>

<p>
<strong>ATENÇÃO:</strong> - A situação de passagem de pacotes durante deve
ser levada em conta durante a inicialização do firewall, bloqueando a
passagem de pacotes durante o processo de configuração, criando regras que
bloqueiam a passagem de pacotes (exceto para a interface loopback) até que a
configuração do firewall esteja completa, pode ser uma solução eficiente.
</p>

<p>
Outra alternativa segura é configurar as regras de firewall antes das
interfaces de rede se tornarem ativas (usando a opção &quot;pre-up
comando_firewall&quot; no arquivo de configuração
<code>/etc/network/interfaces</code> em sistemas <code>Debian</code>.
</p>

<hr>

<h3 id="s-fw-iptables-outras-fragmentos">31.3.4 Especificando fragmentos</h3>

<p>
A opção &quot;-f&quot; (ou --fragment) permite especificar regras que
confiram com fragmentos.  Fragmentos são simplesmente um pacote maior dividido
em pedaços para poder ser transmitido via rede TCP/IP para remontagem do
pacote pela máquina de destino.
</p>

<p>
Somente o primeiro fragmento possui detalhes de cabeçalho para ser processado,
os segundos e seguintes somente possuem alguns cabeçalhos necessários para
dar continuidade ao processo de remontagem do pacote no destino.
</p>

<p>
Uma regra como
</p>

<pre>
     iptables -A INPUT -s 200.200.200.1 -f -j DROP
</pre>

<p>
derrubará os fragmentos de 200.200.200.1 derrubará o segundo pacote e pacotes
seguintes enviados por 200.200.200.1 até nós.
</p>

<p>
<strong>OBS1:</strong> Note que se o cabeçalho do pacote não tiver detalhes
suficientes para checagem de regras no <code>iptables</code>, a regra
simplesmente não ira conferir.
</p>

<p>
<strong>OBS2:</strong> Não é preciso especificar a opção &quot;-f&quot;
para conexões NAT, pois os pacotes são remontados antes de entrarem no
código de filtragem.
</p>

<p>
<strong>OBS3:</strong> A opção &quot;-f&quot; também pode ser usada para
evitar o flood por fragmentos (bomba de fragmentos) que, dependendo da
intensidade, podem até travar a máquina.
</p>

<hr>

<h3 id="s-fw-iptables-outras-excessoes">31.3.5 Especificando uma exceção</h3>

<p>
Muitos parâmetros (como o endereço de origem/destino, protocolo, porta,
mensagens ICMP, fragmentos, etc) podem ser precedidos pelo sinal &quot;!&quot;
que significa exceção.  Por exemplo:
</p>

<pre>
     iptables -t filter -A INPUT ! -s 200.200.200.10 -j DROP
</pre>

<p>
Diz para rejeitar todos os pacotes EXCETO os que vem do endereço
<code>200.200.200.10</code>.
</p>

<pre>
     iptables -A INPUT -p tcp ! --syn -s 200.200.200.10 ! -i eth0 -j DROP
</pre>

<p>
Diz para bloquear todos os pacotes EXCETO os que iniciam conexões (!  --syn),
EXCETO para pacotes vindos pela interface eth0 (!  -i eth0).
</p>

<pre>
     iptables -A INPUT -s 200.200.200.10 ! -p tcp -j DROP
</pre>

<p>
Bloqueia todos os pacotes vindos de 200.200.200.10, EXCETO os do protocolo tcp.
</p>

<hr>

<h3 id="s-fw-iptables-outras-alvo">31.3.6 Especificando um alvo</h3>

<p>
O alvo (-j) é o destino que um pacote terá quando conferir com as condições
de uma regra, um alvo pode dizer para bloquear a passagem do pacote (-j DROP),
aceitar a passagem do pacote (-j ACCEPT), registrar o pacote no sistema de log
(-j LOG), rejeitar o pacote (-j REJECT), redirecionar um pacote -j REDIRECT,
retornar ao chain anterior sem completar o processamento no chain atual (-j
RETURN), passar para processamento de programas externos (-j QUEUE), fazer
source nat (-j SNAT), destination nat (-j DNAT), etc.  Podem existir mais
alvos, pois o <code>iptables</code> é modularizável, e módulos que
acrescentam mais funções podem ser carregados em adição aos já existentes
no kernel.
</p>

<p>
Nos exemplos anteriores vimos o uso de diversos alvos como o DROP e o ACCEPT.
Apenas farei uma breve referência sobre os alvos mais usados em operações
comuns dos chains.  Os alvos REDIRECT, SNAT e DNAT serão explicados em uma
seção seguinte:
</p>
<dl>
<dt>ACCEPT</dt>
<dd>
<p>
O pacote é ACEITO e o processamento das regras daquele chains é concluído.
Pode ser usado como alvo em todos os chains de todas as tabelas do
<code>iptables</code> e também pode ser especificado na política padrão das
regras do firewall (veja <a href="#s-fw-iptables-chains-P">Especificando a
política padrão de um chain - P, Seção 31.2.12</a>).
</p>
</dd>
<dt>DROP</dt>
<dd>
<p>
Rejeita o pacote e o processamento das regras daquele chain é concluído.
Pode ser usado como alvo em todos os chains de todas as tabelas do
<code>iptables</code> e também pode ser especificado na política padrão das
regras do firewall (veja <a href="#s-fw-iptables-chains-P">Especificando a
política padrão de um chain - P, Seção 31.2.12</a>).
</p>
</dd>
<dt>REJECT</dt>
<dd>
<p>
Este é um módulo opcional que faz a mesma função do alvo <em>DROP</em> com
a diferença de que uma mensagem ICMP do tipo &quot;icmp-port-unreachable&quot;
(TCP/UDP) ou &quot;host-unreachable&quot; (ICMP) é retornada para a máquina
de origem.  Pode ser usado como alvo somente nos chains da tabela (não como
política padrão).
</p>
</dd>
<dt>LOG</dt>
<dd>
<p>
Este módulo envia uma mensagem ao <code>syslog</code> caso a regra confira, o
processamento continua normalmente para a próxima regra (o pacote não é nem
considerado ACEITO ou REJEITADO).
</p>
</dd>
<dt>RETURN</dt>
<dd>
<p>
Retorna o processamento do chain anterior sem processar o resto do chain atual.
</p>
</dd>
<dt>QUEUE</dt>
<dd>
<p>
Passa o processamento para um programa a nível de usuário.
</p>
</dd>
</dl>

<hr>

<h4 id="s-fw-iptables-outras-alvo-REJECT">31.3.6.1 Alvo REJECT</h4>

<p>
Para ser usado, o módulo <code>ipt_REJECT</code> deve ser compilado no kernel
ou como módulo.  Este alvo rejeita o pacote (como o <em>DROP</em>) e envia uma
mensagem ICMP do tipo &quot;icmp-port-unreachable&quot; como padrão para a
máquina de origem.
</p>

<p>
É um alvo interessante para bloqueio de portas TCP, pois em alguns casos da a
impressão que a máquina não dispõe de um sistema de firewall (o alvo DROP
causa uma parada de muito tempo em alguns portscanners e tentativas de conexão
de serviços, revelando imediatamente o uso de um sistema de firewall pela
máquina).  O alvo REJECT vem dos tempos do ipchains e somente pode ser usado
na tabela <em>filter</em>.  Quando um pacote confere, ele é rejeitado com a
mensagem ICMP do tipo &quot;port unreachable&quot;, é possível especificar
outro tipo de mensagem ICMP com a opção <em>--reject-with tipo_icmp</em>.
</p>

<p>
<strong>OBS:</strong> REJECT pode ser usado somente como alvo na tabela filter
e não é possível especifica-lo como política padrão do chain filter (como
acontecia no <code>ipchains</code>.  Uma forma alternativa é inserir como
última regra uma que pegue todos os pacotes restantes daquele chain e tenha
como alvo REJECT (como <samp>iptables -A INPUT -j REJECT</samp>), desta forma
ele nunca atingirá a política padrão do chain.
</p>

<pre>
     # Rejeita pacotes vindos de 200.200.200.1 pela interface ppp0: 
     iptables -A INPUT -s 200.200.200.1 -i ppp+ -j REJECT
</pre>

<hr>

<h4 id="s-fw-iptables-outras-alvo-LOG">31.3.6.2 Especificando LOG como alvo</h4>

<p>
Este alvo é usado para registrar a passagem de pacotes no <code>syslog</code>
do sistema.  É um alvo muito interessante para ser usado para regras que
bloqueiam determinados tráfegos no sistema (para que o administrador tome
conhecimento sobre tais tentativas), para regras de fim de chain (quando você
tem um grande conjunto de regras em um firewall restritivo e não sabe onde
suas regras estão sendo bloqueadas), para satisfazer sua curiosidade, etc.
</p>

<pre>
     # Para registrar o bloqueio de pacotes vindos de 200.200.200.1 pela interface ppp0
     iptables -A INPUT -s 200.200.200.1 -i ppp+ -j LOG
     # Para efetuar o bloqueio
     iptables -A INPUT -s 200.200.200.1 -i ppp+ -j REJECT
</pre>

<p>
Note que no exemplo anterior a regra que registra o pacote (-j LOG) deve
aparecer antes da regra que REJEITA (-j REJECT), caso contrário a regra de LOG
nunca funcionará.  A regra que REJEITA poderia também ser trocada por uma
regra que ACEITA, caso queira registrar um pacote que deve ser aceito (se a
política padrão do seu firewall for restritiva (-P DROP).  A única coisa que
muda nas regras de log é o alvo da regra, isto facilita a implementação de
grandes conjuntos de regras de firewall.
</p>

<p>
A regra acima mostrará a seguinte saída no <code>syslog</code> do sistema:
</p>

<pre>
     Aug 25 10:08:01 debian kernel: IN=ppp0 OUT= MAC=10:20:30:40:50:60:70:80:90:00:00:00:08:00 SRC=200.200.200.1 DST=200.210.10.10 LEN=61 TOS=0x00 PREC=0x00 TTL=64 ID=0 DF PROTO=UDP SPT=1031 DPT=53 LEN=41
</pre>

<p>
Os campos possuem o seguinte significado:
</p>
<dl>
<dt>Aug 25 10:08:01</dt>
<dd>
<p>
Mês, dia e hora do registro do pacote.
</p>
</dd>
<dt>debian</dt>
<dd>
<p>
Nome do computador que registrou o pacote.
</p>
</dd>
<dt>kernel:</dt>
<dd>
<p>
Daemon que registrou a mensagem, no caso o <code>iptables</code> faz parte do
próprio kernel.
</p>
</dd>
<dt>IN=ppp0</dt>
<dd>
<p>
Especifica a interface de entrada (de onde o pacote veio).
</p>
</dd>
<dt>OUT=</dt>
<dd>
<p>
Especifica a interface de saída (para onde o pacote foi).
</p>
</dd>
<dt>MAC=10:20:30:40:50:60:70:80:90:00:00:00:08:00</dt>
<dd>
<p>
Endereço mac da interface de rede (pode ser obtido com <samp>arp
interface</samp>).
</p>
</dd>
<dt>SRC=200.200.200.1</dt>
<dd>
<p>
Endereço de origem do pacote.
</p>
</dd>
<dt>DST=200.210.10.10</dt>
<dd>
<p>
Endereço de destino do pacote.
</p>
</dd>
<dt>SEQ=234234343</dt>
<dd>
<p>
Número de seqüência da recepção.  É ativado com a opção
<em>--log-tcp-sequence</em>.
</p>
</dd>
<dt>LEN=61</dt>
<dd>
<p>
Tamanho em bytes do pacote IP.
</p>
</dd>
<dt>TOS=0x00</dt>
<dd>
<p>
Prioridade do cabeçalho TOS (Tipo).  Veja a seção <a
href="#s-fw-iptables-mangle-TOS">Especificando o tipo de serviço, Seção
31.5.1</a> para mais detalhes.
</p>
</dd>
<dt>PREC=0x00</dt>
<dd>
<p>
Prioridade do cabeçalho TOS (Precedência).  Veja a seção <a
href="#s-fw-iptables-mangle-TOS">Especificando o tipo de serviço, Seção
31.5.1</a> para mais detalhes.
</p>
</dd>
<dt>TTL=64</dt>
<dd>
<p>
Tempo de vida do pacote.  No exemplo, 64 roteadores (hops).
</p>
</dd>
<dt>ID=0</dt>
<dd>
<p>
Identificação única destes datagrama.  Esta identificação também é usada
pelos fragmentos seguintes deste pacote.
</p>
</dd>
<dt>DF</dt>
<dd>
<p>
Opção &quot;Don't fragment&quot; (não fragmentar) do pacote.  Usada quando o
pacote é pequeno o bastante para não precisar ser fragmentado.
</p>
</dd>
<dt>MF</dt>
<dd>
<p>
Opção &quot;More Fragments&quot; (mais fragmentos) estão para ser recebidos.
</p>
</dd>
<dt>FRAG=100</dt>
<dd>
<p>
Tamanho do fragmento especificado em pacotes de 8 bits.  No exemplo acima, o
pacote tem o tamanho de 800 bytes (100*8).
</p>
</dd>
<dt>PROTO=UDP</dt>
<dd>
<p>
Nome do protocolo.  Pode ser TCP, UDP ou ICMP
</p>
</dd>
<dt>SPT=1031</dt>
<dd>
<p>
Porta de origem da requisição.
</p>
</dd>
<dt>DPT=53</dt>
<dd>
<p>
Porta de destino da requisição.
</p>
</dd>
<dt>LEN=41</dt>
<dd>
<p>
Tamanho do pacote.
</p>
</dd>
</dl>

<p>
O log acima mostra uma consulta DNS (porta destino 53) para nossa máquina
(INPUT) de 200.200.200.1 para 200.210.10.10.
</p>

<p>
O problema é que em um grande número de regras será difícil saber qual
regra conferiu (pois teríamos que analisar o endereço/porta origem/destino) e
o destino do pacote (se ele foi ACEITO ou BLOQUEADO) pois você pode ter regras
para ambas as situações.  Por este motivo existem algumas opções úteis que
podemos usar com o alvo LOG:
</p>
<dl>
<dt>--log-prefix &quot;descrição&quot;</dt>
<dd>
<p>
Permite especificar uma descrição para a regra do firewall de até 29
caracteres.  Caso tiver espaços, devem ser usadas &quot;aspas&quot;.
</p>
</dd>
<dt>--log-level nível</dt>
<dd>
<p>
Especifica o nível da mensagem no <code>syslog</code>.
</p>
</dd>
<dt>--log-tcp-options</dt>
<dd>
<p>
Registra campos do cabeçalho TCP nos logs do sistema.
</p>
</dd>
<dt>--log-ip-options</dt>
<dd>
<p>
Registra campos do cabeçalho IP nos logs do sistema
</p>
</dd>
<dt>--log-tcp-sequence</dt>
<dd>
<p>
Registra os números de seqüencia TCP.  Evite ao máximo o uso desta opção,
pois a seqüencia de números TCP pode ser a chave para um seqüestro de
seção ou IP spoofing em seu sistema caso algum usuário tenha acesso a estes
logs.  Caso utilize tcp/ip em servidores públicos, o uso desta opção
ajudará a entender bem os ataques DoS causados por syn-flood e porque ativar
os SynCookies (veja <a href="#s-fw-iptables-mod-limit-synflood">Proteção
contra syn flood, Seção 31.6.4</a>).
</p>
</dd>
</dl>

<p>
<strong>OBS1:</strong>Lembre-se que estas opções são referentes ao alvo LOG
e devem ser usadas após este, caso contrário você terá um pouco de trabalho
para analisar e consertar erros em suas regras do firewall.
</p>

<p>
<strong>OBS2:</strong>Caso esteja usando o firewall em um servidor público,
recomendo associar um limite a regra de log, pois um ataque poderia causar um
DoS enchendo sua partição.  Leia mais sobre isso em <a
href="#s-fw-iptables-mod-limit">Limitando o número de vezes que a regra
confere, Seção 31.6.2</a>.
</p>

<pre>
     # Complementando o exemplo anterior:
     # Para registrar o bloqueio de pacotes vindos de 200.200.200.1 pela interface ppp0
     iptables -A INPUT -s 200.200.200.1 -i ppp+ -j LOG --log-prefix &quot;FIREWALL: Derrubado &quot;
     # Para efetuar o bloqueio
     iptables -A INPUT -s 200.200.200.1 -i ppp+ -j REJECT
</pre>

<p>
Retornará a seguinte mensagem no syslog:
</p>

<pre>
     Aug 25 10:08:01 debian kernel: FIREWALL: Derrubado IN=ppp0 OUT= MAC=10:20:30:40:50:60:70:80:90:00:00:00:08:00 SRC=200.200.200.1 DST=200.210.10.10 LEN=61 TOS=0x00 PREC=0x00 TTL=64 ID=0 DF PROTO=UDP SPT=1031 DPT=53 LEN=41
</pre>

<p>
Agora você sabe o que aconteceu com o pacote (Rejeitado).  A padronização de
mensagens de firewall é também importante para a criação de scripts de
análise que poderão fazer a análise dos logs do seu firewall (para criação
de estatísticas que podem servir como base para a criação de novas regras de
firewall ou eliminação de outras).
</p>

<p>
<strong>OBS:</strong> Se você sente falta da função &quot;-l&quot; do
<code>ipchains</code> que combina o alvo e log na mesma regra você pode criar
um alvo como o seguinte:
</p>

<pre>
     iptables -N log-drop
     iptables -A log-drop -j LOG
     iptables -A log-drop -j DROP
</pre>

<p>
E usar &quot;log-drop&quot; como alvo em suas regras.  Mesmo assim esta
solução é &quot;limitada&quot; em relação a &quot;-l&quot; do
<code>ipchains</code> porque o <code>iptables</code> não inclui detalhes de
qual chain bloqueou o pacote/qual pacote foi bloqueado, assim é necessário a
especificação da opção <em>--log-prefix</em> para as mensagens se tornarem
mais compreensíveis.  Esta limitação pode ser contornada utilizando um
firewall feito em linguagem shell script, desta forma você terá um controle
maior sobre o seu programa usando funções e integração com outros
utilitários.
</p>

<hr>

<h4 id="s-fw-iptables-outras-alvo-RETURN">31.3.6.3 Especificando RETURN como alvo</h4>

<p>
O alvo RETURN diz ao <code>iptables</code> interromper o processamento no chain
atual e retornar o processamento ao chain anterior.  Ele é útil quando
criamos um chain que faz um determinado tratamento de pacotes, por exemplo
bloquear conexões vindas da internet para portas baixas, exceto para um
endereço IP específico.  Como segue:
</p>

<pre>
     1-) iptables -t filter -A INPUT -i ppp0 -j internet
     2-) iptables -t filter -j ACCEPT
     3-) iptables -t filter -N internet
     4-) iptables -t filter -A internet -s www.debian.org -p tcp --dport 80 -j RETURN
     5-) iptables -t filter -A internet -p tcp --dport 21 -j DROP
     6-) iptables -t filter -A internet -p tcp --dport 23 -j DROP
     7-) iptables -t filter -A internet -p tcp --dport 25 -j DROP
     8-) iptables -t filter -A internet -p tcp --dport 80 -j DROP
</pre>

<p>
Quando um pacote com o endereço <code>www.debian.org</code> tentando acessar a
porta www (80) de nossa máquina através da internet (via interface ppp0), o
chain número 1 confere, então o processamento continua no chain número 4, o
chain número 4 confere então o processamento volta para a regra número 2,
que diz para aceitar o pacote.
</p>

<p>
Agora se um pacote vem com o endereço <code>www.dominio.com.br</code> tentando
acessar a porta www *80) de nossa máquina através da internet (via interface
ppp0), o chain número 1 confere, então o processamento continua no chain
número 4, que não confere.  O mesmo acontece com os chains 5, 6 e 7.  O chain
número 8 confere, então o acesso é bloqueado.
</p>

<p>
Como pode notou, o alvo RETURN facilita bastante a construção das regras do
seu firewall, caso existam máquinas/redes que sejam exceções as suas regras.
Se ela não existisse, seria necessário especificar diversas opções -s, -d,
etc para poder garantir o acesso livre a determinadas máquinas.
</p>

<hr>

<h3 id="s-fw-iptables-outras-save-restore">31.3.7 Salvando e Restaurando regras</h3>

<p>
As regras que você está trabalhosamente criando e testando manualmente
enquanto manipula o <code>iptables</code> podem ser salvas de 2 formas; uma
delas é escrevendo um shell script que tenha todos os comandos, um por linha.
Isto é recomendado quando tem um firewall grande e que exige uma boa
padronização de regras, bem como sua leitura, comentários.  O script shell
também permite o uso de funções presente no interpretador de comando,
portanto se você é uma pessoa que gosta de interagir com as funções do
shell e deixar as coisas mais flexíveis, prefira esta opção.
</p>

<p>
A outra forma é usando as ferramentas <code>iptables-save</code> e
<code>iptables-restore</code> baseada na idéia do <code>ipchains-save</code> e
<code>ipchains-restore</code>.  O <code>iptables-save</code> deve ser usado
sempre que modificar regras no firewall iptables da seguinte forma:
</p>

<pre>
     iptables-save &gt;/dir/iptables-regras
</pre>

<p>
Uma das vantagens do uso do <code>iptables-save</code> é ele também salvar os
contadores de chains, ou seja, a quantidade de pacotes que conferiram com a
regra.  Isto também pode ser feito com algumas regras adicionais em seu shell
script, caso tenha interesse nesses contadores para estatísticas ou outros
tipos de relatórios.
</p>

<p>
Para restaurar as regras salvas, utilize o comando:
</p>

<pre>
     iptables-restore &lt;/dir/iptables-regras
</pre>

<hr>

<h2 id="s-fw-iptables-nat">31.4 A tabela nat (Network Address Translation) - fazendo nat</h2>

<p>
A tabela <em>nat</em> serve para controlar a tradução dos endereços que
atravessam o código de roteamento da máquina <code>Linux</code>.  Existem 3
chains na tabela <em>nat</em>: <em>PREROUTING</em>, <em>OUTPUT</em> e
<em>POSTROUTING</em> (veja <a href="#s-fw-iptables-tabelas">O que são
tabelas?, Seção 31.1.14</a> para maiores detalhes).
</p>

<p>
A tradução de endereços tem inúmeras utilidades, uma delas é o
Masquerading, onde máquinas de uma rede interna podem acessar a Internet
através de uma máquina <code>Linux</code>, redirecionamento de porta, proxy
transparente, etc.  Esta seção abordará os tipos de NAT, exemplos de como
criar rapidamente uma conexão IP masquerading e entender como a tradução de
endereços funciona no <code>iptables</code>.
</p>

<p>
Se sua intenção é ligar sua rede a Internet existem duas opções:
</p>
<ul>
<li>
<p>
Você possui uma conexão que lhe oferece um endereço IP dinâmico (a cada
conexão é dado um endereço IP - como uma conexão PPP) então o IP
masquerading é o que precisa (veja <a
href="#s-fw-iptables-nat-fastmasquerade">Fazendo IP masquerading (para os
apressados), Seção 31.4.2</a> ou <a
href="#s-fw-iptables-nat-snat-masquerade">Fazendo IP Masquerading, Seção
31.4.3.1</a>).
</p>
</li>
<li>
<p>
Você tem uma conexão que lhe oferece um endereço IP permanente (ADSL, por
exemplo) então o SNAT é o que precisa (veja <a
href="#s-fw-iptables-nat-snat">Fazendo SNAT, Seção 31.4.3</a>).
</p>
</li>
</ul>

<hr>

<h3 id="s-fw-iptables-nat-N">31.4.1 Criando um novo chain na tabela NAT</h3>

<p>
O procedimento para criação de um novo chain nesta tabela é o mesmo descrito
em <a href="#s-fw-iptables-chains-N">Criando um novo chain - N, Seção
31.2.6</a> será necessário somente especificar a tabela nat (-t nat) para que
o novo chain não seja criado na tabela padrão (-t filter).
</p>

<pre>
     iptables -t nat -N intra-inter
</pre>

<p>
Que criará o chain chamado <em>intra-inter</em> na tabela <em>nat</em>.  Para
inserir regras neste chain será necessário especificar a opção &quot;-t
nat&quot;.
</p>

<hr>

<h3 id="s-fw-iptables-nat-fastmasquerade">31.4.2 Fazendo IP masquerading (para os apressados)</h3>

<p>
Você precisará de um kernel com suporte ao <code>iptables</code> (veja <a
href="#s-fw-iptables-supkernel">Habilitando o suporte ao iptables no kernel,
Seção 31.1.15</a> e <code>ip_forward</code> e então digitar os dois comandos
abaixo para habilitar o masquerading para todas as máquinas da rede
192.168.1.*:
</p>

<pre>
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j MASQUERADE
     echo &quot;1&quot; &gt;/proc/sys/net/ipv4/ip_forward
</pre>

<p>
A configuração do servidor <code>Linux</code> está completa, agora os
clientes da rede precisarão ser configurados para usar o endereço IP do
servidor <code>Linux</code> como gateway.  É recomendável instalar um
servidor proxy e DNS na máquina <code>Linux</code> para acelerar o desempenho
das requisições/resolução de nomes das máquinas em rede.  A utilização
de bits TOS também pode trazer um grande aumento de velocidade para os
diferentes serviços da rede (veja <a
href="#s-fw-iptables-mangle-TOS">Especificando o tipo de serviço, Seção
31.5.1</a>).
</p>

<hr>

<h3 id="s-fw-iptables-nat-snat">31.4.3 Fazendo SNAT</h3>

<p>
SNAT (source nat - nat no endereço de origem) consiste em modificar o
endereço de origem das máquinas clientes antes dos pacotes serem enviados.  A
máquina roteadora é inteligente o bastante para lembrar dos pacotes
modificados e reescrever os endereços assim que obter a resposta da máquina
de destino, direcionando os pacotes ao destino correto.  Toda operação de
SNAT é feita no chain <em>POSTROUTING</em>.
</p>

<p>
É permitido especificar endereços de origem/destino, protocolos, portas de
origem/destino, interface de entrada/saída (dependendo do chain), alvos, etc.
É desnecessário especificar fragmentos na tabela nat, pois eles serão
remontados antes de entrar no código de roteamento.
</p>

<p>
O SNAT é a solução quando você tem acesso a internet através de um único
IP e deseja fazer que sua rede tenha acesso a Internet através da máquina
<code>Linux</code>.  Nenhuma máquina da Internet poderá ter acesso direto as
máquinas de sua rede interna via SNAT.
</p>

<p>
<strong>OBS:</strong> A observação acima não leva em conta o controle de
acesso externo configurado na máquina que estiver configurando o
<code>iptables</code>, uma configuração mau realizada pode expor sua máquina
a acessos externos indesejados e comprometer sua rede interna caso alguém
consiga acesso direto ao servidor.
</p>

<p>
É necessário especificar SNAT como alvo (-j SNAT) quando desejar que as
máquinas de sua rede interna tenha acesso a Internet através do IP fixo da
máquina <code>Linux</code> (para conexões intermitentes como PPP, veja <a
href="#s-fw-iptables-nat-snat-masquerade">Fazendo IP Masquerading, Seção
31.4.3.1</a>).  O parâmetro <samp>--to IP:portas</samp> deve ser usado após o
alvo SNAT.  Ele serve para especificar um endereço IP, faixa de endereços e
opcionalmente uma porta ou faixa de portas que será substituída.  Toda a
operação de SNAT é realizada através do chain POSTROUTING:
</p>

<pre>
     # Modifica o endereço IP dos pacotes vindos da máquina 192.168.1.2 da rede interna 
     # que tem como destino a interface eth1 para 200.200.217.40 (que é o nosso endereço 
     # IP da interface ligada a Internet). 
     iptables -t nat -A POSTROUTING -s 192.168.1.2 -o eth1 -j SNAT --to 200.200.217.40
</pre>

<p>
Os pacotes indo para a Internet (nossa conexão é feita via eth1, nossa
interface externa) vindo do endereço 192.168.1.2, são substituídos por
200.241.200.40 e enviados para fora.  Quando a resposta a requisição é
retornada, a máquina com <code>iptables</code> recebe os pacotes e faz a
operação inversa, modificando o endereço 200.241.200.40 novamente para
192.168.1.2 e enviando a resposta a máquina de nossa rede interna.  Após
definir suas regras de NAT, execute o comando <samp>echo &quot;1&quot;
&gt;/proc/sys/net/ipv4/ip_forward</samp> para habilitar o suporte a
redirecionamento de pacotes no kernel.
</p>

<p>
Também é possível especificar faixas de endereços e portas que serão
substituídas:
</p>

<pre>
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j SNAT --to 200.200.217.40-200.200.217.50
</pre>

<p>
Modifica o endereço IP de origem de todas as máquinas da rede 192.168.1.0/24
que tem o destino a interface eth0 para 200.241.200.40 a 200.241.200.50.  O
endereço IP selecionado é escolhido de acordo com o último IP alocado.
</p>

<pre>
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j SNAT --to 200.200.217.40-200.200.217.50:1-1023
</pre>

<p>
Idêntico ao anterior, mas faz somente substituições na faixa de portas de
origem de 1 a 1023.
</p>

<pre>
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j SNAT --to 200.200.217.40-200.200.217.50 --to 200.200.217.70-200.200.217.73
</pre>

<p>
Faz o mapeamento para a faixa de portas 200.200.217.40 a 200.200.217.50 e de
200.200.217.70 a 200.200.217.73.
</p>

<p>
<strong>OBS1:</strong> Se por algum motivo não for possível mapear uma
conexão NAT, ela será derrubada.
</p>

<p>
<strong>OBS2:</strong> Tenha certeza que as respostas podem chegar até a
máquina que fez o NAT.  Se estiver fazendo SNAT em um endereço livre em sua
rede (como 200.200.217.73).
</p>

<p>
<strong>OBS3:</strong> Como notou acima, o SNAT é usado quando temos uma
conexão externa com um ou mais IP's fixos.  O Masquerading é uma forma
especial de SNAT usada para funcionar em conexões que recebem endereços IP
aleatórios (PPP).
</p>

<p>
<strong>OBS4:</strong> Não se esqueça de habilitar o redirecionamento de
pacotes após fazer suas regra de NAT com o comando: <samp>echo &quot;1&quot;
&gt;/proc/sys/net/ipv4/ip_forward</samp>, caso contrário o redirecionamento de
pacotes não funcionará.
</p>

<hr>

<h4 id="s-fw-iptables-nat-snat-masquerade">31.4.3.1 Fazendo IP Masquerading</h4>

<p>
O IP Masquerading é um tipo especial de SNAT usado para conectar a sua rede
interna a internet quando você recebe um IP dinâmico de seu provedor (como em
conexões ppp).  Todas as operações de IP Masquerading são realizadas no
chain <em>POSTROUTING</em>.  Se você tem um IP fixo, deve ler <a
href="#s-fw-iptables-nat-snat">Fazendo SNAT, Seção 31.4.3</a>.
</p>

<p>
Para fazer IP Masquerading de uma máquina com o IP 192.168.1.2 para ter acesso
a Internet, use o comando:
</p>

<pre>
     iptables -t nat -A POSTROUTING -s 192.168.1.2/32 -o ppp0 -j MASQUERADE
</pre>

<p>
A diferença é que o alvo é <em>-j MASQUERADE</em>.  O comando acima faz IP
Masquerading de todo o tráfego de 192.168.1.2 indo para a interface ppp0: O
endereço IP dos pacotes vindos de 192.168.1.2 são substituídos pelo IP
oferecido pelo seu provedor de acesso no momento da conexão, quando a resposta
é retornada a operação inversa é realizada para garantir que a resposta
chegue ao destino.  Nenhuma máquina da internet poderá ter acesso direto a
sua máquina conectava via Masquerading.
</p>

<p>
Para fazer o IP Masquerading de todas as máquinas da rede 192.168.1.*:
</p>

<pre>
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp0 -j MASQUERADE
</pre>

<p>
Após definir a regra para fazer Masquerading (SNAT), execute o comando
<samp>echo &quot;1&quot; &gt;/proc/sys/net/ipv4/ip_forward</samp> para
habilitar o suporte a redirecionamento de pacotes no kernel.
</p>

<hr>

<h3 id="s-fw-iptables-nat-dnat">31.4.4 Fazendo DNAT</h3>

<p>
DNAT (Destination nat - nat no endereço de destino) consiste em modificar o
endereço de destino das máquinas clientes.  O destination nat é muito usado
para fazer redirecionamento de pacotes, proxyes transparentes e balanceamento
de carga.
</p>

<p>
Toda operação de DNAT é feita no chain <em>PREROUTING</em>.  As demais
opções e observações do SNAT são também válidas para DNAT (com exceção
que somente é permitido especificar a interface de origem no chain
PREROUTING).
</p>

<pre>
     # Modifica o endereço IP destino dos pacotes de 200.200.217.40 vindo da interface eth0
     # para 192.168.1.2. 
     iptables -t nat -A PREROUTING -s 200.200.217.40 -i eth0 -j DNAT --to 192.168.1.2
</pre>

<p>
Também é possível especificar faixas de endereços e portas que serão
substituídas no DNAT:
</p>

<pre>
     iptables -t nat -A PREROUTING -i eth0 -s 192.168.1.0/24 -j DNAT --to 200.200.217.40-200.200.217.50
</pre>

<p>
Modifica o endereço IP de destino do tráfego vindos da interface
192.168.1.0/24 para um IP de 200.241.200.40 a 200.241.200.50.  Este é um
excelente método para fazer o balanceamento de carga entre servidores.  O
endereço IP selecionado é escolhido de acordo com o último IP alocado.
</p>

<pre>
     iptables -t nat -A PREROUTING -i eth0 -s 192.168.1.0/24 -j DNAT --to 200.200.217.40-200.200.217.50:1024:5000
</pre>

<p>
Idêntico ao anterior, mas faz somente substituições na faixa de portas de
destino de 1024 a 5000.  A operação acima é a mesma realizada pelo
<code>ipmasqadm</code> dos kernels da série 2.2.
</p>

<p>
<strong>OBS1:</strong> Se por algum motivo não for possível mapear uma
conexão NAT, ela será derrubada.
</p>

<p>
<strong>OBS2:</strong> Não se esqueça de conferir se o
<code>ip_forward</code> está ajustado para <samp>1</samp>: <samp>echo
&quot;1&quot; &gt;/proc/sys/net/ipv4/ip_forward</samp>.
</p>

<hr>

<h4 id="s-fw-iptables-nat-dnat-redir">31.4.4.1 Redirecionamento de portas</h4>

<p>
O redirecionamento de portas permite a você repassar conexões com destino a
uma porta para outra porta na mesma máquina.  O alvo <em>REDIRECT</em> é
usado para fazer esta operação, junto com o argumento <em>--to-port</em>
especificando a porta que será redirecionada.  Este é o método DNAT
específico para se para fazer proxy transparente (para redirecionamento de
endereços/portas, veja <a href="#s-fw-iptables-nat-dnat">Fazendo DNAT, Seção
31.4.4</a>).  Todas as operações de redirecionamento de portas é realizada
no chain <em>PREROUTING</em> e <em>OUTPUT</em> da tabela <em>nat</em>.
</p>

<pre>
     iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 81
</pre>

<p>
Redireciona as conexões indo para a porta 80 para a porta 81 (rodando
<code>squid</code>) no firewall.
</p>

<p>
<strong>ATENÇÃO:</strong> O <code>squid</code> possui suporte a proxy
transparente, e poderá atender as requisições acima da regra acima.
</p>

<hr>

<h3 id="s-fw-iptables-nat-monitorando">31.4.5 Monitorando conexões feitas na tabela nat</h3>

<p>
Use o comando <samp>cat /proc/net/ip_conntrack</samp> para listar todas as
conexões atuais tratadas pelo módulo nat.
</p>

<hr>

<h2 id="s-fw-iptables-mangle">31.5 A tabela mangle</h2>

<p>
A tabela <em>mangle</em> serve para especificar ações especiais para o
tratamento do tráfego que atravessa os chains.  Nesta tabela existem cincos
chains: <em>PREROUTING</em>, <em>POSTROUTING</em>, <em>INPUT</em>,
<em>OUTPUT</em> e <em>FORWARD</em> (veja <a href="#s-fw-iptables-tabelas">O que
são tabelas?, Seção 31.1.14</a> para maiores detalhes).
</p>

<p>
Em geral, cada um deste chain é processado antes do chain correspondente na
tabela <em>filter</em> e <em>nat</em> para definir opções especiais para o
tráfego (por exemplo, o chain <em>PREROUTING</em> da tabela <em>mangle</em> é
processado antes do <em>PREROUTING</em> da tabela <em>nat</em>).  O chain
<em>OUTPUT</em> da tablea <em>mangle</em> corresponde ao <em>OUTPUT</em> da
tabela <em>nat</em>.  Opções como o <em>Tipo de Serviço (TOS)</em> é
especificado nesta tabela para classificar e aumentar consideravelmente a
velocidade de tráfego considerados em tempo real.  Mesmo após o tráfego ser
estabelecido, os chains da tabela mangle continuam ativos para garantir que as
opções especiais relacionadas com a conexão continuem fazendo efeito (veja
os exemplos de <a href="#s-fw-iptables-path">Caminho percorrido pelos pacotes
nas tabelas e chains, Seção 31.7</a>).
</p>

<hr>

<h3 id="s-fw-iptables-mangle-TOS">31.5.1 Especificando o tipo de serviço</h3>

<p>
O tipo de serviço é um campo existente no cabeçalho de pacotes do protocolo
ipv4 que tem a função especificar qual é a prioridade daquele pacote.  A
prioridade é definida usando o algoritmo FIFO do próprio kernel, sendo uma
das alternativas de controle/priorização de tráfego das mais simples e
rápidas.
</p>

<p>
Uma das vantagens da utilização do tipo de serviço é dar prioridade ao
tráfego de pacotes interativos (como os do ICQ, IRC, servidores de chat), etc.
Com o TOS especificado, mesmo que esteja fazendo um download consumindo toda a
banda de sua interface de rede, o tráfego com prioridade interativa será
enviado antes, aumentando a eficiência do uso de serviços em sua máquina.
</p>

<p>
Em testes realizados em minha conexão de 56K, o uso de regras TOS aumentou
bastante o desempenho em tráfego interativo (em torno de 300%), durante o uso
total da banda da interface ppp em grande consumo de banda.
</p>

<p>
Usamos o alvo TOS (-j TOS) para especificar a modificação do tipo de serviço
nos pacotes que atravessam as regras do firewall, acompanhada do argumento
<em>--set-tos TOS</em> que define a nova prioridade dos pacotes.  Os valores
aceitos são os seguintes:
</p>
<dl>
<dt>Espera Mínima</dt>
<dd>
<p>
É especificado através de <em>Minimize-Delay</em>, <em>16</em> ou
<em>0x10</em>
</p>
</dd>
<dt>Máximo Processamento</dt>
<dd>
<p>
É especificado através de <em>Maximize-Throughput</em>, <em>8,</em> ou
<em>0x08</em>.
</p>
</dd>
<dt>Máxima Confiança</dt>
<dd>
<p>
É especificado através de <em>Maximize-Reliability</em>, <em>4</em> ou
<em>0x04</em>.
</p>
</dd>
<dt>Custo mínimo</dt>
<dd>
<p>
Especificado através de <em>Minimize-Cost</em>, <em>2</em> ou <em>0x02</em>.
</p>
</dd>
<dt>Prioridade Normal</dt>
<dd>
<p>
Especificado através de <em>Normal-Service</em>, <em>0</em> ou <em>0x00</em>.
</p>
</dd>
</dl>

<p>
Os pacotes vem por padrão com o valor TOS ajustado como <em>prioridade
normal</em> (bits tos ajustados para 0x00).  O tipo <em>Mínima Espera</em> é
o de maior prioridade, recomendado para tráfego interativo.
</p>

<hr>

<h4 id="s-fw-iptables-mangle-TOS-out">31.5.1.1 Especificando o TOS para tráfego de saída</h4>

<p>
Este é o mais usado, pois prioriza o tráfego que sai da máquina (com destino
a Internet, por exemplo).  Sua operação é realizada através do chain
<em>OUTPUT</em> ou <em>POSTROUTING</em>.
</p>

<p>
Para priorizar todo o tráfego de IRC de nossa rede interna indo para a
interface ppp0:
</p>

<pre>
     iptables -t mangle -A OUTPUT -o ppp0 -p tcp --dport 6666-6668 -j TOS --set-tos 16
</pre>

<p>
O bit TOS é ajustado para <em>Espera mínima</em> e será enviado antes dos
pacotes com prioridade normal para fora.  Para priorizar a transmissão de
dados ftp saindo da rede:
</p>

<pre>
     iptables -t mangle -A OUTPUT -o ppp0 -p tcp --dport 20 -j TOS --set-tos 8
</pre>

<p>
Para priorizar o tráfego de ICQ da rede:
</p>

<pre>
     iptables -t mangle -A OUTPUT -o ppp0 -p tcp --dport 5190 -j TOS --set-tos 16
</pre>

<p>
Existem muitas outras otimizações que podem ser feitas, só depende dos
requerimentos e análise de cada serviço da rede pelo administrador.
</p>

<p>
<strong>OBS:</strong> - Os pacotes que atravessam o alvo TOS somente tem os
bits tipo do serviço modificados, eles não serão de qualquer forma
rejeitados.
</p>

<hr>

<h4 id="s-fw-iptables-mangle-TOS-in">31.5.1.2 Especificando o TOS para o tráfego de entrada</h4>

<p>
Este prioriza o tráfego que entra da máquina.  Sua operação é realizada no
chain <em>INPUT</em> ou <em>PREROUTING</em>.  Não faz muito sentido o uso
deste chain dentro de uma rede pequena/média, pois o tráfego que recebermos
será priorizado pelo chain de saída de outras máquinas da internet/outras
redes antes de chegar a nossa (desde que elas também estejam usando TOS).
</p>

<p>
Para priorizar o processamento do tráfego interativo vindo de servidores IRC
para nossa rede:
</p>

<pre>
     iptables -t mangle -A PREROUTING -i eth0 -p tcp --sport 6666-6668 -j TOS --set-tos 0x10
</pre>

<p>
Modifica o tipo de serviço para <em>mínima espera</em> de todo o tráfego
enviado por servidores de IRC vindo da interface eth0.
</p>

<p>
<strong>OBS:</strong> - Os pacotes que atravessam o alvo TOS somente tem os
bits tipo do serviço modificados, eles não serão de qualquer forma
rejeitados.  \
</p>

<hr>

<h2 id="s-fw-iptables-mod">31.6 Outros módulos do iptables</h2>

<p>
Os módulos do iptables são especificados com a opção <em>-m módulo</em> ou
<em>--match módulo</em> e permitem expandir a funcionalidade do firewall
através de novas conferências e recursos de filtragem adicionais, como
limitar a conferência de regras do firewall (um método útil de limitar ping
floods, syn floods, etc).
</p>

<hr>

<h3 id="s-fw-iptables-mod-state">31.6.1 Conferindo de acordo com o estado da conexão</h3>

<p>
Este módulo permite especificar regras de acordo com o estado da conexão do
pacote, isto é feito através da interpretação da saída do módulo
<code>ip_conntrack</code>.  O parâmetro <em>--state OPÇÕES</em> deve
acompanhar este módulo.  As opções permitidas são as seguintes:
</p>
<ul>
<li>
<p>
<samp>NEW</samp> - Confere com pacotes que criam novas conexões
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>ESTABLISHED</samp> - Confere com conexões já estabelecidas
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>RELATED</samp> - Confere com pacotes relacionados indiretamente a uma
conexão, como mensagens de erro icmp, etc.
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>INVALID</samp> - Confere com pacotes que não puderam ser identificados
por algum motivo.  Como respostas de conexões desconhecidas.
</p>
</li>
</ul>

<p>
Caso seja necessário especificar mais de uma opções estas devem ser
separadas por vírgulas.
</p>

<pre>
     iptables -A INPUT -m state --state NEW -i ppp0 -j DROP
</pre>

<p>
Bloqueia qualquer tentativa de nova conexão vindo da interface ppp0.
</p>

<pre>
     iptables -A INPUT -m state --state NEW,INVALID -i ppp0 -j LOG
</pre>

<p>
Permite registrar novas conexões e pacotes inválidos vindos da interface
ppp0.
</p>

<hr>

<h3 id="s-fw-iptables-mod-limit">31.6.2 Limitando o número de vezes que a regra confere</h3>

<p>
A opção <em>-m limit</em> permite especificar o número de vezes que uma
regra conferirá quando todas as outras condições forem satisfeitas.  O
número padrão de conferência é de 3 por hora, a não ser que seja
modificado através dos argumentos aceitos pelo <em>limit</em>:
</p>
<ul>
<li>
<p>
<samp>--limit num/tempo</samp> - Permite especificar a taxa de conferências do
limit.  O parâmetro <em>num</em> especifica um número e <em>tempo</em> pode
ser
</p>
<ul>
<li>
<p>
<samp>s</samp> - Segundo
</p>
</li>
<li>
<p>
<samp>m</samp> - Minuto
</p>
</li>
<li>
<p>
<samp>h</samp> - Hora
</p>
</li>
<li>
<p>
<samp>d</samp> - Dia
</p>
</li>
</ul>

<p>
Assim uma regra como <samp>iptables -A INPUT -m limit --limit 5/m -j
ACCEPT</samp> permitirá que a regra acima confira apenas 5 vezes por minuto
(<em>--limit 2/s</em>).  Este limite pode ser facilmente adaptado para uma
regra de log que confere constantemente não causar uma avalanche em seus logs.
O valor padrão é 3/h.
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>--limit-burst num</samp> - Especifica o número inicial máximo de
pacotes que irão conferir, este número é aumentado por 1 a cada vez que o
parâmetro <em>--limit</em> acima não for atingido.  O valor padrão é 5.
</p>
</li>
</ul>

<hr>

<h3 id="s-fw-iptables-mod-limit-ping">31.6.3 Proteção contra ping da morte</h3>

<p>
A regra abaixo pode tomada como base para proteção contra ping flood:
</p>

<pre>
     iptables -t filter -A ping-chain -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
     iptables -t filter -A ping-chain -j DROP
</pre>

<p>
A regra acima limita em 1 vez por segundo (--limit 1/s) a passagem de pings
(echo requests) para a máquina <code>Linux</code>.
</p>

<pre>
     iptables -t filter -A ping-chain -i ppp0 -p icmp --icmp-type echo-reply -m limit --limit 1/s -j RETURN
     iptables -t filter -A ping-chain -j DROP
</pre>

<p>
Limita respostas a pings (echo reply) vindos da interface ppp0 (-i ppp0) a 1
por segundo.
</p>

<p>
<strong>ATENÇÃO:</strong> O exemplo acima é somente para a criação de suas
próprias regras com limitações, caso um pacote não confira ele será
bloqueado pela próxima regra.  Se uma regra como esta for colocada no chain
INPUT sem modificações, ela não terá o efeito desejado, podendo colocar em
risco a sua instalação pela falsa impressão de segurança.  Portanto, é
recomendável sempre testar as modificações para ter certeza que elas tem
efeito.
</p>

<hr>

<h3 id="s-fw-iptables-mod-limit-synflood">31.6.4 Proteção contra syn flood</h3>

<p>
A regra abaixo é uma boa proteção para os ataques syn floods:
</p>

<pre>
     iptables -t filter -A syn-chain -p tcp --syn -m limit --limit 2/s -j ACCEPT
     iptables -t filter -A syn-chain -j DROP
</pre>

<p>
Esta regra limita o atendimento de requisições de conexões a 2 por segundo.
Outra forma de aumentar a segurança contra syn-floods é através do próprio
kernel ativando a opção &quot;TCP Synflood&quot; na compilação e depois
executando: <samp>echo &quot;1&quot;
&gt;/proc/sys/net/ipv4/tcp_synflood</samp>.  No entanto, utilize estas opções
com cautela em servidores que possuem um grande número de acessos para não
ter problemas que afetem seu clientes.
</p>

<p>
<strong>ATENÇÃO:</strong> Os exemplos acima devem são somente exemplos para
criação de suas próprias regras com limitações, caso um pacote não
confira com a regra ele será bloqueado pela próxima regra.  Se uma regra como
esta for colocada no chain INPUT sem modificações, ela não terá o efeito
desejado, podendo colocar em risco a sua instalação pela falsa impressão de
segurança.  Portanto, é recomendável sempre testar as modificações para
ter certeza que elas tem efeito.
</p>

<hr>

<h3 id="s-fw-iptables-outras-ipspoof">31.6.5 Proteção contra IP spoofing</h3>

<p>
A especificação de endereços de origem/destino junto com a interface de rede
pode ser usado como um detector de ataques spoofing.  A lógica é que todos os
endereços que NUNCA devem vir da interface X devem ser negados imediatamente.
As regras abaixo são colocadas no inicio do chain INPUT para detectar tais
ataques:
</p>

<pre>
     iptables -A INPUT -s 192.168.1.0/24 -i ! eth0 -j DROP
     iptables -A INPUT ! -s 192.168.1.0/24 -i eth0 -j DROP
</pre>

<p>
A primeira regra diz para bloquear todos os endereços da faixa de rede
192.168.1.* que NÃO vem da interface eth0, a segunda regra diz para bloquear
todos os endereços que não sejam 192.168.1.* vindos da interface eth0.  O
símbolo &quot;!&quot; serve para especificar exceções (veja <a
href="#s-fw-iptables-outras-excessoes">Especificando uma exceção, Seção
31.3.5</a>.  O kernel do <code>Linux</code> automaticamente bloqueia a passagem
de pacotes que dizem ser de 127.0.0.1 e não está vindo da interface loopback.
</p>

<p>
O método preferido para controlar o ip spoofing é através do código de
roteamento do kernel (a não ser que esteja usando algum tipo de roteamento de
origem assimétrico necessário por alguns programas especiais):
</p>

<pre>
     for i in /proc/sys/net/ipv4/conf/*/rp_filter; do
      echo 1 &gt;$i
     done
</pre>

<p>
Desta forma qualquer endereço dizendo ser 192.168.1.5 vindo de
<code>ppp0</code> será imediatamente rejeitado.  Uma checagem adicional contra
IP spoofing pode ser feita no arquivo <code>/etc/host.conf</code> (veja <a
href="ch-rede.html#s-rede-dns-a-hostconf">/etc/host.conf, Seção
15.6.2.2</a>).
</p>

<hr>

<h3 id="s-fw-iptables-mod-multiport">31.6.6 Especificando múltiplas portas de origem/destino</h3>

<p>
O módulo <code>multiport</code> permite que seja especificado múltiplas
portas para um alvo.  Podem ser especificadas até 15 portas em um único
parâmetro e basta que uma porta confira para que a regra entre em ação, pois
a comparação é feita usando condições &quot;or&quot;.  O parâmetro
<code>multiport</code> deve ser acompanhado de um dos argumentos abaixo:
</p>
<ul>
<li>
<p>
<samp>--source-port [porta1, porta2...]</samp> - Faz a regra conferir se a
porta de origem estiver presente entre as portas especificadas.
</p>
</li>
<li>
<p>
<samp>--destination-port [porta1, porta2...]</samp> - Faz a regra conferir se a
porta de destino estiver presente entre as portas especificadas.
</p>
</li>
<li>
<p>
<samp>--port [porta1, porta2...]</samp> - Faz a regra conferir caso a porta de
origem ou destino esteja presente no parâmetro.
</p>
</li>
</ul>

<p>
Este módulo pode eliminar muitas regras de firewall que fazem o mesmo
tratamento de pacotes para diversas portas diferentes.
</p>

<pre>
     iptables -A INPUT -p tcp -i ppp0 -m multiport --destination-port 21,23,25,80,110,113,6667 -j DROP
</pre>

<p>
Bloqueia todos os pacotes vindo de ppp0 para as portas 21 (ftp), 23 (telnet),
25 (smtp), 80 (www), 110 (pop3), 113 (ident), 6667 (irc).
</p>

<hr>

<h3 id="s-fw-iptables-mod-mac">31.6.7 Especificando o endereço MAC da interface</h3>

<p>
O módulo <code>mac</code> serve para conferir com o endereço Ethernet dos
pacotes de origem.  Somente faz sentido se usado nos chains de PREROUTING (da
tabela nat) ou INPUT (da tabela filter).  Aceita como argumento a opção
<em>--mac-source endereço</em>.  O símbolo &quot;!&quot; pode ser usado para
especificar uma exceção.
</p>

<pre>
     iptables -t filter -A INPUT -m mac --mac-source 00:80:AD:B2:60:0B -j DROP
</pre>

<p>
Confere com a máquina com endereço ethernet igual a
<samp>00:80:AD:B2:60:0B</samp>.
</p>

<hr>

<h3 id="s-fw-iptables-mod-owner">31.6.8 Conferindo com quem criou o pacote</h3>

<p>
Este módulo confere com o usuário que iniciou a conexão.  É somente válido
no chain <em>OUTPUT</em> da tabela filter.  Os seguintes argumentos são
válidas para este módulo:
</p>
<ul>
<li>
<p>
<samp>--uid-owner UID</samp> - Confere se o pacote foi criado por um processo
com o UID especificado.  Até o momento somente UID numéricos são aceitos.
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>--gid-owner GID</samp> - Confere se o pacote foi criado por um usuário
pertencente ao grupo GID.  Até o momento somente GID numéricos são aceitos.
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>--pid-owner PID</samp> - Confere se o pacote foi criado por um processo
com o PID especificado.
</p>
</li>
</ul>
<ul>
<li>
<p>
<samp>--sid-owner ID</samp> - Confere se o pacote foi criado por um processo no
grupo de seção especificado.
</p>
</li>
</ul>

<p>
<strong>OBS:</strong> - Lembre-se que pacotes que não possuem detalhes
suficientes de cabeçalho nunca conferirão!
</p>

<pre>
     iptables -A OUTPUT -m owner --gid-owner 100 -p udp -j DROP
</pre>

<p>
Rejeita um conexões indo para portas UDP de pacotes criados pelo usuários
pertencentes ao grupo 100.
</p>

<hr>

<h3 id="s-fw-iptables-mod-string">31.6.9 Conferindo com o conteúdo do pacote</h3>

<p>
O módulo <code>string</code> do <code>iptables</code> permite a inspeção de
conteúdo de um pacote e tomar uma ação se determinado tipo de tráfego for
encontrado em um pacote.  Esta técnica pode ser usada tanto para segurança
como para economia de banda dentro da rede.  Esta opção *NÃO* torna o
iptables como um firewall proxy, pois o proxy tem a habilidade de inspecionar o
conteúdo, protocolo, comandos do pacote e decidir se o seu conteúdo é nocivo
ou não.  O firewall em nível de pacotes fazendo inspeção de conteúdo,
chega a ser 3 a 10 vezes mais rápido do que um proxy, assim seu uso deve ser
analisado dependendo do tráfego que circula pelo link e da segurança dos
dados que trafegam através dele.
</p>

<p>
Uma boa prática é aliar esta opção a um IDS externo usando o alvo
<em>QUEUE</em> e deixando o trabalho de espeção de conteúdo para ele.  Um
exemplo de restrição direta é o bloqueio do envio de qualquer informação
confidencial sigilosa para fora da rede interna (número de contas, tudo que
conferir com CPF, CGC, endereços de e-mail, memorandos, etc).  De qualquer
forma, analise o tráfego de sua rede antes de querer implementar qualquer
solução baseada neste método sob o risco de afetar tráfego legítimo.
</p>

<p>
Outra utilidade eficiente é a diminuição de tráfego, pois podemos barrar
programas que sobrecarregam o link em uma rede com muitos usuários como, por
exemplo, usando o <code>Kazaa</code> ou qualquer outro programa para cópia de
arquivos via Internet.  Veja alguns exemplos:
</p>

<pre>
     # Bloqueia qualquer tentativa de acesso ao programa Kazaa
     iptables -A INPUT -m string --string &quot;X-Kazaa&quot; -j DROP
     
     # Não permite que dados confidenciais sejam enviados para fora da empresa
     # e registra o ocorrido.
     iptables -A OUTPUT -m string --string &quot;conta&quot; -j LOG --log-prefix &quot;ALERTA: dados confidencial &quot;
     iptables -A OUTPUT -m string --string &quot;conta&quot; -j DROP
     
     # Somente permite a passagem de pacotes que não contém &quot;.exe&quot; em seu conteúdo
     iptables -A INPUT -m string --string ! &quot;.exe&quot; -j ACCEPT
</pre>

<hr>

<h3 id="s-fw-iptables-mod-ttl">31.6.10 Conferindo com o tempo de vida do pacote</h3>

<p>
O módulo <code>ttl</code> pode ser usado junto com as seguintes opções para
conferir com o tempo de vida (TTL) de um pacote:
</p>
<ul>
<li>
<p>
<samp>--ttl-eq [num]</samp>
</p>
</li>
<li>
<p>
<samp>--ttl-lt [num]</samp>
</p>
</li>
<li>
<p>
<samp>--ttl-gq [num]</samp>
</p>
</li>
</ul>

<p>
Veja alguns exemplos:
</p>

<pre>
     # Confere com todos os pacotes que tem o TTL maior que 100
     iptables -A INPUT -m ttl --ttl-gt 100 -j LOG --log-prefix &quot;TTL alto&quot;
     
     # Confere com todos os pacotes que tem o TTL igual a 1
     iptables -A INPUT -m ttl --ttl-eq 1 -j DROP
</pre>

<p>
<strong>OBS:</strong> Tenha um especial cuidado durante a programação de
regras que usem TTL, como elas estão especialmente associadas com o estado da
comunicação estabelecida entre as duas pontas e o tipo de protocolo, cuidados
especiais devem ser tomados para que seu firewall não manipule de forma
incorreta tráfego válido.
</p>

<hr>

<h3 id="s-fw-iptables-mod-rpc">31.6.11 Conferindo com números RPC</h3>

<p>
O módulo <code>rpc</code> permite um controle especial sobre o tráfego RPC
que chega até a sua máquina.  Um uso útil é restringir a chamada a
determinados números RPC e permitir outros (por exemplo, permitindo somente o
serviço <em>keyserv</em> e bloqueando outros como o <em>ypserv</em> ou
<em>portmapper</em>).  As seguintes opções podem ser usadas com o módulo
<code>nfs</code>:
</p>
<ul>
<li>
<p>
<samp>--rpcs [procedimentos]</samp> - Confere com a lista de chamadas RPC
especificadas.  Mais de um procedimento RPC pode ser especificado como
<samp>nome</samp> ou <samp>número</samp> separando-os com vírgulas.  Um
arquivo útil que contém esta lista é o <code>/etc/rpc</code>.
</p>
</li>
<li>
<p>
<samp>--strict</samp> - Ignora serviços RPC que não contenham a chamada
<em>get</em> do portmapper.  Em situações normais, o inicio de qualquer
solicitação RPC.
</p>
</li>
</ul>

<p>
Veja alguns exemplos:
</p>

<pre>
     # Para conferir com todas as chamadas RPC referentes a conexões iniciadas
     # para o portmapper
     iptables -A INPUT -m rpc --rpcs portmapper --strict -j DROP
     
     # Para permitir que somente as chamadas para status e statmon sejam
     # aceitas
     iptables -A INPUT -m rpc --rpcs 100023,100024 -j ACCEPT
</pre>

<hr>

<h3 id="s-fw-iptables-mod-pkttype">31.6.12 Conferindo com tipo de pacote</h3>

<p>
O módulo <code>pkttype</code> permite identificar um pacote do tipo
<em>unicast</em> (direcionado a você), <em>broadcast</em> (direcionado a uma
determinada rede, definida pela netmask) ou <em>multicast</em> (destinado a
grupos de redes) e desta forma realizar ações em cima destes.  O tipo de
pacote é identificado logo após a opção <em>--pkt-type</em>.  Veja alguns
exemplos:
</p>

<pre>
     # Bloqueia a passagem de pacotes multicast de uma rede para outra
     iptables -A FORWARD -i eth0 -o eth0 -m pkttype --pkt-type multicast -j DROP 
     
     # Como deve ter notado, é possível fazer a associação com diversas especificações
     # de módulos, bastando apenas especificar uma opção &quot;-m&quot; para cada módulo
     # adicional:
     # Permite a passagem de pacotes broadcast de uma rede para outra com
     # limitação de 5/s.
     iptables -A FORWARD -i eth0 -o eth0 -m pkttype --pkt-type broadcast -m limit --limit 5/s -j ACCEPT
</pre>

<hr>

<h3 id="s-fw-iptables-mod-length">31.6.13 Conferindo com o tamanho do pacote</h3>

<p>
O tamanho do pacote pode ser usado como condição de filtragem através do
módulo <code>length</code>.  O tamanho do pacote é especificado através da
opção <em>--length</em> e o argumento segue a mesma sintaxe da
especificação de portas no <code>iptables</code> sendo separados por
<em>:</em>.  Veja alguns exemplos:
</p>

<pre>
     # Bloqueia qualquer pacote ICMP maior que 30Kb
     iptables -A INPUT -i eth0 -m length --length 30000: -j DROP
     
     # Bloqueia qualquer pacote com o tamanho entre 20 e 2000 bytes
     iptables -A INPUT -i eth0 -m length --length 20:2000 -j DROP
</pre>

<hr>

<h2 id="s-fw-iptables-path">31.7 Caminho percorrido pelos pacotes nas tabelas e chains</h2>

<p>
É MUITO importante entender a função de cada filtro e a ordem de acesso dos
chains de acordo com o tipo de conexão e interface de origem/destino.  Esta
seção explica a ordem que as regra são atravessadas, isso lhe permitirá
planejar a distribuição das regras nos chains, e evitar erros de
localização de regras que poderia deixar seu firewall com sérios problemas
de segurança, ou um sistema de firewall totalmente confuso e sem lógica.
</p>

<p>
Nos exemplos abaixo assumirei a seguinte configuração:
</p>
<ul>
<li>
<p>
A máquina do firewall com <code>iptables</code> possui o endereço IP
<code>192.168.1.1</code> e conecta a rede interna ligada via interface
<code>eth0</code> a internet via a interface <code>ppp0</code>.
</p>
</li>
<li>
<p>
Rede interna com a faixa de endereços <code>192.168.1.0</code> conectada ao
firewall via interface <code>eth0</code>
</p>
</li>
<li>
<p>
Interface <code>ppp0</code> fazendo conexão com a Internet com o endereço IP
<code>200.217.29.67</code>.
</p>
</li>
<li>
<p>
A conexão das máquinas da rede interna (<code>eth0</code>) com a rede externa
(<code>ppp0</code>) é feita via <em>Masquerading</em>.
</p>
</li>
</ul>

<p>
Também utilizarei a sintaxe <em>CHAIN-tabela</em> para fazer referência aos
chains e tabelas dos blocos ASCII: <em>INPUT-filter</em> - chain <em>INPUT</em>
da tabela <em>filter</em>.
</p>

<p>
<strong>ATENÇÃO:</strong> A ordem de processamento das regras do
<code>iptables</code>, é diferente do <code>ipchains</code> devido a inclusão
do novo sistema de nat e da tabela mangle.
</p>

<hr>

<h3 id="s-fw-iptables-path-PingICMPLocal-Local">31.7.1 Ping de 192.168.1.1 para 192.168.1.1</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>192.168.1.1</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>192.168.1.1</samp>
</p>
</li>
<li>
<p>
Interface de Entrada: <samp>lo</samp>
</p>
</li>
<li>
<p>
Interface de Saída: <samp>lo</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>ICMP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Ping para o próprio firewall</samp>
</p>
</li>
</ul>

<pre>
     SAÍDA DE PACOTES (envio do ping para 192.168.1.1): 
     +-------------+    +----------+    +-------------+   +------------------+  +----------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-nat| =&gt; |OUTPUT-filter| =&gt;|POSTROUTING-mangle|=&gt;|POSTROUTING-nat |
     +-------------+    +----------+    +-------------+   +------------------+  +----------------+
     
     ENTRADA DOS PACOTES (Retorno da resposta ping acima): 
     +-----------------+   +------------+  +------------+
     |PREROUTING-mangle| =&gt;|INPUT-mangle|=&gt;|INPUT-filter|
     +-----------------+   +------------+  +------------+
</pre>

<p>
Quando damos o ping (<em>echo request</em>) os pacotes seguem o caminho em
<em>SAÍDA DE PACOTES</em> percorrendo os chains na ordem especificada e
retornam via <em>ENTRADA DOS PACOTES</em> (<em>echo reply</em>).  No envio da
resposta da requisição de ping, o caminho de saída do pacote ignora os
chains OUTPUT-nat e POSTROUTING-nat (já que não é necessário nat) mas
sempre processa os chains correspondentes da tabela mangle na ordem indicada
acima.
</p>

<p>
<strong>OBS1:</strong> Para conexões com destinos na própria máquina usando
um endereço IP das interfaces locais, a interface será ajustada sempre para
<code>lo</code> (loopback).
</p>

<p>
<strong>OBS2:</strong> Em qualquer operação de entrada/saída de pacotes, os
dois chains da tabela <em>mangle</em> são sempre os primeiros a serem
acessados.  Isto é necessário para definir a prioridade e controlar outros
aspectos especiais dos pacotes que atravessam os filtros.
</p>

<p>
<strong>OBS3:</strong> O chain <em>OUTPUT</em> da tabela <em>filter</em> é
consultado sempre quando existem conexões se originando em endereços de
interfaces locais.
</p>

<hr>

<h3 id="s-fw-iptables-path-FtpTCPLocal-Local">31.7.2 Conexão FTP de 192.168.1.1 para 192.168.1.1</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>192.168.1.1</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>192.168.1.1</samp>
</p>
</li>
<li>
<p>
Interface de Origem: <samp>lo</samp>
</p>
</li>
<li>
<p>
Interface de Destino: <samp>lo</samp>
</p>
</li>
<li>
<p>
Porta Origem: <samp>1404</samp>
</p>
</li>
<li>
<p>
Porta Destino: <samp>21</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>TCP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Conexão ftp (até o prompt de login, sem transferência de
arquivos).</samp>
</p>
</li>
</ul>

<pre>
     SAÍDA DOS PACOTES (envio da requisição para 192.168.1.1): 
     +-------------+    +----------+    +-------------+    +------------------+    +---------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-nat| =&gt; |OUTPUT-filter| =&gt; +POSTROUTING-mangle| =&gt; |POSTROUTING-nat|
     +-------------+    +----------+    +-------------+    +------------------+    +---------------+
     
     ENTRADA DE PACOTES (respostas da requisição vindas de 192.168.1.1): 
     +-----------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +------------+    +------------+
</pre>

<p>
A requisição ftp passa através dos chains especificados em <em>SAÍDA DOS
PACOTES</em> e retorna por <em>ENTRADA DE PACOTES</em>.  Após a conexão ser
estabelecida, o caminho de <em>SAÍDA DE PACOTES</em> será:
</p>

<pre>
     +-------------+    +-------------+    +------------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-filter| =&gt; |POSTROUTING-mangle|
     +-------------+    +-------------+    +------------------+
</pre>

<p>
pois os dados de entrada que vem da interface externa, são passados
diretamente a máquina do firewall, não necessitando de tratamento SNAT (os
chains <em>OUTPUT-nat</em> e <em>POSTROUTING-nat</em> são processado somente
uma vez a procura de regras que conferem, principalmente para fazer SNAT).
Note novamente que mesmo não sendo necessário NAT, o chain POSTROUTING-mangle
é checado.
</p>

<p>
<strong>OBS1:</strong> Para conexões com destinos na própria máquina usando
um endereço IP das interfaces locais, a interface será ajustada sempre para
<code>lo</code> (loopback).
</p>

<p>
<strong>OBS2:</strong> Em qualquer operação de entrada/saída de pacotes, os
dois chains da tabela mangle são sempre os primeiros a serem acessados.  Isto
é necessário para definir a prioridade e controlar outros aspectos especiais
dos pacotes que atravessam os filtros.
</p>

<hr>

<h3 id="s-fw-iptables-path-FtpTCPLocal-LocalNet">31.7.3 Conexão FTP de 192.168.1.1 para 192.168.1.4</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>192.168.1.1</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>192.168.1.4</samp>
</p>
</li>
<li>
<p>
Interface de Origem: <samp>eth0</samp>
</p>
</li>
<li>
<p>
Interface de Destino: <samp>eth0</samp>
</p>
</li>
<li>
<p>
Porta Origem: <samp>1405</samp>
</p>
</li>
<li>
<p>
Porta Destino: <samp>21</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>TCP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Conexão ftp (até o prompt de login, sem transferência de
arquivos).</samp>
</p>
</li>
</ul>

<pre>
     SAÍDA DOS PACOTES (envio da requisição para 192.168.1.4): 
     +-------------+    +----------+    +-------------+    +------------------+    +---------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-nat| =&gt; |OUTPUT-filter| =&gt; +POSTROUTING-mangle| =&gt; |POSTROUTING-nat|
     +-------------+    +----------+    +-------------+    +------------------+    +---------------+
     
     ENTRADA DE PACOTES (respostas da requisição de 192.168.1.4): 
     +-----------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +------------+    +------------+
</pre>

<p>
A requisição ftp passa através dos chains especificados em <em>SAÍDA DOS
PACOTES</em> com o destino <code>192.168.1.4</code> porta <code>21</code> e
retorna por <em>ENTRADA DE PACOTES</em> para <code>192.168.1.1</code> porta
<code>1405</code>.  Após a conexão ser estabelecida, o caminho de <em>SAÍDA
DE PACOTES</em> será:
</p>

<pre>
     +-------------+    +-------------+    +------------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-filter| =&gt; |POSTROUTING-mangle|
     +-------------+    +-------------+    +------------------+
</pre>

<p>
pois os dados não precisam de tratamento SNAT (os chains <em>OUTPUT-nat</em> e
<em>POSTROUTING-nat</em> são processado somente uma vez a procura de regras
que conferem, principalmente para fazer SNAT).
</p>

<p>
<strong>OBS:</strong> Em qualquer operação de entrada/saída de pacotes, os
dois chains da tabela mangle são sempre os primeiros a serem acessados.  Isto
é necessário para definir a prioridade e controlar outros aspectos especiais
dos pacotes que atravessam os filtros.
</p>

<hr>

<h3 id="s-fw-iptables-path-FtpTCPLocal-RemoteNet">31.7.4 Conexão FTP de 200.217.29.67 para a máquina ftp.debian.org.br</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>200.217.29.67</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>200.198.129.162</samp>
</p>
</li>
<li>
<p>
Interface de Origem: <samp>ppp0</samp>
</p>
</li>
<li>
<p>
Interface de Destino: <samp>ppp0</samp>
</p>
</li>
<li>
<p>
Porta Origem: <samp>1407</samp>
</p>
</li>
<li>
<p>
Porta Destino: <samp>21</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>TCP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Conexão ftp (até o prompt de login, sem transferência de
arquivos).</samp>
</p>
</li>
</ul>

<pre>
     SAÍDA DOS PACOTES (envio da requisição para 200.198.129.162): 
     +-------------+    +----------+    +-------------+    +------------------+    +---------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-nat| =&gt; |OUTPUT-filter| =&gt; +POSTROUTING-mangle| =&gt; |POSTROUTING-nat|
     +-------------+    +----------+    +-------------+    +------------------+    +---------------+
     
     ENTRADA DE PACOTES (respostas da requisição vindas de 200.198.129.162): 
     +-----------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +------------+    +------------+
</pre>

<p>
A requisição ftp passa através dos chains especificados em <em>SAÍDA DOS
PACOTES</em> com o destino <code>200.198.129.162</code> porta <code>21</code>
(após a resolução DNS de <code>www.debian.org.br</code>) e retorna por
<em>ENTRADA DE PACOTES</em> para <code>200.217.29.67</code> porta
<code>1407</code>.  Após a conexão ser estabelecida, o caminho de saída de
pacotes é:
</p>

<pre>
     +-------------+    +-------------+    +------------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-filter| =&gt; |POSTROUTING-mangle|
     +-------------+    +-------------+    +------------------+
</pre>

<p>
pois os dados não precisam de tratamento SNAT (os chains <em>OUTPUT-nat</em> e
<em>POSTROUTING-nat</em> são processado somente uma vez a procura de regras
que conferem, principalmente para fazer SNAT).
</p>

<p>
E após a conexão estabelecida, o caminho de entrada de pacotes passa a ser:
</p>

<pre>
     +-----------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +------------+    +------------+
</pre>

<p>
pois os dados não precisam de tratamento DNAT (o chain <em>PREROUTING-nat</em>
é processado somente uma vez a procura de regras que conferem, principalmente
para fazer DNAT).
</p>

<p>
<strong>OBS:</strong> Para qualquer operação de entrada/saída de pacotes, os
dois chains da tabela mangle são sempre os primeiros a serem acessados.  Isto
é necessário para definir a prioridade e controlar outros aspectos especiais
dos pacotes que atravessam os filtros.
</p>

<hr>

<h3 id="s-fw-iptables-path-PingICMPLocalNet-Local">31.7.5 Ping de 192.168.1.4 para 192.168.1.1</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>192.168.1.4</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>192.168.1.1</samp>
</p>
</li>
<li>
<p>
Interface de Entrada: <samp>eth0</samp>
</p>
</li>
<li>
<p>
Interface de Saída: <samp>eth0</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>ICMP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Ping de 192.168.1.4 para a máquina do firewall.</samp>
</p>
</li>
</ul>

<pre>
     ENTRADA DE PACOTES (recebimento da requisição, vinda de 192.168.1.4): 
     +-----------------+    +--------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |PREROUTING-nat| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +--------------+    +------------+    +------------+
     
     SAÍDA DE PACOTES (envio da resposta a 192.168.1.4)
     +-------------+    +-------------+    +------------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-filter| =&gt; |POSTROUTING-mangle|
     +-------------+    +-------------+    +------------------+
</pre>

<p>
Quando damos o ping (<em>echo request</em>) os pacotes seguem o caminho em
<em>ENTRADA DE PACOTES</em> percorrendo os chains na ordem especificada e
retornam via <em>SAÍDA DOS PACOTES</em> (<em>echo reply</em>).
</p>

<p>
<strong>OBS1:</strong> Para qualquer operação de entrada/saída de pacotes,
os dois chains da tabela mangle são sempre os primeiros a serem acessados.
Isto é necessário para definir a prioridade e controlar outros aspectos
especiais dos pacotes que atravessam os filtros.
</p>

<hr>

<h3 id="s-fw-iptables-path-FtpTCPLocalNet-Local">31.7.6 Conexão FTP de 192.168.1.4 para 192.168.1.1</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>192.168.1.4</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>192.168.1.1</samp>
</p>
</li>
<li>
<p>
Interface de Origem: <samp>eth0</samp>
</p>
</li>
<li>
<p>
Interface de Destino: <samp>eth0</samp>
</p>
</li>
<li>
<p>
Porta Origem: <samp>1030</samp>
</p>
</li>
<li>
<p>
Porta Destino: <samp>21</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>TCP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Conexão ftp (até o prompt de login, sem transferência de
dados).</samp>
</p>
</li>
</ul>

<pre>
     ENTRADA DOS PACOTES (envio da requisição vindas de 192.168.1.4): 
     +-----------------+    +--------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |PREROUTING-nat| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +--------------+    +------------+    +------------+
     
     SAÍDA DE PACOTES (respostas da requisição acima para 192.168.1.4): 
     +-------------+    +-------------+    +------------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-filter| =&gt; |POSTROUTING-mangle|
     +-------------+    +-------------+    +------------------+
</pre>

<p>
A requisição ftp passa através dos chains especificados em <em>ENTRADA DOS
PACOTES</em> com o destino <code>192.168.1.1</code> porta <code>21</code> e
retorna por <em>SAÍDA DE PACOTES</em> para <code>192.168.1.4</code> porta
<code>1030</code>.  Após a conexão ser estabelecida, o caminho de entrada de
pacotes é:
</p>

<pre>
     +-----------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +------------+    +------------+
</pre>

<p>
pois os dados não precisam de tratamento DNAT (o chain <em>PREROUTING-nat</em>
é processado somente uma vez a procura de regras que conferem, principalmente
para fazer DNAT).
</p>

<p>
<strong>OBS:</strong> O roteamento é sempre realizado após o processamento do
chain <em>PREROUTING</em> da tabela <em>nat</em>.
</p>

<hr>

<h3 id="s-fw-iptables-path-FtpTCPLocalNet-RemoteNet">31.7.7 Conexão FTP de 192.168.1.4 para ftp.debian.org.br</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>192.168.1.4</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>200.198.129.162</samp>
</p>
</li>
<li>
<p>
Interface de Origem: <samp>eth0</samp>
</p>
</li>
<li>
<p>
Interface de Destino: <samp>ppp0</samp>
</p>
</li>
<li>
<p>
Porta Origem: <samp>1032</samp>
</p>
</li>
<li>
<p>
Porta Destino: <samp>21</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>TCP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Conexão ftp (até o prompt de login, sem transferência de
dados).</samp>
</p>
</li>
</ul>

<pre>
     SAÍDA DOS PACOTES (requisição vindas de 192.168.1.4): 
     +-----------------+    +--------------+    +--------------+   
     |PREROUTING-mangle| =&gt; |PREROUTING-nat| =&gt; |FORWARD-mangle| =&gt; (continua abaixo)
     +-----------------+    +--------------+    +--------------+   
     +--------------+    +------------------+    +---------------+
     |FORWARD-filter| =&gt; |POSTROUTING-mangle| =&gt; |POSTROUTING-nat|
     +--------------+    +------------------+    +---------------+
     
     ENTRADA DE PACOTES (respostas da requisição acima, enviadas para 192.168.1.4): 
     +-----------------+    +--------------+    +--------------+    +------------------+
     |PREROUTING-mangle| =&gt; |FORWARD-mangle| =&gt; |FORWARD-filter| =&gt; |POSTROUTING-mangle|
     +-----------------+    +--------------+    +--------------+    +------------------+
</pre>

<p>
A requisição ftp passa através dos chains especificados em <em>SAÍDA DOS
PACOTES</em> com o destino <code>200.198.129.162</code> porta <code>21</code>
(após a resolução DNS de <code>ftp.debian.org.br</code>) e retorna por
<em>ENTRADA DE PACOTES</em> para <code>192.168.1.4</code> porta
<code>1032</code>.
</p>

<p>
Note que o Masquerading regrava os pacotes; para a máquina
<code>200.198.129.162</code> a conexão está sendo feita para
<code>200.217.29.67</code>.  As respostas de conexões vindas de
<code>200.198.129.162</code> e indo para <code>200.217.29.67</code> são
regravadas no firewall com o destino <code>192.168.1.4</code> e enviadas para a
máquina correspondente.  Após a conexão ser estabelecida, o caminho de
saída de pacotes para 200.198.129.163 é:
</p>

<pre>
     +-----------------+    +--------------+    +--------------+    +------------------+
     |PREROUTING-mangle| =&gt; |FORWARD-mangle| =&gt; |FORWARD-filter| =&gt; |POSTROUTING-mangle|
     +-----------------+    +--------------+    +--------------+    +------------------+
</pre>

<p>
Após a conexão estabelecida, o caminho da entrada de pacotes vindos de
200.198.129.163 é:
</p>

<pre>
     +-----------------+    +--------------+    +--------------+    +------------------+
     |PREROUTING-mangle| =&gt; |FORWARD-mangle| =&gt; |FORWARD-filter| =&gt; |POSTROUTING-mangle|
     +-----------------+    +--------------+    +--------------+    +------------------+
</pre>

<p>
Isto acontece porque após feita a conexão Masquerading (via PREROUTING-nat),
o firewall já sabe como reescrever os pacotes para realizar a operação de
Masquerading, reescrevendo todos os pacotes que chegam de
<code>www.debian.org.br</code> para <code>192.168.1.4</code>.
</p>

<p>
<strong>OBS:</strong> As conexões Masquerading feitas através da rede
interna, são enviadas para <code>200.198.129.162</code> tem o endereço de
origem ajustado para <code>200.217.29.67</code> que é o IP de nossa interface
<code>ppp0</code>.  Quando as respostas atravessam o firewall, os pacotes são
checados pra saber se são uma resposta a uma conexão masquerading e fará a
regravação dos pacotes substituindo o endereço de destino para
<code>192.168.1.4</code>.  Caso uma operação de Masquerading falhe, os
pacotes serão Bloqueados.
</p>

<hr>

<h3 id="s-fw-iptables-path-FtpTCPRemoteNet-Local">31.7.8 Conexão FTP de 200.198.129.162 para 200.217.29.167</h3>

<ul>
<li>
<p>
Endereço de Origem: <samp>200.198.129.162</samp>
</p>
</li>
<li>
<p>
Endereço de Destino: <samp>200.217.29.67</samp>
</p>
</li>
<li>
<p>
Interface de Origem: <samp>ppp0</samp>
</p>
</li>
<li>
<p>
Interface de Destino: <samp>ppp0</samp>
</p>
</li>
<li>
<p>
Porta Origem: <samp>3716</samp>
</p>
</li>
<li>
<p>
Porta Destino: <samp>21</samp>
</p>
</li>
<li>
<p>
Protocolo: <samp>TCP</samp>
</p>
</li>
<li>
<p>
Descrição: <samp>Conexão ao serviço ftp do firewall</samp>
</p>
</li>
</ul>

<pre>
     ENTRADA DOS PACOTES (requisição vinda de 200.198.129.162): 
     +-----------------+    +--------------+    +-------------+    +------------+
     |PREROUTING-mangle| =&gt; |PREROUTING-nat| =&gt; |INPUT-mangle | =&gt; |INPUT-filter|
     +-----------------+    +--------------+    +-------------+    +------------+
     
     SAÍDA DE PACOTES (respostas da requisição de 200.198.129.162): 
     +-------------+    +-------------+    +------------------+
     |OUTPUT-mangle| =&gt; |OUTPUT-filter| =&gt; |POSTROUTING-mangle|
     +-------------+    +-------------+    +------------------+
</pre>

<p>
A requisição ftp passa através dos chains especificados em <em>ENTRADA DOS
PACOTES</em> com o destino <code>200.217.29.67</code> (nossa interface
<code>ppp0</code> local) porta <code>21</code> e retorna por <em>SAÍDA DE
PACOTES</em> para <code>200.198.129.162</code> porta <code>3716</code> (também
via <code>ppp0</code>).  Após a conexão ser estabelecida, o caminho de
entrada de pacotes é:
</p>

<pre>
     +-----------------+    +------------+    +------------+
     |PREROUTING-mangle| =&gt; |INPUT-mangle| =&gt; |INPUT-filter|
     +-----------------+    +------------+    +------------+
</pre>

<p>
Isto acontece porque após feita a análise do chain <em>PREROUTING</em> (para
necessidade de DNAT), a máquina já saberá tomar a decisão apropriada para
gerenciar aquela conexão.
</p>

<hr>

<h3 id="s-fw-iptables-path-grafico">31.7.9 Gráfico geral da passagem dos pacotes</h3>

<p>
Este gráfico foi retirado do documento
<code>netfilter-hacking-HOWTO.txt</code> e mostra a estrutura geral de passagem
dos pacotes nas tabelas/chains.  Os exemplos de passagem de pacotes acima
poderão ser facilmente comparados com as etapas abaixo para compreender a
estrutura do <code>iptables</code>.
</p>

<pre>
     E ---&gt; PREROUTING ------&gt; (ROTEAM.) ---&gt; FORWARD ----------&gt; POSTROUTING --&gt; S
            Mangle e              |           Mangle       ^      Mangle
            NAT (DNAT))           |           Filter       |      NAT (SRC)
                                  |                     (ROTEAM.)
                                  v                        |
                                  IN Mangle,              OUT - Mangle,
                                  |  Filter                ^    NAT (DNAT)
                                  |                        |    Filter
                                  v                        |  
                         +----------------------------------------+
                         |            Processo Local              |
                         +----------------------------------------+
</pre>

<hr>

<h2 id="s-fw-iptables-exemplo">31.8 Exemplos de configurações do iptables</h2>

<p>
Exemplo de como bloquear todas as conexões para a máquina do firewall
permitindo somente conexões da máquina Linux para fora.
</p>

<hr>

<h3 id="s-fw-iptables-exemplo-bloqueio">31.8.1 Bloqueando conexões de fora para sua máquina</h3>

<p>
As regras a seguir servem para bloquear tentativas de conexões da interface de
Internet (ppp0) a sua rede sem bloquear o tráfego de conexões já iniciadas.
O tráfego de outras interfaces não é afetado com as regras a seguir:
</p>

<pre>
     iptables -A INPUT -i ppp0 -m state --state ! ESTABLISHED,RELATED -j DROP
</pre>

<p>
Todas as conexões vindas de ppp0 de estado diferente de ESTABLISHED e RELATED
(NEW e INVALID) serão derrubadas.  Veja <a
href="#s-fw-iptables-mod-state">Conferindo de acordo com o estado da conexão,
Seção 31.6.1</a> para detalhes.
</p>

<pre>
     iptables -A INPUT -i ppp0 --syn -j DROP
</pre>

<p>
Este acima é mais simples e possui o mesmo efeito: Pacotes SYN são usados
para iniciar conexões, derrubando pacotes deste tipo significa bloquear novas
conexões.  Pacotes de conexões já estabelecidas ainda são permitidos.
</p>

<p>
Estas regras acima servem para quem não deseja NENHUM acesso indevido a sua
máquina.  Existem outras formas de bloquear conexões de modo mais seletivo
usando chains específicos, endereços de origem/destino, portas, etc., este
tipo de configuração é muito usada caso precise fornecer algum tipo de
serviço que seja acessível externamente e protegendo outros.
</p>

<hr>

<h3 id="s-fw-iptables-exemplo-trojans">31.8.2 Monitorando tentativa de conexão de trojans em sua máquina</h3>

<p>
As regras abaixo alertam sobre a tentativa de conexão dos trojans &quot;For
Win&quot; mais conhecidos.  Coloquei isto aqui por curiosidade de algumas
pessoas, pois máquinas <code>Linux</code> são imunes a este tipo de coisa:
</p>

<pre>
     #!/bin/sh
     
     TROJAN_PORTS=&quot;12345 31336 31337 31338 3024 4092 5714 5742 2583 8787 5556 5557&quot;
     
     iptables -t filter -N trojans-in
     
     for PORTA in ${TROJAN_PORTS};do
      iptables -A trojans-in -p tcp --sport=1024: --dport=${PORTA} -j LOG \
               --log-prefix &quot;FIREWALL: Trojan ${PORTA} &quot;
      iptables -A trojans-in -p tcp --sport=1024: --dport=${PORTA} -j DROP
     done
     
     iptables -t filter -A INPUT -i ppp0 -j trojans-in
</pre>

<p>
A primeira linha do <code>iptables</code> cria o chain <em>trojans-in</em>
dentro da tabela <em>filter</em> que usaremos para armazenar nossas regras de
firewall.  A segunda (dentro do laço for) faz uma regra de LOG para registrar
as tentativas de acesso de trojans em nosso sistema, a terceira rejeita o
acesso.  A quarta regra do <code>iptables</code> cria de todo o tráfego vindo
da interface ppp0 pra o chain trojans-in (queremos que só o tráfego vindo da
internet seja analisado pelo chain <em>trojans-in</em>).
</p>

<p>
Muitas das portas especificadas na variável <var>TROJAN_PORTS</var> são
antigas conhecidas de quem já brincou ou sofreram com o <code>Back
Orifice</code>, <code>Win Crack</code>, <code>NetBus</code> (quem nunca passou
pela fase de ter uma lista com mais de 100 netmasks e conseguir encontrar
centenas de máquinas por dia infectadas pelo BO?  :-).
</p>

<p>
No código acima a única coisa que precisa fazer para adicionar mais portas é
inseri-las na variável <var>TROJAN_PORTS</var> e executar o programa.  O laço
do <samp>for</samp> executará as 2 regras para cada porta processada
(economizando linhas e linhas de regras, me livrando de uma LER e poupando
muitos bytes neste guia ;-).
</p>

<p>
Dependendo do número de portas alvo, este código pode ser muito simplificado
usando o recurso multiport do <code>iptables</code> (veja <a
href="#s-fw-iptables-mod-multiport">Especificando múltiplas portas de
origem/destino, Seção 31.6.6</a> para detalhes).
</p>

<hr>

<h3 id="s-fw-iptables-exemplo-snat">31.8.3 Conectando sua rede interna a Internet</h3>

<p>
O seguinte exemplo permite ligar sua rede interna com a faixa de IP's
<code>192.168.1.*</code> a internet (usando uma conexão discada do tipo ppp):
</p>

<pre>
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp+ -j MASQUERADE
     echo &quot;1&quot; &gt;/proc/sys/net/ipv4/ip_forward
</pre>

<hr>

<h3 id="s-fw-iptables-exemplo-fw">31.8.4 Um exemplo de firewall simples</h3>

<p>
Esta seção possui um exemplo mais elaborado de firewall que servirá para
máquinas conectadas via ppp com uma rede interna conectada via Masquerading.
Este exemplo não é tão complexo e cobre as expectativas mais comuns de
pessoas que gostam de explorar os potenciais de rede no <code>Linux</code> ou
satisfazer sua curiosidade.  Ele poderá ser facilmente adaptado para atender
outro tipo de necessidade.  A configuração assumida é a seguinte:
</p>
<!-- ol type="1" start="1"  -->
<li>
<p>
Máquina do firewall com 2 interfaces de rede, uma é <code>eth0</code> com o
IP <code>192.168.1.1</code> que serve de ligação a sua rede Interna, a outra
é <code>ppp0</code> que é a interface Internet.
</p>
</li>
<li>
<p>
Qualquer acesso externo a máquinas da rede interna é bloqueado.
</p>
</li>
<li>
<p>
Os usuários da rede local tem acesso livre ao servidor <code>Linux</code>.
</p>
</li>
<li>
<p>
Qualquer acesso externo a máquina do firewall é bloqueado, exceto conexões
para o serviço <code>Apache</code> (<samp>httpd</samp>).  Outras tentativas de
conexões devem ser explicitamente registradas nos logs do sistema para
conhecimento do administrador.
</p>
</li>
<li>
<p>
Todos os usuários possuem acesso livre a Internet via Masquerading, exceto que
o acesso para o serviço www deve ser obrigatoriamente feito via
<code>squid</code>, e o servidor smtp a ser usado deverá ser o do firewall
<code>Linux</code>.
</p>
</li>
<li>
<p>
Prioridades serão estabelecidas para os serviços de telnet, IRC,talk e DNS.
</p>
</li>
</ol>

<pre>
     #!/bin/sh
     # Modelo de configuração de firewall
     # Autor: Gleydson M. Silva
     # Data: 05/09/2001
     # Descrição: Produzido para ser distribuído livremente, acompanha o guia 
     #             Foca GNU/Linux. http://www.guiafoca.org
     #
     
     # É assumido um sistema usando kmod para carga automática dos módulos usados por
     # esta configuração do firewall:
     # ipt_filter
     # ipt_nat
     # ipt_conntrack
     # ipt_mangle
     # ipt_TOS
     # ipt_MASQUERADE
     # ipt_LOG
     
     # Se você tem um kernel modularizado que não utiliza o kmod, será necessário 
     # carregar estes módulos via modprobe, insmod ou iptables --modprobe=modulo
     
     ##### Definição de política padrão do firewall #####
     # Tabela filter
     iptables -t filter -P INPUT DROP
     iptables -t filter -P OUTPUT ACCEPT
     iptables -t filter -P FORWARD DROP
     # Tabela nat
     iptables -t nat -P PREROUTING ACCEPT
     iptables -t nat -P OUTPUT ACCEPT
     iptables -t nat -P POSTROUTING DROP
     # Tabela mangle
     iptables -t mangle -P PREROUTING ACCEPT
     iptables -t mangle -P OUTPUT ACCEPT
     
     
     ##### Proteção contra IP Spoofing #####
     for i in /proc/sys/net/ipv4/conf/*/rp_filter; do
      echo 1 &gt;$i
     done
     
     ##### Ativamos o redirecionamento de pacotes (requerido para NAT) #####
     echo &quot;1&quot; &gt;/proc/sys/net/ipv4/ip_forward
     
     # O iptables define automaticamente o número máximo de conexões simultâneas 
     # com base na memória do sistema. Para 32MB = 2048, 64MB = 4096, 128MB = 8192, 
     # sendo que são usados 350 bytes de memória residente para controlar 
     # cada conexão. 
     # Quando este limite é excedido a seguinte mensagem é mostrada:
     #  &quot;ip_conntrack: maximum limit of XXX entries exceed&quot;
     #
     # Como temos uma rede simples, vamos abaixar este limite. Por outro lado isto 
     # criará uma certa limitação de tráfego para evitar a sobrecarga do servidor. 
     echo &quot;2048&quot; &gt; /proc/sys/net/ipv4/ip_conntrack_max
     
     
     ###############################################################
     #                      Tabela filter                          #
     ###############################################################
     
     ##### Chain INPUT #####
     # Criamos um chain que será usado para tratar o tráfego vindo da Internet e 
     iptables -N ppp-input
     
     # Aceita todo o tráfego vindo do loopback e indo pro loopback
     iptables -A INPUT -i lo -j ACCEPT
     # Todo tráfego vindo da rede interna também é aceito
     iptables -A INPUT -s 192.168.1.0/24 -i eth0 -j ACCEPT
     
     # Conexões vindas da interface ppp0 são tratadas pelo chain ppp-input
     iptables -A INPUT -i ppp+ -j ppp-input
     
     # Qualquer outra conexão desconhecida é imediatamente registrada e derrubada
     iptables -A INPUT -j LOG --log-prefix &quot;FIREWALL: INPUT &quot;
     iptables -A INPUT -j DROP
     
     
     ##### Chain FORWARD ####
     # Permite redirecionamento de conexões entre as interfaces locais
     # especificadas abaixo. Qualquer tráfego vindo/indo para outras
     # interfaces será bloqueado neste passo
     iptables -A FORWARD -d 192.168.1.0/24 -i ppp+ -o eth0 -j ACCEPT
     iptables -A FORWARD -s 192.168.1.0/24 -i eth0 -o ppp+ -j ACCEPT
     iptables -A FORWARD -j LOG --log-prefix &quot;FIREWALL: FORWARD &quot;
     iptables -A FORWARD -j DROP
     
     
     ##### Chain ppp-input ####
     # Aceitamos todas as mensagens icmp vindas de ppp0 com certa limitação
     # O tráfego de pacotes icmp que superar este limite será bloqueado
     # pela regra &quot;...! ESTABLISHED,RELATED -j DROP&quot; no final do 
     # chain ppp-input
     #
     iptables -A ppp-input -p icmp -m limit --limit 2/s -j ACCEPT
     
     # Primeiro aceitamos o tráfego vindo da Internet para o serviço www (porta 80)
     iptables -A ppp-input -p tcp --dport 80 -j ACCEPT
     
     # A tentativa de acesso externo a estes serviços serão registrados no syslog
     # do sistema e serão bloqueados pela última regra abaixo.
     iptables -A ppp-input -p tcp --dport 21 -j LOG --log-prefix &quot;FIREWALL: ftp &quot;
     iptables -A ppp-input -p tcp --dport 25 -j LOG --log-prefix &quot;FIREWALL: smtp &quot;
     iptables -A ppp-input -p udp --dport 53 -j LOG --log-prefix &quot;FIREWALL: dns &quot;
     iptables -A ppp-input -p tcp --dport 110 -j LOG --log-prefix &quot;FIREWALL: pop3 &quot;
     iptables -A ppp-input -p tcp --dport 113 -j LOG --log-prefix &quot;FIREWALL: identd &quot;
     iptables -A ppp-input -p udp --dport 111 -j LOG --log-prefix &quot;FIREWALL: rpc&quot;
     iptables -A ppp-input -p tcp --dport 111 -j LOG --log-prefix &quot;FIREWALL: rpc&quot;
     iptables -A ppp-input -p tcp --dport 137:139 -j LOG --log-prefix &quot;FIREWALL: samba &quot;
     iptables -A ppp-input -p udp --dport 137:139 -j LOG --log-prefix &quot;FIREWALL: samba &quot;
     # Bloqueia qualquer tentativa de nova conexão de fora para esta máquina
     iptables -A ppp-input -m state --state ! ESTABLISHED,RELATED -j LOG --log-prefix &quot;FIREWALL: ppp-in &quot;
     iptables -A ppp-input -m state --state ! ESTABLISHED,RELATED -j DROP
     # Qualquer outro tipo de tráfego é aceito
     iptables -A ppp-input -j ACCEPT
     
     
     #######################################################
     #                   Tabela nat                        #
     #######################################################
     
     ##### Chain POSTROUTING #####
     # Permite qualquer conexão vinda com destino a lo e rede local para eth0
     iptables -t nat -A POSTROUTING -o lo -j ACCEPT
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j ACCEPT
     
     # Não queremos que usuários tenham acesso direto a www e smtp da rede externa, o 
     # squid e smtpd do firewall devem ser obrigatoriamente usados. Também registramos
     # as tentativas para monitorarmos qual máquina está tentando conectar-se diretamente.
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp+ -p tcp --dport 80 -j LOG --log-prefix &quot;FIREWALL: SNAT-www &quot;
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp+ -p tcp --dport 25 -j LOG --log-prefix &quot;FIREWALL: SNAT-smtp &quot;
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp+ -p tcp --dport 25 -j DROP
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp+ -p tcp --dport 80 -j DROP
     # É feito masquerading dos outros serviços da rede interna indo para a interface 
     # ppp0 
     iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp+ -j MASQUERADE
     
     # Qualquer outra origem de tráfego desconhecida indo para eth0 (conexões vindas 
     # de ppp+) são bloqueadas aqui
     iptables -t nat -A POSTROUTING -o eth0 -d 192.168.1.0/24 -j LOG --log-prefix &quot;FIREWALL: SNAT unknown&quot;
     iptables -t nat -A POSTROUTING -o eth0 -d 192.168.1.0/24 -j DROP
     # Quando iniciamos uma conexão ppp, obtermos um endereço classe A (10.x.x.x) e após
     # estabelecida a conexão real, este endereço é modificado. O tráfego indo para 
     # a interface ppp não deverá ser bloqueado. Os bloqueios serão feitos no 
     # chain INPUT da tabela filter
     iptables -t nat -A POSTROUTING -o ppp+ -j ACCEPT
     
     # Registra e bloqueia qualquer outro tipo de tráfego desconhecido
     iptables -t nat -A POSTROUTING -j LOG --log-prefix &quot;FIREWALL: SNAT &quot;
     iptables -t nat -A POSTROUTING -j DROP
     
     
     ###############################################
     #                Tabela mangle                #
     ###############################################
     
     ##### Chain OUTPUT #####
     # Define mínimo de espera para os serviços ftp, telnet, irc e DNS, isto 
     # dará uma melhor sensação de conexão em tempo real e diminuirá o tempo 
     # de espera para conexões que requerem resolução de nomes. 
     iptables -t mangle -A OUTPUT -o ppp+ -p tcp --dport 21 -j TOS --set-tos 0x10
     iptables -t mangle -A OUTPUT -o ppp+ -p tcp --dport 23 -j TOS --set-tos 0x10
     iptables -t mangle -A OUTPUT -o ppp+ -p tcp --dport 6665:6668 -j TOS --set-tos 0x10
     iptables -t mangle -A OUTPUT -o ppp+ -p udp --dport 53 -j TOS --set-tos 0x10
</pre>

<hr>

<p>
[ <a href="ch-x11.html">anterior</a> ]
[ <a href="index.html#contents">Conteúdo</a> ]
[ <a href="ch-intro.html">1</a> ]
[ <a href="ch-bas.html">2</a> ]
[ <a href="ch-hardw.html">3</a> ]
[ <a href="ch-d-l.html">4</a> ]
[ <a href="ch-disc.html">5</a> ]
[ <a href="ch-boot.html">6</a> ]
[ <a href="ch-run.html">7</a> ]
[ <a href="ch-cmdd.html">8</a> ]
[ <a href="ch-cmd.html">9</a> ]
[ <a href="ch-cmdv.html">10</a> ]
[ <a href="ch-cmdn.html">11</a> ]
[ <a href="ch-cmdc.html">12</a> ]
[ <a href="ch-perm.html">13</a> ]
[ <a href="ch-redir.html">14</a> ]
[ <a href="ch-rede.html">15</a> ]
[ <a href="ch-cfgrede.html">16</a> ]
[ <a href="ch-kern.html">17</a> ]
[ <a href="ch-log.html">18</a> ]
[ <a href="ch-cpctd.html">19</a> ]
[ <a href="ch-deb.html">20</a> ]
[ <a href="ch-dpkg.html">21</a> ]
[ <a href="ch-pers.html">22</a> ]
[ <a href="ch-impr.html">23</a> ]
[ <a href="ch-cfg.html">24</a> ]
[ <a href="ch-tasks.html">25</a> ]
[ <a href="ch-compil.html">26</a> ]
[ <a href="ch-manut.html">27</a> ]
[ <a href="ch-etc.html">28</a> ]
[ <a href="ch-inter.html">29</a> ]
[ <a href="ch-x11.html">30</a> ]
[ 31 ]
[ <a href="ch-d-contas.html">32</a> ]
[ <a href="ch-s-apache.html">33</a> ]
[ <a href="ch-s-ident.html">34</a> ]
[ <a href="ch-s-telnet.html">35</a> ]
[ <a href="ch-s-ssh.html">36</a> ]
[ <a href="ch-s-pop3.html">37</a> ]
[ <a href="ch-s-cvs.html">38</a> ]
[ <a href="ch-s-samba.html">39</a> ]
[ <a href="ch-d-restr.html">40</a> ]
[ <a href="ch-d-cripto.html">41</a> ]
[ <a href="ch-aplic.html">42</a> ]
[ <a href="ch-ajuda.html">43</a> ]
[ <a href="ch-systemd.html">44</a> ]
[ <a href="ch-git.html">45</a> ]
[ <a href="ch-virt-intro.html">46</a> ]
[ <a href="ch-apend.html">47</a> ]
[ <a href="ch-d-contas.html">próximo</a> ]
</p>

<hr>

<p>
Guia Foca GNU/Linux
</p>

<address>
Versão 4.22 - domingo, 05 de setembro de 2010<br>
<br>
Gleydson Mazioli da Silva <code><a href="mailto:gleydson@guiafoca.org">mailto:gleydson@guiafoca.org</a></code><br>
<br>
</address>
<hr>

</body>

</html>

